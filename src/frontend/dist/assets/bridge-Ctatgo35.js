const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CQEhYxiE.js","assets/index-5sOdJcVt.js","assets/index-BGsF7zWU.css","assets/index-D16to4BB.js","assets/useNFTMetadata-Cwxou53j.js"])))=>i.map(i=>d[i]);
var Mf=Object.defineProperty;var jl=e=>{throw TypeError(e)};var _f=(e,t,r)=>t in e?Mf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var T=(e,t,r)=>_f(e,typeof t!="symbol"?t+"":t,r),Qo=(e,t,r)=>t.has(e)||jl("Cannot "+r);var f=(e,t,r)=>(Qo(e,t,"read from private field"),r?r.call(e):t.get(e)),B=(e,t,r)=>t.has(e)?jl("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),x=(e,t,r,n)=>(Qo(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),te=(e,t,r)=>(Qo(e,t,"access private method"),r);var Ii=(e,t,r,n)=>({set _(s){x(e,t,s,r)},get _(){return f(e,t,n)}});import{r as _,y as _e,R as Uf,j as i,b as Vf,x as Gf,P as it,_ as jt,u as zf,A as Hf,c as $f}from"./index-5sOdJcVt.js";import{u as Qf,d as Er,a as Xd,g as Fa,e as Vi,b as gt,h as Lc,f as qf}from"./useNFTMetadata-Cwxou53j.js";import{i as Jf}from"./index-CQEhYxiE.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),If=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),Sl=e=>{const t=If(e);return t.charAt(0).toUpperCase()+t.slice(1)},Ld=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Wf=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=_.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:o,...c},l)=>_.createElement("svg",{ref:l,...Yf,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Ld("lucide",s),...!a&&!Wf(c)&&{"aria-hidden":"true"},...c},[...o.map(([d,u])=>_.createElement(d,u)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=(e,t)=>{const r=_.forwardRef(({className:n,...s},a)=>_.createElement(Zf,{ref:a,iconNode:t,className:Ld(`lucide-${Kf(Sl(e))}`,`lucide-${e}`,n),...s}));return r.displayName=Sl(e),r};/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Lf=ot("arrow-right",Xf);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],e0=ot("chevron-down",Df);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Dd=ot("chevron-left",t0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ia=ot("chevron-right",r0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sr=ot("circle-alert",n0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],$r=ot("circle-check-big",s0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],a0=ot("circle-x",i0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],eu=ot("clock",o0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],l0=ot("credit-card",c0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],tu=ot("external-link",d0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],dc=ot("image",u0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],St=ot("loader-circle",h0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],m0=ot("plus",f0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],g0=ot("rotate-ccw",p0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],b0=ot("triangle-alert",x0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],ru=ot("wallet",y0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],nu=ot("x",w0);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],A0=ot("zap",N0),v0=[{id:"connect-ic-wallet",title:"Connect IC Wallet",description:"Connect your Internet Computer wallet (Internet Identity, NFID, Plug, etc.)",estimatedDuration:15,retryable:!0,stage:"setup"},{id:"connect-evm-wallet",title:"Connect EVM Wallet",description:"Connect your Ethereum wallet (MetaMask, WalletConnect, etc.) and switch to correct network",estimatedDuration:20,retryable:!0,stage:"setup"},{id:"input-nft-details",title:"Specify NFT Details",description:"Enter the contract address, token ID, and select source chain",estimatedDuration:30,retryable:!1,stage:"setup"},{id:"verify-ownership",title:"Verify EVM Ownership",description:"Confirming you own the NFT on the source EVM chain",estimatedDuration:15,retryable:!0,stage:"setup"},{id:"check-cknft-canister",title:"Check ckNFT Canister",description:"Checking if a ckNFT canister exists for this contract",estimatedDuration:10,retryable:!0,stage:"canister"},{id:"estimate-canister-cost",title:"Calculate Canister Cost",description:"Estimating cycles needed to create new ckNFT canister (if needed)",estimatedDuration:5,retryable:!0,stage:"canister"},{id:"check-balances",title:"Check Balances",description:"Verifying ICP and cycles balances for canister creation and minting",estimatedDuration:10,retryable:!0,stage:"canister"},{id:"approve-cycles-orchestrator",title:"Approve Cycles (Orchestrator)",description:"Approve cycles ledger to spend cycles for orchestrator operations",estimatedDuration:30,retryable:!0,stage:"canister"},{id:"create-cknft-canister",title:"Create ckNFT Canister",description:"Deploying new ckNFT canister on Internet Computer (if needed)",estimatedDuration:90,retryable:!0,stage:"canister"},{id:"estimate-mint-cost",title:"Calculate Mint Cost",description:"Estimating cycles needed for minting process",estimatedDuration:5,retryable:!0,stage:"preparation"},{id:"approve-cycles-mint",title:"Approve Cycles (Mint)",description:"Approve cycles for the minting operation",estimatedDuration:30,retryable:!0,stage:"preparation"},{id:"get-approval-address",title:"Get Approval Address",description:"Getting the bridge contract address for NFT approval",estimatedDuration:10,retryable:!0,stage:"preparation"},{id:"approve-nft-transfer",title:"Approve NFT Transfer",description:"Approve the bridge to transfer your NFT (EVM transaction)",estimatedDuration:60,retryable:!0,stage:"preparation"},{id:"initiate-mint",title:"Initiate Mint",description:"Starting the cross-chain minting process",estimatedDuration:30,retryable:!0,stage:"execution"},{id:"verify-ownership-remotely",title:"Verify Remote Ownership",description:"Bridge verifying NFT ownership on source chain",estimatedDuration:45,retryable:!0,stage:"execution"},{id:"fetch-metadata",title:"Retrieve Metadata",description:"Fetching NFT metadata from source chain",estimatedDuration:30,retryable:!0,stage:"execution"},{id:"transfer-nft-to-bridge",title:"Transfer to Bridge",description:"Bridge contract receiving NFT from source chain",estimatedDuration:120,retryable:!1,stage:"execution"},{id:"mint-cknft",title:"Mint ckNFT",description:"Minting your NFT on the Internet Computer",estimatedDuration:60,retryable:!0,stage:"execution"},{id:"verify-mint-complete",title:"Verify Completion",description:"Confirming your ckNFT was successfully minted and is in your wallet",estimatedDuration:15,retryable:!0,stage:"execution"}],E0=[{id:"connect-ic-wallet",title:"Connect IC Wallet",description:"Connect your Internet Computer wallet containing the ckNFT",estimatedDuration:15,retryable:!0,stage:"setup"},{id:"select-cknft",title:"Select ckNFT",description:"Choose which ckNFT you want to bridge to EVM",estimatedDuration:20,retryable:!1,stage:"setup"},{id:"select-target-network",title:"Select Target Network",description:"Choose which EVM network to deploy your NFT contract to",estimatedDuration:15,retryable:!1,stage:"setup"},{id:"connect-evm-wallet",title:"Connect EVM Wallet",description:"Connect your target EVM wallet for receiving NFTs",estimatedDuration:20,retryable:!0,stage:"setup"},{id:"check-remote-contract",title:"Check Remote Contract",description:"Checking if NFT contract already exists on target EVM chain",estimatedDuration:10,retryable:!0,stage:"contract"},{id:"estimate-gas-costs",title:"Calculate Gas Costs",description:"Estimating gas fees for contract deployment and minting",estimatedDuration:15,retryable:!0,stage:"contract"},{id:"get-funding-address",title:"Get Funding Address",description:"Getting the bridge funding address for gas payments",estimatedDuration:10,retryable:!0,stage:"contract"},{id:"fund-gas-account",title:"Fund Gas Account",description:"Send ETH to bridge funding address for gas fees",estimatedDuration:90,retryable:!0,stage:"contract"},{id:"approve-cycles-remote",title:"Approve Cycles (Remote)",description:"Approve cycles for remote contract deployment",estimatedDuration:30,retryable:!0,stage:"contract"},{id:"deploy-evm-contract",title:"Deploy EVM Contract",description:"Deploying NFT contract on target EVM network",estimatedDuration:180,retryable:!0,stage:"contract"},{id:"verify-contract-deployment",title:"Verify Contract",description:"Confirming contract was successfully deployed",estimatedDuration:30,retryable:!0,stage:"contract"},{id:"estimate-cast-costs",title:"Calculate Cast Costs",description:"Estimating cycles and gas needed for casting operation",estimatedDuration:10,retryable:!0,stage:"preparation"},{id:"approve-cycles-cast",title:"Approve Cycles (Cast)",description:"Approve cycles for the casting operation",estimatedDuration:30,retryable:!0,stage:"preparation"},{id:"approve-cknft-transfer",title:"Approve ckNFT Transfer",description:"Approve the bridge to transfer your ckNFT",estimatedDuration:30,retryable:!0,stage:"preparation"},{id:"initiate-cast",title:"Initiate Cast",description:"Starting the cross-chain casting process",estimatedDuration:45,retryable:!0,stage:"execution"},{id:"burn-cknft",title:"Burn ckNFT",description:"Burning ckNFT on Internet Computer to release for EVM minting",estimatedDuration:60,retryable:!1,stage:"execution"},{id:"wait-for-consensus",title:"Wait for Consensus",description:"Waiting for cross-chain consensus and verification",estimatedDuration:300,retryable:!1,stage:"execution"},{id:"mint-on-evm",title:"Mint on EVM",description:"Minting your NFT on the target EVM chain",estimatedDuration:120,retryable:!0,stage:"execution"},{id:"verify-evm-ownership",title:"Verify EVM Ownership",description:"Confirming NFT was minted to your EVM wallet",estimatedDuration:30,retryable:!0,stage:"execution"},{id:"cast-complete",title:"Cast Complete",description:"Bridge operation completed successfully",estimatedDuration:5,retryable:!1,stage:"execution"}],k0=[{id:"setup",title:"ðŸ”Œ Setup & Connection",description:"Connect wallets and verify NFT ownership"},{id:"canister",title:"ðŸ­ Canister Management",description:"Create or check ckNFT canister on IC"},{id:"preparation",title:"âš™ï¸ Preparation",description:"Approve cycles and NFT transfers"},{id:"execution",title:"ðŸš€ Bridge Execution",description:"Execute cross-chain bridging"}],C0=[{id:"setup",title:"ðŸ”Œ Setup & Connection",description:"Connect wallets and select ckNFT"},{id:"contract",title:"ðŸ“œ Contract Management",description:"Deploy or check EVM contract"},{id:"preparation",title:"âš™ï¸ Preparation",description:"Approve cycles and ckNFT transfers"},{id:"execution",title:"ðŸš€ Cast Execution",description:"Execute cross-chain casting"}];function T0(e,t){const r=e.stages.map(n=>n.id===t?{...n,isCollapsed:!n.isCollapsed}:n);return{...e,stages:r}}function j0(e){return e.stages.find(t=>t.status!=="completed")||null}function S0(e){switch(e.status){case"failed":return"red";case"loading":return"yellow";case"completed":return"green";default:return"gray"}}function su(e,t){return(t==="evm-to-ic"?k0:C0).map(n=>{const s=e.filter(c=>c.stage===n.id),a=s.reduce((c,l)=>c+(l.estimatedDuration||0),0);let o="pending";if(s.length>0){const c=s.filter(u=>u.status==="completed").length,l=s.filter(u=>u.status==="failed").length,d=s.filter(u=>u.status==="loading").length;l>0?o="failed":c===s.length?o="completed":(d>0||c>0)&&(o="loading")}return{id:n.id,title:n.title,description:n.description,status:o,steps:s,estimatedDuration:a,isCollapsed:o==="completed"}})}function iu(e,t,r){const s=(t||(e==="evm-to-ic"?v0:E0)).map(o=>({...o,status:"pending"})),a=su(s,e);return{id:`bridge-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,direction:e,steps:s,stages:a,currentStep:0,isComplete:!1,totalSteps:s.length,startTime:Date.now(),metadata:r}}function au(e,t,r){const n=e.steps.findIndex(h=>h.id===t);if(n===-1)throw new Error(`Step with id "${t}" not found`);const s=[...e.steps],a=s[n],o=Date.now();let c={...r};r.status==="loading"&&a.status==="pending"?c={...c,startTime:o}:(r.status==="completed"||r.status==="failed")&&a.startTime&&(c={...c,endTime:o}),s[n]={...a,...c,metadata:{...a.metadata,...r.metadata}};let l=e.currentStep,d=e.isComplete;r.status==="completed"?(l=Math.min(n+1,e.totalSteps-1),d=s.every(h=>h.status==="completed"||h.status==="skipped")):r.status==="loading"&&(l=n);const u={...e,steps:s,currentStep:l,isComplete:d};return u.stages=su(s,e.direction),d&&!e.endTime&&(u.endTime=o,u.totalDuration=o-e.startTime),u}function ou(e,t){const r=e.steps.findIndex(a=>a.id===t);if(r===-1)throw new Error(`Step with id "${t}" not found`);const n=e.steps[r];if(!(n!=null&&n.retryable))throw new Error(`Step "${t}" is not retryable`);const s=[...e.steps];return s[r]={...n,status:"pending",error:void 0,startTime:void 0,endTime:void 0},{...e,steps:s,currentStep:r}}const Dc="-",F0=e=>{const t=P0(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const c=o.split(Dc);return c[0]===""&&c.length!==1&&c.shift(),cu(c,t)||R0(o)},getConflictingClassGroupIds:(o,c)=>{const l=r[o]||[];return c&&n[o]?[...l,...n[o]]:l}}},cu=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?cu(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const a=e.join(Dc);return(o=t.validators.find(({validator:c})=>c(a)))==null?void 0:o.classGroupId},Fl=/^\[(.+)\]$/,R0=e=>{if(Fl.test(e)){const t=Fl.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},P0=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const s in r)uc(r[s],n,s,t);return n},uc=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const a=s===""?t:Rl(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(B0(s)){uc(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([a,o])=>{uc(o,Rl(t,a),r,n)})})},Rl=(e,t)=>{let r=e;return t.split(Dc).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},B0=e=>e.isThemeGetter,O0=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(a,o)=>{r.set(a,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(a){let o=r.get(a);if(o!==void 0)return o;if((o=n.get(a))!==void 0)return s(a,o),o},set(a,o){r.has(a)?r.set(a,o):s(a,o)}}},hc="!",fc=":",M0=fc.length,_0=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=s=>{const a=[];let o=0,c=0,l=0,d;for(let b=0;b<s.length;b++){let g=s[b];if(o===0&&c===0){if(g===fc){a.push(s.slice(l,b)),l=b+M0;continue}if(g==="/"){d=b;continue}}g==="["?o++:g==="]"?o--:g==="("?c++:g===")"&&c--}const u=a.length===0?s:s.substring(l),h=U0(u),m=h!==u,p=d&&d>l?d-l:void 0;return{modifiers:a,hasImportantModifier:m,baseClassName:h,maybePostfixModifierPosition:p}};if(t){const s=t+fc,a=n;n=o=>o.startsWith(s)?a(o.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:o,maybePostfixModifierPosition:void 0}}if(r){const s=n;n=a=>r({className:a,parseClassName:s})}return n},U0=e=>e.endsWith(hc)?e.substring(0,e.length-1):e.startsWith(hc)?e.substring(1):e,V0=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const s=[];let a=[];return n.forEach(o=>{o[0]==="["||t[o]?(s.push(...a.sort(),o),a=[]):a.push(o)}),s.push(...a.sort()),s}},G0=e=>({cache:O0(e.cacheSize),parseClassName:_0(e),sortModifiers:V0(e),...F0(e)}),z0=/\s+/,H0=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s,sortModifiers:a}=t,o=[],c=e.trim().split(z0);let l="";for(let d=c.length-1;d>=0;d-=1){const u=c[d],{isExternal:h,modifiers:m,hasImportantModifier:p,baseClassName:b,maybePostfixModifierPosition:g}=r(u);if(h){l=u+(l.length>0?" "+l:l);continue}let v=!!g,N=n(v?b.substring(0,g):b);if(!N){if(!v){l=u+(l.length>0?" "+l:l);continue}if(N=n(b),!N){l=u+(l.length>0?" "+l:l);continue}v=!1}const V=a(m).join(":"),E=p?V+hc:V,Y=E+N;if(o.includes(Y))continue;o.push(Y);const O=s(N,v);for(let Z=0;Z<O.length;++Z){const q=O[Z];o.push(E+q)}l=u+(l.length>0?" "+l:l)}return l};function $0(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=lu(t))&&(n&&(n+=" "),n+=r);return n}const lu=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=lu(e[n]))&&(r&&(r+=" "),r+=t);return r};function Q0(e,...t){let r,n,s,a=o;function o(l){const d=t.reduce((u,h)=>h(u),e());return r=G0(d),n=r.cache.get,s=r.cache.set,a=c,c(l)}function c(l){const d=n(l);if(d)return d;const u=H0(l,r);return s(l,u),u}return function(){return a($0.apply(null,arguments))}}const et=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},du=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,uu=/^\((?:(\w[\w-]*):)?(.+)\)$/i,q0=/^\d+\/\d+$/,J0=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,K0=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,I0=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,W0=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Y0=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ns=e=>q0.test(e),Pe=e=>!!e&&!Number.isNaN(Number(e)),Zr=e=>!!e&&Number.isInteger(Number(e)),qo=e=>e.endsWith("%")&&Pe(e.slice(0,-1)),kr=e=>J0.test(e),Z0=()=>!0,X0=e=>K0.test(e)&&!I0.test(e),hu=()=>!1,L0=e=>W0.test(e),D0=e=>Y0.test(e),em=e=>!ge(e)&&!xe(e),tm=e=>Gi(e,pu,hu),ge=e=>du.test(e),jn=e=>Gi(e,gu,X0),Jo=e=>Gi(e,am,Pe),Pl=e=>Gi(e,fu,hu),rm=e=>Gi(e,mu,D0),_a=e=>Gi(e,xu,L0),xe=e=>uu.test(e),Wi=e=>zi(e,gu),nm=e=>zi(e,om),Bl=e=>zi(e,fu),sm=e=>zi(e,pu),im=e=>zi(e,mu),Ua=e=>zi(e,xu,!0),Gi=(e,t,r)=>{const n=du.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},zi=(e,t,r=!1)=>{const n=uu.exec(e);return n?n[1]?t(n[1]):r:!1},fu=e=>e==="position"||e==="percentage",mu=e=>e==="image"||e==="url",pu=e=>e==="length"||e==="size"||e==="bg-size",gu=e=>e==="length",am=e=>e==="number",om=e=>e==="family-name",xu=e=>e==="shadow",cm=()=>{const e=et("color"),t=et("font"),r=et("text"),n=et("font-weight"),s=et("tracking"),a=et("leading"),o=et("breakpoint"),c=et("container"),l=et("spacing"),d=et("radius"),u=et("shadow"),h=et("inset-shadow"),m=et("text-shadow"),p=et("drop-shadow"),b=et("blur"),g=et("perspective"),v=et("aspect"),N=et("ease"),V=et("animate"),E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Y=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],O=()=>[...Y(),xe,ge],Z=()=>["auto","hidden","clip","visible","scroll"],q=()=>["auto","contain","none"],R=()=>[xe,ge,l],K=()=>[Ns,"full","auto",...R()],ne=()=>[Zr,"none","subgrid",xe,ge],z=()=>["auto",{span:["full",Zr,xe,ge]},Zr,xe,ge],k=()=>[Zr,"auto",xe,ge],S=()=>["auto","min","max","fr",xe,ge],ce=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],U=()=>["start","end","center","stretch","center-safe","end-safe"],C=()=>["auto",...R()],j=()=>[Ns,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...R()],w=()=>[e,xe,ge],H=()=>[...Y(),Bl,Pl,{position:[xe,ge]}],J=()=>["no-repeat",{repeat:["","x","y","space","round"]}],y=()=>["auto","cover","contain",sm,tm,{size:[xe,ge]}],M=()=>[qo,Wi,jn],P=()=>["","none","full",d,xe,ge],Q=()=>["",Pe,Wi,jn],L=()=>["solid","dashed","dotted","double"],se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],F=()=>[Pe,qo,Bl,Pl],I=()=>["","none",b,xe,ge],ee=()=>["none",Pe,xe,ge],D=()=>["none",Pe,xe,ge],re=()=>[Pe,xe,ge],oe=()=>[Ns,"full",...R()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[kr],breakpoint:[kr],color:[Z0],container:[kr],"drop-shadow":[kr],ease:["in","out","in-out"],font:[em],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[kr],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[kr],shadow:[kr],spacing:["px",Pe],text:[kr],"text-shadow":[kr],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ns,ge,xe,v]}],container:["container"],columns:[{columns:[Pe,ge,xe,c]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:O()}],overflow:[{overflow:Z()}],"overflow-x":[{"overflow-x":Z()}],"overflow-y":[{"overflow-y":Z()}],overscroll:[{overscroll:q()}],"overscroll-x":[{"overscroll-x":q()}],"overscroll-y":[{"overscroll-y":q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:K()}],"inset-x":[{"inset-x":K()}],"inset-y":[{"inset-y":K()}],start:[{start:K()}],end:[{end:K()}],top:[{top:K()}],right:[{right:K()}],bottom:[{bottom:K()}],left:[{left:K()}],visibility:["visible","invisible","collapse"],z:[{z:[Zr,"auto",xe,ge]}],basis:[{basis:[Ns,"full","auto",c,...R()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Pe,Ns,"auto","initial","none",ge]}],grow:[{grow:["",Pe,xe,ge]}],shrink:[{shrink:["",Pe,xe,ge]}],order:[{order:[Zr,"first","last","none",xe,ge]}],"grid-cols":[{"grid-cols":ne()}],"col-start-end":[{col:z()}],"col-start":[{"col-start":k()}],"col-end":[{"col-end":k()}],"grid-rows":[{"grid-rows":ne()}],"row-start-end":[{row:z()}],"row-start":[{"row-start":k()}],"row-end":[{"row-end":k()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":S()}],"auto-rows":[{"auto-rows":S()}],gap:[{gap:R()}],"gap-x":[{"gap-x":R()}],"gap-y":[{"gap-y":R()}],"justify-content":[{justify:[...ce(),"normal"]}],"justify-items":[{"justify-items":[...U(),"normal"]}],"justify-self":[{"justify-self":["auto",...U()]}],"align-content":[{content:["normal",...ce()]}],"align-items":[{items:[...U(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...U(),{baseline:["","last"]}]}],"place-content":[{"place-content":ce()}],"place-items":[{"place-items":[...U(),"baseline"]}],"place-self":[{"place-self":["auto",...U()]}],p:[{p:R()}],px:[{px:R()}],py:[{py:R()}],ps:[{ps:R()}],pe:[{pe:R()}],pt:[{pt:R()}],pr:[{pr:R()}],pb:[{pb:R()}],pl:[{pl:R()}],m:[{m:C()}],mx:[{mx:C()}],my:[{my:C()}],ms:[{ms:C()}],me:[{me:C()}],mt:[{mt:C()}],mr:[{mr:C()}],mb:[{mb:C()}],ml:[{ml:C()}],"space-x":[{"space-x":R()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":R()}],"space-y-reverse":["space-y-reverse"],size:[{size:j()}],w:[{w:[c,"screen",...j()]}],"min-w":[{"min-w":[c,"screen","none",...j()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[o]},...j()]}],h:[{h:["screen","lh",...j()]}],"min-h":[{"min-h":["screen","lh","none",...j()]}],"max-h":[{"max-h":["screen","lh",...j()]}],"font-size":[{text:["base",r,Wi,jn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,xe,Jo]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",qo,ge]}],"font-family":[{font:[nm,ge,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,xe,ge]}],"line-clamp":[{"line-clamp":[Pe,"none",xe,Jo]}],leading:[{leading:[a,...R()]}],"list-image":[{"list-image":["none",xe,ge]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",xe,ge]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:w()}],"text-color":[{text:w()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...L(),"wavy"]}],"text-decoration-thickness":[{decoration:[Pe,"from-font","auto",xe,jn]}],"text-decoration-color":[{decoration:w()}],"underline-offset":[{"underline-offset":[Pe,"auto",xe,ge]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xe,ge]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xe,ge]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:H()}],"bg-repeat":[{bg:J()}],"bg-size":[{bg:y()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Zr,xe,ge],radial:["",xe,ge],conic:[Zr,xe,ge]},im,rm]}],"bg-color":[{bg:w()}],"gradient-from-pos":[{from:M()}],"gradient-via-pos":[{via:M()}],"gradient-to-pos":[{to:M()}],"gradient-from":[{from:w()}],"gradient-via":[{via:w()}],"gradient-to":[{to:w()}],rounded:[{rounded:P()}],"rounded-s":[{"rounded-s":P()}],"rounded-e":[{"rounded-e":P()}],"rounded-t":[{"rounded-t":P()}],"rounded-r":[{"rounded-r":P()}],"rounded-b":[{"rounded-b":P()}],"rounded-l":[{"rounded-l":P()}],"rounded-ss":[{"rounded-ss":P()}],"rounded-se":[{"rounded-se":P()}],"rounded-ee":[{"rounded-ee":P()}],"rounded-es":[{"rounded-es":P()}],"rounded-tl":[{"rounded-tl":P()}],"rounded-tr":[{"rounded-tr":P()}],"rounded-br":[{"rounded-br":P()}],"rounded-bl":[{"rounded-bl":P()}],"border-w":[{border:Q()}],"border-w-x":[{"border-x":Q()}],"border-w-y":[{"border-y":Q()}],"border-w-s":[{"border-s":Q()}],"border-w-e":[{"border-e":Q()}],"border-w-t":[{"border-t":Q()}],"border-w-r":[{"border-r":Q()}],"border-w-b":[{"border-b":Q()}],"border-w-l":[{"border-l":Q()}],"divide-x":[{"divide-x":Q()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Q()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...L(),"hidden","none"]}],"divide-style":[{divide:[...L(),"hidden","none"]}],"border-color":[{border:w()}],"border-color-x":[{"border-x":w()}],"border-color-y":[{"border-y":w()}],"border-color-s":[{"border-s":w()}],"border-color-e":[{"border-e":w()}],"border-color-t":[{"border-t":w()}],"border-color-r":[{"border-r":w()}],"border-color-b":[{"border-b":w()}],"border-color-l":[{"border-l":w()}],"divide-color":[{divide:w()}],"outline-style":[{outline:[...L(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Pe,xe,ge]}],"outline-w":[{outline:["",Pe,Wi,jn]}],"outline-color":[{outline:w()}],shadow:[{shadow:["","none",u,Ua,_a]}],"shadow-color":[{shadow:w()}],"inset-shadow":[{"inset-shadow":["none",h,Ua,_a]}],"inset-shadow-color":[{"inset-shadow":w()}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:w()}],"ring-offset-w":[{"ring-offset":[Pe,jn]}],"ring-offset-color":[{"ring-offset":w()}],"inset-ring-w":[{"inset-ring":Q()}],"inset-ring-color":[{"inset-ring":w()}],"text-shadow":[{"text-shadow":["none",m,Ua,_a]}],"text-shadow-color":[{"text-shadow":w()}],opacity:[{opacity:[Pe,xe,ge]}],"mix-blend":[{"mix-blend":[...se(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":se()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Pe]}],"mask-image-linear-from-pos":[{"mask-linear-from":F()}],"mask-image-linear-to-pos":[{"mask-linear-to":F()}],"mask-image-linear-from-color":[{"mask-linear-from":w()}],"mask-image-linear-to-color":[{"mask-linear-to":w()}],"mask-image-t-from-pos":[{"mask-t-from":F()}],"mask-image-t-to-pos":[{"mask-t-to":F()}],"mask-image-t-from-color":[{"mask-t-from":w()}],"mask-image-t-to-color":[{"mask-t-to":w()}],"mask-image-r-from-pos":[{"mask-r-from":F()}],"mask-image-r-to-pos":[{"mask-r-to":F()}],"mask-image-r-from-color":[{"mask-r-from":w()}],"mask-image-r-to-color":[{"mask-r-to":w()}],"mask-image-b-from-pos":[{"mask-b-from":F()}],"mask-image-b-to-pos":[{"mask-b-to":F()}],"mask-image-b-from-color":[{"mask-b-from":w()}],"mask-image-b-to-color":[{"mask-b-to":w()}],"mask-image-l-from-pos":[{"mask-l-from":F()}],"mask-image-l-to-pos":[{"mask-l-to":F()}],"mask-image-l-from-color":[{"mask-l-from":w()}],"mask-image-l-to-color":[{"mask-l-to":w()}],"mask-image-x-from-pos":[{"mask-x-from":F()}],"mask-image-x-to-pos":[{"mask-x-to":F()}],"mask-image-x-from-color":[{"mask-x-from":w()}],"mask-image-x-to-color":[{"mask-x-to":w()}],"mask-image-y-from-pos":[{"mask-y-from":F()}],"mask-image-y-to-pos":[{"mask-y-to":F()}],"mask-image-y-from-color":[{"mask-y-from":w()}],"mask-image-y-to-color":[{"mask-y-to":w()}],"mask-image-radial":[{"mask-radial":[xe,ge]}],"mask-image-radial-from-pos":[{"mask-radial-from":F()}],"mask-image-radial-to-pos":[{"mask-radial-to":F()}],"mask-image-radial-from-color":[{"mask-radial-from":w()}],"mask-image-radial-to-color":[{"mask-radial-to":w()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":Y()}],"mask-image-conic-pos":[{"mask-conic":[Pe]}],"mask-image-conic-from-pos":[{"mask-conic-from":F()}],"mask-image-conic-to-pos":[{"mask-conic-to":F()}],"mask-image-conic-from-color":[{"mask-conic-from":w()}],"mask-image-conic-to-color":[{"mask-conic-to":w()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:H()}],"mask-repeat":[{mask:J()}],"mask-size":[{mask:y()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",xe,ge]}],filter:[{filter:["","none",xe,ge]}],blur:[{blur:I()}],brightness:[{brightness:[Pe,xe,ge]}],contrast:[{contrast:[Pe,xe,ge]}],"drop-shadow":[{"drop-shadow":["","none",p,Ua,_a]}],"drop-shadow-color":[{"drop-shadow":w()}],grayscale:[{grayscale:["",Pe,xe,ge]}],"hue-rotate":[{"hue-rotate":[Pe,xe,ge]}],invert:[{invert:["",Pe,xe,ge]}],saturate:[{saturate:[Pe,xe,ge]}],sepia:[{sepia:["",Pe,xe,ge]}],"backdrop-filter":[{"backdrop-filter":["","none",xe,ge]}],"backdrop-blur":[{"backdrop-blur":I()}],"backdrop-brightness":[{"backdrop-brightness":[Pe,xe,ge]}],"backdrop-contrast":[{"backdrop-contrast":[Pe,xe,ge]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Pe,xe,ge]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Pe,xe,ge]}],"backdrop-invert":[{"backdrop-invert":["",Pe,xe,ge]}],"backdrop-opacity":[{"backdrop-opacity":[Pe,xe,ge]}],"backdrop-saturate":[{"backdrop-saturate":[Pe,xe,ge]}],"backdrop-sepia":[{"backdrop-sepia":["",Pe,xe,ge]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":R()}],"border-spacing-x":[{"border-spacing-x":R()}],"border-spacing-y":[{"border-spacing-y":R()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",xe,ge]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Pe,"initial",xe,ge]}],ease:[{ease:["linear","initial",N,xe,ge]}],delay:[{delay:[Pe,xe,ge]}],animate:[{animate:["none",V,xe,ge]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[g,xe,ge]}],"perspective-origin":[{"perspective-origin":O()}],rotate:[{rotate:ee()}],"rotate-x":[{"rotate-x":ee()}],"rotate-y":[{"rotate-y":ee()}],"rotate-z":[{"rotate-z":ee()}],scale:[{scale:D()}],"scale-x":[{"scale-x":D()}],"scale-y":[{"scale-y":D()}],"scale-z":[{"scale-z":D()}],"scale-3d":["scale-3d"],skew:[{skew:re()}],"skew-x":[{"skew-x":re()}],"skew-y":[{"skew-y":re()}],transform:[{transform:[xe,ge,"","none","gpu","cpu"]}],"transform-origin":[{origin:O()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:oe()}],"translate-x":[{"translate-x":oe()}],"translate-y":[{"translate-y":oe()}],"translate-z":[{"translate-z":oe()}],"translate-none":["translate-none"],accent:[{accent:w()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:w()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xe,ge]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xe,ge]}],fill:[{fill:["none",...w()]}],"stroke-w":[{stroke:[Pe,Wi,jn,Jo]}],stroke:[{stroke:["none",...w()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},lm=Q0(cm);function Ti(...e){return lm(_e(e))}const dm=({status:e,size:t="md",isAnimated:r=!1})=>{const s=Ti("rounded-full border-2 border-gray-300",{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-6 h-6"}[t],r&&e==="yellow"&&"animate-pulse"),a={red:"bg-red-500 border-red-400 shadow-red-500/50",yellow:"bg-yellow-500 border-yellow-400 shadow-yellow-500/50",green:"bg-green-500 border-green-400 shadow-green-500/50",gray:"bg-gray-300 border-gray-400"};return i.jsx("div",{className:Ti(s,a[e],e!=="gray"&&"shadow-lg")})},um=({stage:e,progress:t,onRetryStep:r,onToggle:n})=>{var u;const s=S0(e),a=((u=j0(t))==null?void 0:u.id)===e.id,o=e.steps.filter(h=>h.status==="completed").length,c=e.steps.length,l=e.steps.some(h=>h.status==="failed"),d=e.steps.find(h=>h.status==="loading");return i.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[i.jsxs("button",{onClick:()=>n(e.id),className:Ti("w-full flex items-center justify-between p-4 text-left transition-colors","hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500",a&&"bg-blue-50 border-blue-200"),children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(dm,{status:s,size:"lg",isAnimated:e.status==="loading"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:e.title}),i.jsx("p",{className:"text-sm text-gray-600",children:e.description}),i.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[i.jsxs("span",{className:"text-xs text-gray-500",children:[o,"/",c," steps"]}),e.status==="loading"&&d&&i.jsx("span",{className:"text-xs text-blue-600 font-medium",children:d.title}),l&&i.jsx("span",{className:"text-xs text-red-600 font-medium",children:"Needs attention"})]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[e.status==="loading"&&i.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:i.jsx(St,{className:"w-4 h-4 text-blue-500 animate-spin"})}),e.isCollapsed?i.jsx(ia,{className:"w-5 h-5 text-gray-400"}):i.jsx(e0,{className:"w-5 h-5 text-gray-400"})]})]}),!e.isCollapsed&&i.jsx("div",{className:"border-t border-gray-200 bg-gray-50",children:i.jsx("div",{className:"p-4 space-y-3",children:e.steps.map(h=>i.jsxs("div",{className:Ti("flex items-center justify-between p-3 bg-white rounded border",h.status==="loading"&&"border-blue-200 bg-blue-50",h.status==="failed"&&"border-red-200 bg-red-50",h.status==="completed"&&"border-green-200 bg-green-50"),children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs("div",{className:"flex-shrink-0",children:[h.status==="completed"&&i.jsx($r,{className:"w-5 h-5 text-green-600"}),h.status==="failed"&&i.jsx(a0,{className:"w-5 h-5 text-red-600"}),h.status==="loading"&&i.jsx(St,{className:"w-5 h-5 text-blue-600 animate-spin"}),h.status==="pending"&&i.jsx(eu,{className:"w-5 h-5 text-gray-400"}),h.status==="skipped"&&i.jsx(b0,{className:"w-5 h-5 text-yellow-600"})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:h.title}),i.jsx("p",{className:"text-xs text-gray-600",children:h.description}),h.error&&i.jsx("p",{className:"text-xs text-red-600 mt-1",children:h.error}),h.txHash&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:["Tx: ",h.txHash.slice(0,10),"...",h.txHash.slice(-8)]})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[h.status==="failed"&&h.retryable&&r&&i.jsxs("button",{onClick:m=>{m.stopPropagation(),r(h.id)},className:"flex items-center space-x-1 px-2 py-1 text-xs font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-100 rounded transition-colors",children:[i.jsx(g0,{className:"w-3 h-3"}),i.jsx("span",{children:"Retry"})]}),h.estimatedDuration&&h.status==="pending"&&i.jsxs("span",{className:"text-xs text-gray-500",children:["~",h.estimatedDuration,"s"]})]})]},h.id))})})]})},bu=({progress:e,onRetryStep:t,onToggleStage:r,className:n})=>{const[s,a]=_.useState(e);Uf.useEffect(()=>{a(e)},[e]);const o=h=>{r?r(h):a(m=>T0(m,h))},c=s.steps.length,l=s.steps.filter(h=>h.status==="completed").length,d=s.steps.filter(h=>h.status==="failed").length,u=Math.round(l/c*100);return i.jsxs("div",{className:Ti("space-y-4",n),children:[i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:s.direction==="evm-to-ic"?"ðŸ”„ EVM â†’ IC Bridge":"ðŸ”„ IC â†’ EVM Cast"}),i.jsxs("div",{className:"text-sm text-gray-600",children:[l,"/",c," steps"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:i.jsx("div",{className:Ti("h-2 rounded-full transition-all duration-300",d>0?"bg-red-500":"bg-blue-500"),style:{width:`${u}%`}})}),i.jsxs("div",{className:"flex items-center justify-between text-sm",children:[i.jsxs("span",{className:"text-gray-600",children:[u,"% complete"]}),d>0&&i.jsxs("span",{className:"text-red-600 font-medium",children:[d," failed step",d!==1?"s":""]})]})]}),i.jsx("div",{className:"space-y-2",children:s.stages.map(h=>i.jsx(um,{stage:h,progress:s,onRetryStep:t,onToggle:o},h.id))})]})},ji=({IDL:e})=>{const t=e.Rec(),r=e.Variant({Alchemy:e.Null,BlockPi:e.Null,PublicNode:e.Null,Ankr:e.Null,Sepolia:e.Null}),n=e.Variant({Alchemy:e.Null,Llama:e.Null,BlockPi:e.Null,PublicNode:e.Null,Ankr:e.Null}),s=e.Nat64,a=e.Record({value:e.Text,name:e.Text}),o=e.Record({url:e.Text,headers:e.Opt(e.Vec(a))}),c=e.Variant({Alchemy:e.Null,Llama:e.Null,BlockPi:e.Null,Cloudflare:e.Null,PublicNode:e.Null,Ankr:e.Null}),l=e.Variant({EthSepolia:e.Opt(e.Vec(r)),BaseMainnet:e.Opt(e.Vec(n)),Custom:e.Record({chainId:s,services:e.Vec(o)}),OptimismMainnet:e.Opt(e.Vec(n)),ArbitrumOne:e.Opt(e.Vec(n)),EthMainnet:e.Opt(e.Vec(c))}),d=e.Record({owner:e.Principal,subaccount:e.Opt(e.Vec(e.Nat8))}),u=e.Record({value:t,name:e.Text,immutable:e.Bool});t.fill(e.Variant({Int:e.Int,Map:e.Vec(e.Tuple(e.Text,t)),Nat:e.Nat,Set:e.Vec(t),Nat16:e.Nat16,Nat32:e.Nat32,Nat64:e.Nat64,Blob:e.Vec(e.Nat8),Bool:e.Bool,Int8:e.Int8,Ints:e.Vec(e.Int),Nat8:e.Nat8,Nats:e.Vec(e.Nat),Text:e.Text,Bytes:e.Vec(e.Nat8),Int16:e.Int16,Int32:e.Int32,Int64:e.Int64,Option:e.Opt(t),Floats:e.Vec(e.Float64),Float:e.Float64,Principal:e.Principal,Array:e.Vec(t),ValueMap:e.Vec(e.Tuple(t,t)),Class:e.Vec(u)}));const h=e.Vec(e.Tuple(e.Text,t)),m=e.Variant({IC:e.Opt(e.Text),Ethereum:e.Opt(e.Nat),Solana:e.Opt(e.Nat),Bitcoin:e.Opt(e.Text),Other:h}),p=e.Record({contract:e.Text,network:m}),b=e.Record({uri:e.Text,originalMinterAccount:e.Opt(d),tokenId:e.Nat,gasPrice:e.Opt(e.Nat),memo:e.Opt(e.Vec(e.Nat8)),remoteContract:p,nativeContract:p,maxPriorityFeePerGas:e.Opt(e.Nat),castId:e.Nat,created_at_time:e.Opt(e.Nat),gasLimit:e.Opt(e.Nat),targetOwner:e.Text,originalCaller:d}),g=e.Variant({GenericError:e.Text,NoCkNFTCanister:e.Null,NetworkError:e.Text,ExistingCast:e.Nat,InsufficientAllowance:e.Tuple(e.Nat,e.Nat),InvalidTransaction:e.Text,InsufficientBalance:e.Tuple(e.Nat,e.Nat),NotFound:e.Null,InsufficientCycles:e.Tuple(e.Nat,e.Nat),TransferNotVerified:e.Variant({TooManyRetries:e.Nat,NoConsensus:e.Null}),MintNotVerified:e.Variant({TooManyRetries:e.Nat,NoConsensus:e.Null}),Unauthorized:e.Null,ContractNotVerified:e.Variant({TooManyRetries:e.Nat,NoConsensus:e.Null}),InvalidContract:e.Null}),v=e.Variant({Ok:e.Nat,Err:g}),N=e.Variant({Generic:o}),V=e.Nat64,E=e.Variant({EthSepolia:r,BaseMainnet:n,Custom:o,OptimismMainnet:n,ArbitrumOne:n,EthMainnet:c,Provider:V}),Y=e.Variant({Generic:o}),O=e.Variant({Generic:o}),Z=e.Variant({IC:e.Record({rpc:N,canisterId:e.Principal}),Ethereum:e.Record({rpc:E,canisterId:e.Principal}),Solana:e.Record({rpc:Y,canisterId:e.Principal}),Bitcoin:e.Record({rpc:O,canisterId:e.Principal}),Other:e.Vec(e.Tuple(e.Text,t))}),q=e.Variant({SetTecdsaKeyName:e.Text,MapNetwork:e.Record({service:Z,action:e.Variant({Add:e.Null,Remove:e.Null}),network:m})}),R=e.Variant({GenericError:e.Text,Unauthorized:e.Null,MapNetwork:e.Variant({NotFound:e.Null,Exists:e.Null})}),K=e.Variant({Ok:e.Nat,Err:R}),ne=e.Record({logo:e.Opt(e.Text),name:e.Opt(e.Text),description:e.Opt(e.Text),symbol:e.Opt(e.Text)}),z=e.Record({code:e.Int64,message:e.Text}),k=e.Variant({TooFewCycles:e.Record({expected:e.Nat,received:e.Nat}),InvalidRpcConfig:e.Text,MissingRequiredProvider:e.Null,ProviderNotFound:e.Null,NoPermission:e.Null}),S=e.Variant({Custom:e.Text,InvalidHex:e.Text}),ce=e.Variant({NoError:e.Null,CanisterError:e.Null,SysTransient:e.Null,DestinationInvalid:e.Null,Unknown:e.Null,SysFatal:e.Null,CanisterReject:e.Null}),U=e.Variant({IcError:e.Record({code:ce,message:e.Text}),InvalidHttpJsonRpcResponse:e.Record({status:e.Nat16,body:e.Text,parsingError:e.Opt(e.Text)})}),C=e.Variant({JsonRpcError:z,ProviderError:k,ValidationError:S,HttpOutcallError:U}),j=e.Variant({Ok:e.Opt(e.Text),NonceTooLow:e.Null,NonceTooHigh:e.Null,InsufficientFunds:e.Null}),w=e.Variant({Ok:j,Err:C}),H=e.Variant({Consistent:w,Inconsistent:e.Vec(e.Tuple(E,w))}),J=e.Variant({RPC:e.Variant({Ethereum:C,EthereumMultiSend:H}),GenericError:e.Text,NoCkNFTCanister:e.Null,InsufficientAllowance:e.Tuple(e.Nat,e.Nat),InsufficientBalance:e.Tuple(e.Nat,e.Nat),InsufficientCycles:e.Tuple(e.Nat,e.Nat),Unauthorized:e.Null,NetworkRCPNotFound:e.Null,NotImplemented:e.Null}),y=e.Variant({Ok:e.Principal,Err:J}),M=e.Variant({RPC:e.Variant({Ethereum:C,EthereumMultiSend:H}),GenericError:e.Text,NoCkNFTCanister:e.Null,InsufficientAllowance:e.Tuple(e.Nat,e.Nat),InsufficientBalance:e.Tuple(e.Nat,e.Nat),InsufficientCycles:e.Tuple(e.Nat,e.Nat),Unauthorized:e.Null,NetworkRCPNotFound:e.Null,NotImplemented:e.Null}),P=e.Variant({Ok:e.Nat,Err:M}),Q=e.Record({contract:e.Text,network:m}),L=e.Variant({Error:g,WaitingOnContract:e.Record({transaction:e.Text}),RemoteFinalized:e.Text,SubmittedToOrchestrator:e.Record({localCastId:e.Nat,remoteCastId:e.Nat}),WaitingOnMint:e.Record({transaction:e.Text}),WaitingOnTransfer:e.Record({transaction:e.Text}),Created:e.Null,Completed:e.Nat,SubmittingToOrchestrator:e.Nat}),se=e.Record({tokenId:e.Nat,contract:e.Text,network:m}),F=e.Variant({StartMetadataTransfer:e.Null,StartMint:e.Null,StartOwnershipVerification:e.Null}),I=e.Record({nft:se,resume:e.Opt(e.Tuple(e.Nat,F)),mintToAccount:d,spender:e.Opt(d)}),ee=e.Variant({RPC:e.Variant({Ethereum:C,EthereumMultiSend:H}),GenericError:e.Text,NoCkNFTCanister:e.Null,InsufficientAllowance:e.Tuple(e.Nat,e.Nat),InsufficientBalance:e.Tuple(e.Nat,e.Nat),InsufficientCycles:e.Tuple(e.Nat,e.Nat),Unauthorized:e.Null,NetworkRCPNotFound:e.Null,NotImplemented:e.Null}),D=e.Variant({Err:e.Variant({GenericError:e.Text,MintError:e.Text,ApprovalError:e.Text,InvalidTransfer:e.Text,OwnershipNotVerified:e.Variant({RemoteError:ee,InvalidOwner:e.Null,TooManyRetries:e.Nat}),MetadataError:e.Text,InvalidMetadata:e.Text}),Transferring:e.Null,Minting:e.Null,RetrievingMetadata:e.Record({nextQuery:e.Nat,retries:e.Nat}),Complete:e.Record({approvalTrx:e.Opt(e.Nat),mintTrx:e.Nat,approvalError:e.Opt(e.Text)}),CheckingOwner:e.Record({nextQuery:e.Nat,retries:e.Nat})}),re=e.Variant({IC:e.Opt(e.Text),Ethereum:e.Opt(e.Nat),Solana:e.Opt(e.Nat),Bitcoin:e.Opt(e.Text),Other:h}),oe=e.Record({nextQuery:e.Opt(e.Nat),contractType:e.Variant({Remote:e.Null,Owned:p}),network:e.Opt(m),writingContractCanisterId:e.Opt(e.Text),ckNFTCanisterId:e.Opt(e.Nat),address:e.Opt(e.Text),confirmed:e.Bool,deploymentTrx:e.Opt(e.Text),contractId:e.Nat,retries:e.Opt(e.Nat)}),pe=e.Record({remoteNFTPointer:se,account:d}),Ne=e.Record({owner:e.Principal,subaccount:e.Opt(e.Vec(e.Nat8))}),Te=e.Variant({Ok:e.Text,Err:ee}),ae=e.Nat,Ae=e.Record({id:e.Nat,time:ae}),Re=e.Record({aSync:e.Opt(e.Nat),actionType:e.Text,params:e.Vec(e.Nat8),retries:e.Nat}),de=e.Tuple(Ae,Re),G=e.Nat,$=e.Record({timers:e.Nat,maxExecutions:e.Nat,minAction:e.Opt(de),cycles:e.Nat,nextActionId:e.Nat,nextTimer:e.Opt(G),expectedExecutionTime:e.Opt(ae),lastExecutionTime:ae}),X=e.Variant({IC:e.Opt(e.Text),Ethereum:e.Opt(e.Nat),Solana:e.Opt(e.Nat),Bitcoin:e.Opt(e.Text),Other:h}),le=e.Text,be=e.Record({principal:e.Principal,lastCycles:e.Nat,network:X,networkMap:e.Vec(e.Tuple(X,le)),lastCyclesTimestamp:e.Nat,ckNFTCanisterId:e.Nat,nativeContract:le}),he=e.Variant({IC:e.Record({rpc:N,canisterId:e.Principal}),Ethereum:e.Record({rpc:E,canisterId:e.Principal}),Solana:e.Record({rpc:Y,canisterId:e.Principal}),Bitcoin:e.Record({rpc:O,canisterId:e.Principal}),Other:e.Vec(e.Tuple(e.Text,t))}),Ee=e.Record({nextQuery:e.Opt(e.Nat),contractType:e.Variant({Remote:e.Null,Owned:p}),network:e.Opt(m),writingContractCanisterId:e.Opt(e.Text),ckNFTCanisterId:e.Opt(e.Nat),address:e.Opt(e.Text),confirmed:e.Bool,deploymentTrx:e.Opt(e.Text),contractId:e.Nat,retries:e.Opt(e.Nat)}),He=e.Record({tt:$,ckNFTCanisters:e.Vec(be),owner:e.Principal,networkMap:e.Vec(e.Tuple(m,e.Vec(he))),contracts:e.Vec(Ee)}),ie=e.Nat,we=e.Variant({RPC:e.Variant({Ethereum:C,EthereumMultiSend:H}),InvalidAccount:e.Null,GenericError:e.Text,NoCkNFTCanister:e.Null,InvalidMintStatus:e.Null,InsufficientAllowance:e.Tuple(e.Nat,e.Nat),InvalidSpender:e.Null,InsufficientBalance:e.Tuple(e.Nat,e.Nat),InvalidMintRequest:e.Null,InsufficientCycles:e.Tuple(e.Nat,e.Nat),Unauthorized:e.Null,NetworkRCPNotFound:e.Null,NotImplemented:e.Null,InvalidMintRequestId:e.Null,InvalidRemoteNFTPointer:e.Null,InvalidResumeOption:e.Null}),Ce=e.Variant({Ok:ie,Err:we});return e.Service({calc_eth_call_cycles:e.Func([l,e.Nat,e.Text],[e.Nat],["query"]),cast:e.Func([b],[v],[]),configure:e.Func([e.Vec(q)],[e.Vec(e.Opt(K))],[]),create_canister:e.Func([p,ne,e.Opt(d)],[y],[]),create_remote:e.Func([p,m,e.Nat,e.Nat,e.Nat,e.Opt(d)],[P],[]),forceCkNFTCaniser:e.Func([Q,e.Principal],[],[]),get_cast_status:e.Func([e.Vec(e.Nat)],[e.Vec(e.Opt(L))],["query"]),get_ck_nft_canister:e.Func([e.Vec(p)],[e.Vec(e.Opt(e.Principal))],["query"]),get_creation_cost:e.Func([p],[e.Nat],[]),get_icrc99_address:e.Func([e.Principal,m],[e.Opt(e.Text)],[]),get_mint_cost:e.Func([e.Vec(I)],[e.Vec(e.Opt(e.Nat))],["query"]),get_mint_status:e.Func([e.Vec(e.Nat)],[e.Vec(e.Opt(D))],["query"]),get_remote:e.Func([e.Vec(e.Tuple(e.Principal,re))],[e.Vec(e.Opt(oe))],["query"]),get_remote_approval_address:e.Func([pe,e.Opt(d)],[e.Opt(e.Text)],[]),get_remote_cost:e.Func([p,m],[e.Nat],["query"]),get_remote_meta:e.Func([e.Vec(se),e.Vec(e.Nat),e.Opt(Ne)],[e.Vec(e.Opt(Te))],[]),get_remote_owner:e.Func([e.Vec(se),e.Opt(Ne)],[e.Vec(e.Opt(Te))],[]),get_remote_status:e.Func([e.Vec(e.Nat)],[e.Vec(e.Opt(oe))],["query"]),get_stats:e.Func([],[He],["query"]),mint:e.Func([I,e.Opt(d)],[Ce],[]),system_upgrade:e.Func([],[],[]),upgrade_ckNFT_canister:e.Func([e.Principal],[],[])})},Ol=({IDL:e})=>{const t=e.Rec(),r=e.Rec(),n=e.Rec(),s=e.Rec(),a=e.Record({deployer:e.Principal,max_approvals:e.Opt(e.Nat),max_approvals_per_token_or_collection:e.Opt(e.Nat),settle_to_approvals:e.Opt(e.Nat),max_revoke_approvals:e.Opt(e.Nat),collection_approval_requires_token:e.Opt(e.Bool)});e.Opt(a);const o=e.Variant({Stable:e.Null,StableTyped:e.Null,Managed:e.Null}),c=e.Record({url:e.Text,block_type:e.Text});e.Record({maxRecordsToArchive:e.Nat,archiveIndexType:o,maxArchivePages:e.Nat,settleToRecords:e.Nat,archiveCycles:e.Nat,maxActiveRecords:e.Nat,maxRecordsInArchiveInstance:e.Nat,archiveControllers:e.Opt(e.Opt(e.Vec(e.Principal))),supportedBlocks:e.Vec(c)});const l=e.Vec(e.Nat8),d=e.Record({owner:e.Principal,subaccount:e.Opt(l)}),u=e.Vec(e.Record({url:e.Text,name:e.Text})),h=e.Record({deployer:e.Principal,allow_transfers:e.Opt(e.Bool),supply_cap:e.Opt(e.Nat),tx_window:e.Opt(e.Nat),burn_account:e.Opt(d),default_take_value:e.Opt(e.Nat),logo:e.Opt(e.Text),permitted_drift:e.Opt(e.Nat),name:e.Opt(e.Text),description:e.Opt(e.Text),max_take_value:e.Opt(e.Nat),max_update_batch_size:e.Opt(e.Nat),max_query_batch_size:e.Opt(e.Nat),max_memo_size:e.Opt(e.Nat),supported_standards:e.Opt(u),symbol:e.Opt(e.Text)});e.Opt(h);const m=e.Record({value:r,name:e.Text,immutable:e.Bool});r.fill(e.Variant({Int:e.Int,Map:e.Vec(e.Tuple(e.Text,r)),Nat:e.Nat,Set:e.Vec(r),Nat16:e.Nat16,Nat32:e.Nat32,Nat64:e.Nat64,Blob:e.Vec(e.Nat8),Bool:e.Bool,Int8:e.Int8,Ints:e.Vec(e.Int),Nat8:e.Nat8,Nats:e.Vec(e.Nat),Text:e.Text,Bytes:e.Vec(e.Nat8),Int16:e.Int16,Int32:e.Int32,Int64:e.Int64,Option:e.Opt(r),Floats:e.Vec(e.Float64),Float:e.Float64,Principal:e.Principal,Array:e.Vec(r),ValueMap:e.Vec(e.Tuple(r,r)),Class:e.Vec(m)}));const p=e.Vec(e.Tuple(e.Text,r)),b=e.Variant({IC:e.Opt(e.Text),Ethereum:e.Opt(e.Nat),Solana:e.Opt(e.Nat),Bitcoin:e.Opt(e.Text),Other:p}),g=e.Record({contract:e.Text,network:b}),v=e.Record({service:e.Opt(e.Principal),nativeChain:g});e.Opt(v);const N=e.Record({owner:e.Principal,subaccount:e.Opt(l)}),V=e.Record({owner:e.Principal,subaccount:e.Opt(e.Vec(e.Nat8))}),E=e.Record({contract:e.Text,network:b}),Y=e.Record({owner:e.Principal,subaccount:e.Opt(e.Vec(e.Nat8))}),O=e.Variant({remote:e.Record({contract:E,owner:e.Text,timestamp:e.Nat}),local:Y}),Z=e.Record({service:e.Opt(e.Principal),originalMinterMap:e.Vec(e.Tuple(e.Nat,V)),nextCastId:e.Nat,orchestrator:e.Principal,cycleSettings:e.Record({amountPerETHCast:e.Nat,cycleLedgerCanister:e.Principal,amountPerBitcoinOwnerRequest:e.Nat,amountPerOtherOwnerRequest:e.Nat,amountPerICOwnerRequest:e.Nat,amountPerSolanaOwnerRequest:e.Nat,amountPerEthOwnerRequest:e.Nat,amountBasePerOwnerRequest:e.Nat}),nativeChain:g,remoteOwnerMap:e.Vec(e.Tuple(e.Nat,O))}),q=e.Record({allow_transfers:e.Bool,supply_cap:e.Opt(e.Nat),tx_window:e.Nat,burn_account:e.Opt(d),default_take_value:e.Nat,logo:e.Opt(e.Text),permitted_drift:e.Nat,name:e.Opt(e.Text),description:e.Opt(e.Text),max_take_value:e.Nat,max_update_batch_size:e.Nat,max_query_batch_size:e.Nat,max_memo_size:e.Nat,symbol:e.Opt(e.Text)}),R=e.Record({owner:e.Principal,nft_count:e.Nat,ledger_info:q,indexes:e.Record({owner_to_nfts_count:e.Nat,nft_to_owner_count:e.Nat,recent_transactions_count:e.Nat}),supported_standards:u,ledger_count:e.Nat}),K=e.Record({last_block_index:e.Vec(e.Nat8),hash_tree:e.Vec(e.Nat8),last_block_hash:e.Vec(e.Nat8)}),ne=e.Vec(e.Record({url:e.Text,name:e.Text})),z=e.Vec(e.Nat8),k=e.Record({owner:e.Principal,subaccount:e.Opt(z)}),S=e.Record({memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(e.Nat64),expires_at:e.Opt(e.Nat64),spender:k}),ce=e.Record({approval_info:S}),U=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Duplicate:e.Record({duplicate_of:e.Nat}),InvalidSpender:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),GenericBatchError:e.Record({message:e.Text,error_code:e.Nat}),TooOld:e.Null}),C=e.Variant({Ok:e.Nat,Err:U}),j=e.Record({token_id:e.Nat,approval_info:S}),w=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Duplicate:e.Record({duplicate_of:e.Nat}),InvalidSpender:e.Null,NonExistingTokenId:e.Null,Unauthorized:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),GenericBatchError:e.Record({message:e.Text,error_code:e.Nat}),TooOld:e.Null}),H=e.Variant({Ok:e.Nat,Err:w}),J=e.Record({memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(e.Nat64),expires_at:e.Opt(e.Nat64),spender:k}),y=e.Record({token_id:e.Nat,approval_info:S}),M=e.Record({token_id:e.Nat,from_subaccount:e.Opt(e.Vec(e.Nat8)),spender:k}),P=e.Record({memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(e.Nat64),spender:e.Opt(k)}),Q=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Duplicate:e.Record({duplicate_of:e.Nat}),Unauthorized:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),ApprovalDoesNotExist:e.Null,GenericBatchError:e.Record({message:e.Text,error_code:e.Nat}),TooOld:e.Null}),L=e.Variant({Ok:e.Nat,Err:Q}),se=e.Record({token_id:e.Nat,memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(e.Nat64),spender:e.Opt(k)}),F=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Duplicate:e.Record({duplicate_of:e.Nat}),NonExistingTokenId:e.Null,Unauthorized:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),ApprovalDoesNotExist:e.Null,GenericBatchError:e.Record({message:e.Text,error_code:e.Nat}),TooOld:e.Null}),I=e.Variant({Ok:e.Nat,Err:F}),ee=e.Record({to:k,spender_subaccount:e.Opt(e.Vec(e.Nat8)),token_id:e.Nat,from:k,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(e.Nat64)}),D=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Duplicate:e.Record({duplicate_of:e.Nat}),NonExistingTokenId:e.Null,Unauthorized:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),InvalidRecipient:e.Null,GenericBatchError:e.Record({message:e.Text,error_code:e.Nat}),TooOld:e.Null}),re=e.Variant({Ok:e.Nat,Err:D}),oe=e.Record({from:e.Opt(e.Principal)}),pe=e.Record({end:e.Nat,canister_id:e.Principal,start:e.Nat}),Ne=e.Vec(pe),Te=e.Record({start:e.Nat,length:e.Nat});s.fill(e.Variant({Int:e.Int,Map:e.Vec(e.Tuple(e.Text,s)),Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text,Array:e.Vec(s)}));const ae=e.Record({start:e.Nat,length:e.Nat}),Ae=e.Record({log_length:e.Nat,blocks:e.Vec(e.Record({id:e.Nat,block:s})),archived_blocks:e.Vec(t)}),Re=e.Func([e.Vec(ae)],[Ae],["query"]);t.fill(e.Record({args:e.Vec(ae),callback:Re}));const de=e.Record({log_length:e.Nat,blocks:e.Vec(e.Record({id:e.Nat,block:s})),archived_blocks:e.Vec(t)}),G=e.Record({certificate:e.Vec(e.Nat8),hash_tree:e.Vec(e.Nat8)}),$=e.Record({url:e.Text,block_type:e.Text}),X=e.Record({owner:e.Principal,subaccount:e.Opt(e.Vec(e.Nat8))}),le=e.Vec(X),be=e.Vec(e.Nat);n.fill(e.Variant({Int:e.Int,Map:e.Vec(e.Tuple(e.Text,n)),Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text,Array:e.Vec(n)}));const he=e.Variant({Int:e.Int,Map:e.Vec(e.Tuple(e.Text,n)),Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text,Array:e.Vec(n)}),Ee=e.Vec(e.Nat),He=e.Vec(e.Opt(X)),ie=e.Record({to:X,token_id:e.Nat,memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(e.Nat64)}),we=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Duplicate:e.Record({duplicate_of:e.Nat}),NonExistingTokenId:e.Null,Unauthorized:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),InvalidRecipient:e.Null,GenericBatchError:e.Record({message:e.Text,error_code:e.Nat}),TooOld:e.Null}),Ce=e.Variant({Ok:e.Nat,Err:we}),ye=e.Variant({IC:e.Opt(e.Text),Ethereum:e.Opt(e.Nat),Solana:e.Opt(e.Nat),Bitcoin:e.Opt(e.Text),Other:p}),ke=e.Record({tokenId:e.Nat,gasPrice:e.Opt(e.Nat),memo:e.Opt(e.Vec(e.Nat8)),fromSubaccount:e.Opt(e.Vec(e.Nat8)),remoteContract:E,maxPriorityFeePerGas:e.Opt(e.Nat),created_at_time:e.Opt(e.Nat),gasLimit:e.Opt(e.Nat),targetOwner:e.Text}),ze=e.Variant({GenericError:e.Text,NoCkNFTCanister:e.Null,NetworkError:e.Text,ExistingCast:e.Nat,InsufficientAllowance:e.Tuple(e.Nat,e.Nat),InvalidTransaction:e.Text,InsufficientBalance:e.Tuple(e.Nat,e.Nat),NotFound:e.Null,InsufficientCycles:e.Tuple(e.Nat,e.Nat),TransferNotVerified:e.Variant({TooManyRetries:e.Nat,NoConsensus:e.Null}),MintNotVerified:e.Variant({TooManyRetries:e.Nat,NoConsensus:e.Null}),Unauthorized:e.Null,ContractNotVerified:e.Variant({TooManyRetries:e.Nat,NoConsensus:e.Null}),InvalidContract:e.Null}),Je=e.Variant({Ok:e.Nat,Err:ze}),Tn=e.Record({tokenId:e.Nat,contract:e.Text,network:b}),rt=e.Variant({Error:ze,WaitingOnContract:e.Record({transaction:e.Text}),RemoteFinalized:e.Text,SubmittedToOrchestrator:e.Record({localCastId:e.Nat,remoteCastId:e.Nat}),WaitingOnMint:e.Record({transaction:e.Text}),WaitingOnTransfer:e.Record({transaction:e.Text}),Created:e.Null,Completed:e.Nat,SubmittingToOrchestrator:e.Nat}),zt=e.Record({startTime:e.Nat,status:rt,history:e.Vec(e.Tuple(rt,e.Nat)),castId:e.Nat,originalRequest:ke}),De=e.Variant({remote:e.Record({contract:E,owner:e.Text,timestamp:e.Nat}),local:Y}),Bt=e.Record({tokenId:e.Nat,contract:e.Text,network:b}),Et=e.Record({memo:e.Opt(e.Vec(e.Nat8)),createdAtTime:e.Opt(e.Nat),remoteNFTPointer:Bt}),ws=e.Variant({GenericError:e.Text,InsufficientAllowance:e.Tuple(e.Nat,e.Nat),InsufficientBalance:e.Tuple(e.Nat,e.Nat),NotFound:e.Null,InsufficientCycles:e.Tuple(e.Nat,e.Nat),Unauthorized:e.Null,FoundLocally:Y,QueryError:e.Text}),Ki=e.Variant({Ok:De,Err:ws}),Nf=e.Record({memo:e.Opt(e.Vec(e.Nat8)),tokens:e.Vec(e.Nat),created_at_time:e.Opt(e.Nat64)}),Af=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),NonExistingTokenId:e.Null,InvalidBurn:e.Null}),vf=e.Variant({Ok:e.Nat,Err:Af}),Ef=e.Record({result:vf,token_id:e.Nat}),kf=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Unauthorized:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null}),Cf=e.Variant({Ok:e.Vec(Ef),Err:kf}),Tf=e.Vec(e.Tuple(e.Text,n)),jf=e.Record({token_id:e.Nat,owner:N,metadata:Tf,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(e.Nat64),spender:e.Opt(N)}),Sf=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TokenExists:e.Null,NonExistingTokenId:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null}),Ff=e.Variant({Ok:e.Opt(e.Nat),Err:Sf,GenericError:e.Record({message:e.Text,error_code:e.Nat})}),Rf=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),Duplicate:e.Record({duplicate_of:e.Nat}),InvalidSpender:e.Null,NonExistingTokenId:e.Null,Unauthorized:e.Null,CreatedInFuture:e.Record({ledger_time:e.Nat64}),GenericBatchError:e.Record({message:e.Text,error_code:e.Nat}),TooOld:e.Null}),Pf=e.Variant({Ok:e.Nat,Err:Rf}),Bf=e.Variant({Error:ze,WaitingOnContract:e.Record({transaction:e.Text}),RemoteFinalized:e.Text,SubmittedToOrchestrator:e.Record({localCastId:e.Nat,remoteCastId:e.Nat}),WaitingOnMint:e.Record({transaction:e.Text}),WaitingOnTransfer:e.Record({transaction:e.Text}),Created:e.Null,Completed:e.Nat,SubmittingToOrchestrator:e.Nat}),Of=e.Variant({ok:e.Null,err:e.Text});return e.Service({assign:e.Func([e.Nat,N],[e.Nat],[]),get_stats:e.Func([],[e.Record({icrc99:Z,icrc7:R})],["query"]),get_tip:e.Func([],[K],["query"]),icrc10_supported_standards:e.Func([],[ne],["query"]),icrc37_approve_collection:e.Func([e.Vec(ce)],[e.Vec(e.Opt(C))],[]),icrc37_approve_tokens:e.Func([e.Vec(j)],[e.Vec(e.Opt(H))],[]),icrc37_get_collection_approvals:e.Func([N,e.Opt(J),e.Opt(e.Nat)],[e.Vec(J)],["query"]),icrc37_get_token_approvals:e.Func([e.Vec(e.Nat),e.Opt(y),e.Opt(e.Nat)],[e.Vec(y)],["query"]),icrc37_is_approved:e.Func([e.Vec(M)],[e.Vec(e.Bool)],["query"]),icrc37_max_approvals_per_token_or_collection:e.Func([],[e.Opt(e.Nat)],["query"]),icrc37_max_revoke_approvals:e.Func([],[e.Opt(e.Nat)],["query"]),icrc37_revoke_collection_approvals:e.Func([e.Vec(P)],[e.Vec(e.Opt(L))],[]),icrc37_revoke_token_approvals:e.Func([e.Vec(se)],[e.Vec(e.Opt(I))],[]),icrc37_transfer_from:e.Func([e.Vec(ee)],[e.Vec(e.Opt(re))],[]),icrc3_get_archives:e.Func([oe],[Ne],["query"]),icrc3_get_blocks:e.Func([e.Vec(Te)],[de],["query"]),icrc3_get_tip_certificate:e.Func([],[e.Opt(G)],["query"]),icrc3_supported_block_types:e.Func([],[e.Vec($)],["query"]),icrc7_atomic_batch_transfers:e.Func([],[e.Opt(e.Bool)],["query"]),icrc7_balance_of:e.Func([le],[be],["query"]),icrc7_collection_metadata:e.Func([],[e.Vec(e.Tuple(e.Text,he))],["query"]),icrc7_default_take_value:e.Func([],[e.Opt(e.Nat)],["query"]),icrc7_description:e.Func([],[e.Opt(e.Text)],["query"]),icrc7_logo:e.Func([],[e.Opt(e.Text)],["query"]),icrc7_max_memo_size:e.Func([],[e.Opt(e.Nat)],["query"]),icrc7_max_query_batch_size:e.Func([],[e.Opt(e.Nat)],["query"]),icrc7_max_take_value:e.Func([],[e.Opt(e.Nat)],["query"]),icrc7_max_update_batch_size:e.Func([],[e.Opt(e.Nat)],["query"]),icrc7_name:e.Func([],[e.Text],["query"]),icrc7_owner_of:e.Func([Ee],[He],["query"]),icrc7_permitted_drift:e.Func([],[e.Opt(e.Nat)],["query"]),icrc7_supply_cap:e.Func([],[e.Opt(e.Nat)],["query"]),icrc7_symbol:e.Func([],[e.Text],["query"]),icrc7_token_metadata:e.Func([e.Vec(e.Nat)],[e.Vec(e.Opt(e.Vec(e.Tuple(e.Text,he))))],["query"]),icrc7_tokens:e.Func([e.Opt(e.Nat),e.Opt(e.Nat)],[e.Vec(e.Nat)],["query"]),icrc7_tokens_of:e.Func([N,e.Opt(e.Nat),e.Opt(e.Nat)],[e.Vec(e.Nat)],["query"]),icrc7_total_supply:e.Func([],[e.Nat],["query"]),icrc7_transfer:e.Func([e.Vec(ie)],[e.Vec(e.Opt(Ce))],[]),icrc7_tx_window:e.Func([],[e.Opt(e.Nat)],["query"]),icrc99_burn_fund_address:e.Func([e.Nat],[e.Opt(e.Tuple(e.Text,ye))],[]),icrc99_cast:e.Func([e.Vec(ke),e.Opt(N)],[e.Vec(e.Opt(Je))],[]),icrc99_cast_cost:e.Func([Tn],[e.Nat],[]),icrc99_cast_status:e.Func([e.Vec(e.Nat),e.Opt(N)],[e.Vec(e.Opt(zt))],[]),icrc99_native_chain:e.Func([],[E],["query"]),icrc99_remote_owner_of:e.Func([e.Vec(e.Nat)],[e.Vec(e.Opt(De))],["query"]),icrc99_request_remote_owner_status:e.Func([e.Vec(Et),e.Opt(N)],[e.Vec(e.Opt(Ki))],[]),icrcX_burn:e.Func([Nf],[Cf],[]),mint_ck_nft:e.Func([jf],[Ff,e.Opt(Pf)],[]),update_cast_status:e.Func([e.Nat,Bf],[Of],[])})};var hm={};const mc=hm.CYCLES_LEDGER_CANISTER_ID||"um5iw-rqaaa-aaaaq-qaaba-cai";function Hi(e){const t=Vf(),r=Qf(),{user:n}=Er(),s=Gf(),a=Xd(e,ji),o=Fa(e,ji),c=a,l=Vi(mc),{useApprove:d}=l,u=d(),h=gt({mutationFn:async k=>{if(!r||!c)throw new Error("User must be authenticated to mint NFTs");console.log("Minting NFT from EVM with params:",k);let S=k.requiredCycles;if(!S)try{console.log("Getting mint cost for NFT...");const w=(await o.get_mint_cost([k.request]))[0];Array.isArray(w)&&w.length>0?S=w[0]:S=void 0,console.log("Mint cost:",S==null?void 0:S.toString())}catch(j){console.warn("Failed to get mint cost, proceeding without cycles check:",j)}if(S&&!k.skipApproval)try{const j=it.fromText(e),w=n;if(w!=null&&w.principal){let H=!0;try{console.log("Making fresh allowance call to cycles ledger...");const J=it.fromText(e),y={account:{owner:w.principal,subaccount:[]},spender:{owner:J,subaccount:[]}};console.log("Allowance check params:",y),await t.invalidateQueries({queryKey:["icrc2-allowance"]}),await t.invalidateQueries({queryKey:["orchestrator-allowance"]}),await new Promise(P=>setTimeout(P,100));const M=["icrc2-allowance",y];console.log("Refetching with query key:",M);try{const P=await t.fetchQuery({queryKey:M,queryFn:async()=>{console.log("Fetching fresh allowance from blockchain...");const{Actor:Q,HttpAgent:L}=await jt(async()=>{const{Actor:D,HttpAgent:re}=await import("./index-CQEhYxiE.js").then(oe=>oe.a);return{Actor:D,HttpAgent:re}},__vite__mapDeps([0,1,2])),se=new L({host:"http://localhost:8080"});await se.fetchRootKey().catch(D=>console.warn("Failed to fetch root key:",D));const F=({IDL:D})=>{const re=D.Record({owner:D.Principal,subaccount:D.Opt(D.Vec(D.Nat8))}),oe=D.Record({allowance:D.Nat,expires_at:D.Opt(D.Nat64)});return D.Service({icrc2_allowance:D.Func([D.Record({account:re,spender:re})],[oe],["query"])})},ee=await Q.createActor(F,{agent:se,canisterId:mc}).icrc2_allowance(y);return console.log("Fresh allowance result from blockchain:",ee),{allowance:ee.allowance,expires_at:ee.expires_at.length>0?[ee.expires_at[0]]:[]}},staleTime:0});if(console.log("Fresh allowance data:",P),P!=null&&P.allowance)if(console.log("Found fresh allowance:",P.allowance.toString()),console.log("Required mint cost:",S.toString()),console.log("Is sufficient?",P.allowance>=S),P.allowance>=S){const Q=BigInt(Date.now()*1e6),L=P.expires_at.length>0&&P.expires_at[0]<Q;console.log("Allowance expiry check - now:",Q.toString()),console.log("Allowance expires_at:",P.expires_at),console.log("Is expired?",L),L?console.log("âŒ Fresh allowance is expired, will re-approve"):(H=!1,console.log("âœ… Sufficient fresh allowance exists for minting, skipping approval"))}else console.log("âŒ Fresh allowance insufficient, will approve more");else console.log("âŒ No fresh allowance found, will approve")}catch(P){console.warn("Failed to fetch fresh allowance:",P),console.log("âŒ Fresh allowance fetch failed, will approve to be safe")}}catch(J){console.warn("Could not check current allowance, will approve:",J)}if(H){console.log("Auto-approving cycles for NFT minting...");const J=S*BigInt(110)/BigInt(100);await u.mutateAsync({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:J,expected_allowance:[],expires_at:[BigInt(Date.now()*1e6)+BigInt(24*60*60*1e9)],spender:{owner:j,subaccount:[]}}),console.log("Cycles approved for minting")}}}catch(j){throw console.error("Failed to approve cycles for minting:",j),new Error(`Failed to approve cycles for minting: ${j instanceof Error?j.message:String(j)}`)}const ce=k.spender?[k.spender]:[],U=n!=null&&n.principal?{owner:typeof n.principal=="string"?it.fromText(n.principal):n.principal,subaccount:[]}:null,C=U?[U]:[];console.log("ðŸ” Mint function call parameters:",{request:{...k.request,nft:{...k.request.nft,tokenId:k.request.nft.tokenId.toString()},mintToAccount:{...k.request.mintToAccount,owner:k.request.mintToAccount.owner.toString()}},candidSpender:ce.map(j=>({...j,owner:j.owner.toString()})),candidAccount:C.map(j=>({...j,owner:j.owner.toString()})),userPrincipal:n==null?void 0:n.principal,userPrincipalType:typeof(n==null?void 0:n.principal),userAccount:U});try{return console.log("ðŸ” Attempting mint with 3 parameters..."),c.mint(k.request,C)}catch(j){return console.warn("ðŸ” 3-parameter mint failed, trying 2-parameter version:",j),c.mint(k.request,ce)}},onSuccess:()=>{t.invalidateQueries({queryKey:["nft"]}),t.invalidateQueries({queryKey:["mint-status"]}),t.invalidateQueries({queryKey:["orchestrator-allowance"]})}}),m=gt({mutationFn:async k=>{if(!o)throw new Error("Anonymous actor not available");return(await o.get_mint_cost(k)).map(ce=>Array.isArray(ce)&&ce.length?ce[0]:null)}}),p=gt({mutationFn:async k=>{if(!o)throw new Error("Anonymous actor not available to get mint status");return o.get_mint_status(k)}}),b=gt({mutationFn:async k=>{if(!c)throw new Error("User must be authenticated to verify remote ownership");const S=k.spender?[k.spender]:[],ce=k.pointers.map(C=>({tokenId:C.tokenId,contract:C.contractPointer.contract,network:C.contractPointer.network}));return(await c.get_remote_owner(ce,S)).map(C=>Array.isArray(C)&&C.length?C[0]:null)}}),g=gt({mutationFn:async k=>{if(!c)throw new Error("User must be authenticated to get remote metadata");const S=k.spender?[k.spender]:[],ce=k.pointers.map(C=>({tokenId:C.tokenId,contract:C.contractPointer.contract,network:C.contractPointer.network}));return(await c.get_remote_meta(ce,k.fields,S)).map(C=>Array.isArray(C)&&C.length?C[0]:null)}}),v=gt({mutationFn:async k=>{if(!c)throw new Error("User must be authenticated to get approval address");const S=k.spender?[k.spender]:[],ce=await c.get_remote_approval_address(k.request,S);return Array.isArray(ce)?ce.length===0?null:ce[0]:ce}}),N=gt({mutationFn:async k=>{if(!r||!s)throw new Error("User must be authenticated to cast NFTs");const{Actor:S}=await jt(async()=>{const{Actor:J}=await import("./index-CQEhYxiE.js").then(y=>y.a);return{Actor:J}},__vite__mapDeps([0,1,2])),ce=S.createActor(Ol,{agent:s,canisterId:k.ckNFTCanisterId});console.log("ðŸŽ¯ Casting NFTs via ckNFT canister:",{canisterId:k.ckNFTCanisterId.toString(),requestCount:k.castRequests.length,spender:k.spender});const U=n!=null&&n.principal?typeof n.principal=="string"?it.fromText(n.principal):n.principal:null;if(k.spender&&U&&k.spender.owner.toString()!==U.toString()){console.log("ðŸ” Checking and ensuring NFT approvals for third-party spender...");try{const J=k.castRequests.map(M=>({token_id:M.tokenId,approval_info:{spender:k.spender,memo:[],from_subaccount:M.fromSubaccount,created_at_time:[],expires_at:[BigInt(Date.now()*1e6)+BigInt(864e11)]}})),y=await ce.icrc37_approve_tokens(J);console.log("ðŸ” NFT approval results:",y);for(let M=0;M<y.length;M++){const P=y[M];Array.isArray(P)&&P.length>0&&P[0]&&"Err"in P[0]&&console.warn(`âš ï¸ Failed to approve NFT ${k.castRequests[M].tokenId}:`,P[0].Err)}}catch(J){console.warn("âš ï¸ Failed to pre-approve NFTs, continuing with cast attempt:",J)}}else k.spender&&U&&k.spender.owner.toString()===U.toString()&&console.log("ðŸ” User is casting their own NFT - no approval needed");const j=n!=null&&n.principal?{owner:typeof n.principal=="string"?it.fromText(n.principal):n.principal,subaccount:[]}:null,w=j?[j]:[],H=await ce.icrc99_cast(k.castRequests,w);return console.log("âœ… Cast results from ckNFT canister:",H),H.map(J=>Array.isArray(J)&&J.length>0&&J[0]!=null?J[0]:null)},onSuccess:()=>{t.invalidateQueries({queryKey:["nft"]}),t.invalidateQueries({queryKey:["cast-status"]})}}),V=gt({mutationFn:async k=>{if(!c)throw new Error("User must be authenticated to get cast status");return c.get_cast_status(k)}}),E=gt({mutationFn:async k=>{var j,w;if(!c)throw new Error("User must be authenticated to create remote contracts");let S,ce,U;if((j=k.remoteFeeData)!=null&&j.maxFeePerGas&&((w=k.ethFeeData)!=null&&w.gasPrice)&&k.estimatedRemoteGas&&k.estimatedRemoteSize&&k.remoteFundingBalance){const H=k.remoteFeeData.l1DataFee&&k.remoteFeeData.l1DataFee>0n?k.ethFeeData.gasPrice*16n*(k.estimatedRemoteSize+300n)/(k.estimatedRemoteGas*120n/100n):0n;S=k.remoteFeeData.maxFeePerGas+2000000n+H;const J=k.remoteFundingBalance*90n/100n/1800000n;ce=k.estimatedRemoteGas,U=2000000n,console.log("ðŸ“Š Enhanced gas calculation:",{maxFeePerGas:k.remoteFeeData.maxFeePerGas.toString(),l1DataComponent:H.toString(),finalGasPrice:S.toString(),estimatedGas:k.estimatedRemoteGas.toString(),gasAvailable:J.toString(),remoteFundingBalance:k.remoteFundingBalance.toString()})}else S=k.gasPrice||50000000000n,ce=k.gasLimit||2000000n,U=k.maxPriorityFeePerGas||2000000000n,console.log("âš ï¸ Using fallback gas parameters - enhanced calculation data not available");const C=k.spender?[k.spender]:[];return console.log("ðŸš€ Creating remote contract with final parameters:",{gasPrice:S.toString(),gasLimit:ce.toString(),maxPriorityFeePerGas:U.toString()}),c.create_remote(k.pointer,k.network,S,ce,U,C)},onSuccess:()=>{t.invalidateQueries({queryKey:["remote-contracts"]})}}),Y=gt({mutationFn:async k=>{if(!c)throw new Error("User must be authenticated to get remote cost");return c.get_remote_cost(k.pointer,k.network)}}),O=gt({mutationFn:async k=>{if(!r||!c)throw new Error("User must be authenticated to create canisters");console.log("Creating canister with params:",k);const S={contract:k.pointer.contract,network:JSON.stringify(k.pointer.network,(j,w)=>typeof w=="bigint"?w.toString():w)};if(console.log("Pointer for logging:",S),k.requiredCycles&&!k.skipApproval)try{console.log("Auto-approving cycles for canister creation...");const j=it.fromText(e),w=k.requiredCycles*BigInt(110)/BigInt(100);await u.mutateAsync({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:w,expected_allowance:[],expires_at:[BigInt(Date.now()*1e6)+BigInt(24*60*60*1e9)],spender:{owner:j,subaccount:[]}}),console.log("Cycles approved successfully")}catch(j){throw console.error("Failed to approve cycles:",j),new Error(`Failed to approve cycles: ${j instanceof Error?j.message:String(j)}`)}const ce={logo:k.defaults.logo?[k.defaults.logo]:[],name:k.defaults.name?[k.defaults.name]:[],description:k.defaults.description?[k.defaults.description]:[],symbol:k.defaults.symbol?[k.defaults.symbol]:[]},U=k.spender?[k.spender]:[],C=await c.create_canister(k.pointer,ce,U);if("Err"in C)if(console.error("Canister creation error:",C.Err),console.log("Full error object:",JSON.stringify(C.Err,(j,w)=>typeof w=="bigint"?`BigInt(${w.toString()})`:w,2)),"InsufficientCycles"in C.Err){const j=C.Err.InsufficientCycles;if(console.log("InsufficientCycles error data:",j,"Type:",typeof j,"IsArray:",Array.isArray(j)),Array.isArray(j)&&j.length>=2){const[w,H]=j;throw new Error(`Insufficient cycles for canister creation. The orchestrator needs ${H.toString()} cycles but only has ${w.toString()} available. You need to approve cycles from your cycles ledger to the orchestrator canister (uzt4z-lp777-77774-qaabq-cai).`)}else throw new Error(`Insufficient cycles for canister creation. Error data: ${JSON.stringify(j)}`)}else if("InsufficientBalance"in C.Err){const j=C.Err.InsufficientBalance;if(Array.isArray(j)&&j.length>=2){const[w,H]=j;throw new Error(`Insufficient balance or allowance. Available: ${w.toString()}, Required: ${H.toString()}. Please ensure you have sufficient cycles balance and have approved the orchestrator as a spender.`)}else throw new Error(`Insufficient balance. Error data: ${JSON.stringify(j)}`)}else if("InsufficientAllowance"in C.Err){const j=C.Err.InsufficientAllowance;if(Array.isArray(j)&&j.length>=2){const[w,H]=j;throw new Error(`Insufficient allowance. Required: ${w.toString()}, Available: ${H.toString()}`)}else throw new Error(`Insufficient allowance. Error data: ${JSON.stringify(j)}`)}else{const j=(()=>{try{return JSON.stringify(C.Err,(w,H)=>typeof H=="bigint"?H.toString():H)}catch{return String(C.Err)}})();throw new Error(`Canister creation failed: ${j}`)}return C},onSuccess:()=>{t.invalidateQueries({queryKey:["canisters"]}),t.invalidateQueries({queryKey:["existing-canister"]}),t.invalidateQueries({queryKey:["orchestrator-allowance"]})}}),Z=gt({mutationFn:async k=>{if(!c)throw new Error("User must be authenticated to get creation cost");return c.get_creation_cost(k)}}),q=gt({mutationFn:async k=>{if(!o)throw new Error("Anonymous actor not available");return(await o.get_ck_nft_canister(k)).map(ce=>Array.isArray(ce)&&ce.length?ce[0]:null)}}),R=gt({mutationFn:async k=>{if(!o)throw new Error("Anonymous actor not available");const S=await o.get_icrc99_address(k.canister,k.network);return Array.isArray(S)?S.length===0?null:S[0]:S}}),K=gt({mutationFn:async k=>{const{Actor:S}=await jt(async()=>{const{Actor:w}=await import("./index-CQEhYxiE.js").then(H=>H.a);return{Actor:w}},__vite__mapDeps([0,1,2]));let ce=o?o._agent||o.__agent:null;if(!ce){const{HttpAgent:w}=await jt(async()=>{const{HttpAgent:H}=await import("./index-CQEhYxiE.js").then(J=>J.a);return{HttpAgent:H}},__vite__mapDeps([0,1,2]));ce=new w({host:"https://ic0.app"})}const U=S.createActor(Ol,{agent:ce,canisterId:k.ckNFTCanisterId}),C={contract:k.contract,network:k.network,tokenId:k.tokenId};return await U.icrc99_cast_cost(C)}}),ne=h.isPending||N.isPending||O.isPending||E.isPending||m.isPending||Y.isPending||Z.isPending||p.isPending||V.isPending||b.isPending||g.isPending||v.isPending||q.isPending||R.isPending||K.isPending,z=h.error||N.error||O.error||E.error||m.error||Y.error||Z.error||p.error||V.error||b.error||g.error||v.error||q.error||R.error||K.error;return{mintFromEVM:h,getMintCost:m,getMintStatus:p,getRemoteOwner:b,getRemoteMetadata:g,getApprovalAddress:v,castToEVM:N,getCastStatus:V,getCastCost:K,createRemoteContract:E,getRemoteCost:Y,createCanister:O,getCreationCost:Z,getCkNFTCanister:q,getICRC99Address:R,cyclesApprove:u,isLoading:ne,error:z,isLoadingMint:h.isPending,isLoadingCast:N.isPending,isLoadingCanisterCreation:O.isPending,isLoadingRemoteCreation:E.isPending,mintError:h.error,castError:N.error,canisterError:O.error,remoteError:E.error}}function fm(e,t=!0){const n=Fa("uzt4z-lp777-77774-qaabq-cai",ji);return Lc({queryKey:["canister-creation-cost",e==null?void 0:e.contract,e!=null&&e.network?JSON.stringify(e.network,(s,a)=>typeof a=="bigint"?a.toString():a):null],queryFn:async()=>{if(!e)throw new Error("Contract pointer is required");if(!n)throw new Error("Actor not available");return n.get_creation_cost(e)},enabled:t&&!!e&&!!n&&!!e.contract,staleTime:5*60*1e3,refetchOnWindowFocus:!1})}function mm(e,t=!0){const n=Fa("uzt4z-lp777-77774-qaabq-cai",ji);return Lc({queryKey:["existing-canister",e==null?void 0:e.contract,e!=null&&e.network?JSON.stringify(e.network,(s,a)=>typeof a=="bigint"?a.toString():a):null],queryFn:async()=>{if(!e)throw new Error("Contract pointer is required");if(!n)throw new Error("Actor not available");const a=(await n.get_ck_nft_canister([e]))[0];return Array.isArray(a)?a.length===0?null:a[0]:a||null},enabled:t&&!!e&&!!n&&!!e.contract,staleTime:5*60*1e3,refetchOnWindowFocus:!1})}function el(e){const t="uzt4z-lp777-77774-qaabq-cai",{user:r}=Er(),n=Vi(mc),{useAllowance:s}=n,a=_.useMemo(()=>{if(r!=null&&r.principal)return{account:{owner:r.principal,subaccount:[]},spender:{owner:it.fromText(t),subaccount:[]}}},[r==null?void 0:r.principal,t]),o=s(a),c=_.useMemo(()=>{if(!o.data)return null;const l=BigInt(Date.now()*1e6),d=o.data.expires_at.length>0&&o.data.expires_at[0]?o.data.expires_at[0]<l:!1;return{allowance:o.data.allowance,expires_at:o.data.expires_at,isExpired:d,isSufficient:e?o.data.allowance>=e:!1}},[o.data,e]);return _.useMemo(()=>({data:c,isLoading:o.isLoading,error:o.error,refetch:o.refetch}),[c,o.isLoading,o.error,o.refetch])}function pm(e,t=!0){const r=_.useMemo(()=>{if(!e)return null;let s;return typeof e=="string"?s=e:e&&typeof e=="object"&&"toString"in e?s=e.toString():s=String(e),!s||s==="N/A"||s==="No canister found"||s==="Error displaying ID"||s.startsWith("Error ")||s.length<5?null:s},[e]),n=Fa(r||"aaaaa-aa",({IDL:s})=>s.Service({icrc7_collection_metadata:s.Func([],[s.Vec(s.Tuple(s.Text,s.Reserved))],["query"])}));return Lc({queryKey:["collection-metadata",r],queryFn:async()=>{if(!r)throw new Error("Canister ID is required");if(!n)throw new Error("Actor not available");const s=await n.icrc7_collection_metadata();console.log("ðŸ” Raw collection metadata from canister:",s),console.log("ðŸ” Raw metadata structure:",JSON.stringify(s,(c,l)=>typeof l=="bigint"?`BigInt(${l.toString()})`:l,2));const a=c=>{if(console.log("ðŸ” Processing value:",c,"Type:",typeof c),!!c){if(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||typeof c=="boolean")return c;if(typeof c=="object"&&c!==null){if("Text"in c)return console.log("ðŸ” Found Text variant:",c.Text),c.Text;if("Nat"in c)return console.log("ðŸ” Found Nat variant:",c.Nat),BigInt(c.Nat);if("Int"in c)return console.log("ðŸ” Found Int variant:",c.Int),BigInt(c.Int);if("Bool"in c)return console.log("ðŸ” Found Bool variant:",c.Bool),c.Bool;if("Blob"in c)return console.log("ðŸ” Found Blob variant:",c.Blob),c.Blob;if("Array"in c)return console.log("ðŸ” Found Array variant:",c.Array),c.Array;if("Map"in c)return console.log("ðŸ” Found Map variant:",c.Map),c.Map;const l=Object.keys(c);if(l.length===1){const d=l[0];return console.log(`ðŸ” Found single-key variant: ${d} =>`,c[d]),a(c[d])}return console.log("ðŸ” Complex object, returning as-is:",c),c}return console.log("ðŸ” Returning value as-is:",c),c}},o={};for(const[c,l]of s)console.log(`ðŸ” Processing metadata pair: "${c}" =>`,l),o[c]=a(l),console.log(`ðŸ” Parsed result for "${c}":`,o[c]);return console.log("ðŸŽ¯ Final parsed collection metadata:",o),{name:o["icrc7:name"]||o.name||null,symbol:o["icrc7:symbol"]||o.symbol||null,description:o["icrc7:description"]||o.description||null,logo:o["icrc7:logo"]||o.logo||null,totalSupply:o["icrc7:total_supply"]||o.total_supply||null,supplyCap:o["icrc7:supply_cap"]||o.supply_cap||null,maxQueryBatchSize:o["icrc7:max_query_batch_size"]||null,maxUpdateBatchSize:o["icrc7:max_update_batch_size"]||null,maxTakeValue:o["icrc7:max_take_value"]||null,maxMemoSize:o["icrc7:max_memo_size"]||null,defaultTakeValue:o["icrc7:default_take_value"]||null,royalties:o["icrc7:royalties"]||o.royalties||null,royaltyRecipient:o["icrc7:royalty_recipient"]||o.royalty_recipient||null,raw:s}},enabled:t&&!!r&&!!n&&r!=="aaaaa-aa",staleTime:10*60*1e3,refetchOnWindowFocus:!1})}const gm="6.15.0";function xm(e,t,r){const n=t.split("|").map(a=>a.trim());for(let a=0;a<n.length;a++)switch(t){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof e===t)return}const s=new Error(`invalid value for type ${t}`);throw s.code="INVALID_ARGUMENT",s.argument=`value.${r}`,s.value=e,s}async function yt(e){const t=Object.keys(e);return(await Promise.all(t.map(n=>Promise.resolve(e[n])))).reduce((n,s,a)=>(n[t[a]]=s,n),{})}function ve(e,t,r){for(let n in t){let s=t[n];const a=r?r[n]:null;a&&xm(s,a,n),Object.defineProperty(e,n,{enumerable:!0,value:s,writable:!1})}}function Ss(e,t){if(e==null)return"null";if(t==null&&(t=new Set),typeof e=="object"){if(t.has(e))return"[Circular]";t.add(e)}if(Array.isArray(e))return"[ "+e.map(r=>Ss(r,t)).join(", ")+" ]";if(e instanceof Uint8Array){const r="0123456789abcdef";let n="0x";for(let s=0;s<e.length;s++)n+=r[e[s]>>4],n+=r[e[s]&15];return n}if(typeof e=="object"&&typeof e.toJSON=="function")return Ss(e.toJSON(),t);switch(typeof e){case"boolean":case"number":case"symbol":return e.toString();case"bigint":return BigInt(e).toString();case"string":return JSON.stringify(e);case"object":{const r=Object.keys(e);return r.sort(),"{ "+r.map(n=>`${Ss(n,t)}: ${Ss(e[n],t)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function dt(e,t){return e&&e.code===t}function tl(e){return dt(e,"CALL_EXCEPTION")}function Ke(e,t,r){let n=e;{const a=[];if(r){if("message"in r||"code"in r||"name"in r)throw new Error(`value will overwrite populated values: ${Ss(r)}`);for(const o in r){if(o==="shortMessage")continue;const c=r[o];a.push(o+"="+Ss(c))}}a.push(`code=${t}`),a.push(`version=${gm}`),a.length&&(e+=" ("+a.join(", ")+")")}let s;switch(t){case"INVALID_ARGUMENT":s=new TypeError(e);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":s=new RangeError(e);break;default:s=new Error(e)}return ve(s,{code:t}),r&&Object.assign(s,r),s.shortMessage==null&&ve(s,{shortMessage:n}),s}function W(e,t,r,n){if(!e)throw Ke(t,r,n)}function A(e,t,r,n){W(e,t,"INVALID_ARGUMENT",{argument:r,value:n})}function yu(e,t,r){r==null&&(r=""),r&&(r=": "+r),W(e>=t,"missing argument"+r,"MISSING_ARGUMENT",{count:e,expectedCount:t}),W(e<=t,"too many arguments"+r,"UNEXPECTED_ARGUMENT",{count:e,expectedCount:t})}const bm=["NFD","NFC","NFKD","NFKC"].reduce((e,t)=>{try{if("test".normalize(t)!=="test")throw new Error("bad");if(t==="NFD"&&"Ã©".normalize("NFD")!=="eÌ")throw new Error("broken");e.push(t)}catch{}return e},[]);function ym(e){W(bm.indexOf(e)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:e}})}function Ra(e,t,r){if(r==null&&(r=""),e!==t){let n=r,s="new";r&&(n+=".",s+=" "+r),W(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:s})}}function wu(e,t,r){if(e instanceof Uint8Array)return r?new Uint8Array(e):e;if(typeof e=="string"&&e.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((e.length-2)/2);let s=2;for(let a=0;a<n.length;a++)n[a]=parseInt(e.substring(s,s+2),16),s+=2;return n}A(!1,"invalid BytesLike value",t||"value",e)}function je(e,t){return wu(e,t,!1)}function wt(e,t){return wu(e,t,!0)}function qe(e,t){return!(typeof e!="string"||!e.match(/^0x[0-9A-Fa-f]*$/)||typeof t=="number"&&e.length!==2+2*t||t===!0&&e.length%2!==0)}function rl(e){return qe(e,!0)||e instanceof Uint8Array}const Ml="0123456789abcdef";function ue(e){const t=je(e);let r="0x";for(let n=0;n<t.length;n++){const s=t[n];r+=Ml[(s&240)>>4]+Ml[s&15]}return r}function Ye(e){return"0x"+e.map(t=>ue(t).substring(2)).join("")}function Ms(e){return qe(e,!0)?(e.length-2)/2:je(e).length}function Ie(e,t,r){const n=je(e);return r!=null&&r>n.length&&W(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r}),ue(n.slice(t??0,r??n.length))}function Ty(e){let t=ue(e).substring(2);for(;t.startsWith("00");)t=t.substring(2);return"0x"+t}function Nu(e,t,r){const n=je(e);W(t>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:t,offset:t+1});const s=new Uint8Array(t);return s.fill(0),r?s.set(n,t-n.length):s.set(n,0),ue(s)}function Kr(e,t){return Nu(e,t,!0)}function wm(e,t){return Nu(e,t,!1)}const To=BigInt(0),ir=BigInt(1),Fs=9007199254740991;function ao(e,t){const r=jo(e,"value"),n=BigInt(Se(t,"width"));if(W(r>>n===To,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:e}),r>>n-ir){const s=(ir<<n)-ir;return-((~r&s)+ir)}return r}function Au(e,t){let r=me(e,"value");const n=BigInt(Se(t,"width")),s=ir<<n-ir;if(r<To){r=-r,W(r<=s,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:e});const a=(ir<<n)-ir;return(~r&a)+ir}else W(r<s,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:e});return r}function Vn(e,t){const r=jo(e,"value"),n=BigInt(Se(t,"bits"));return r&(ir<<n)-ir}function me(e,t){switch(typeof e){case"bigint":return e;case"number":return A(Number.isInteger(e),"underflow",t||"value",e),A(e>=-Fs&&e<=Fs,"overflow",t||"value",e),BigInt(e);case"string":try{if(e==="")throw new Error("empty string");return e[0]==="-"&&e[1]!=="-"?-BigInt(e.substring(1)):BigInt(e)}catch(r){A(!1,`invalid BigNumberish string: ${r.message}`,t||"value",e)}}A(!1,"invalid BigNumberish value",t||"value",e)}function jo(e,t){const r=me(e,t);return W(r>=To,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:e}),r}const _l="0123456789abcdef";function So(e){if(e instanceof Uint8Array){let t="0x0";for(const r of e)t+=_l[r>>4],t+=_l[r&15];return BigInt(t)}return me(e)}function Se(e,t){switch(typeof e){case"bigint":return A(e>=-Fs&&e<=Fs,"overflow",t||"value",e),Number(e);case"number":return A(Number.isInteger(e),"underflow",t||"value",e),A(e>=-Fs&&e<=Fs,"overflow",t||"value",e),e;case"string":try{if(e==="")throw new Error("empty string");return Se(BigInt(e),t)}catch(r){A(!1,`invalid numeric string: ${r.message}`,t||"value",e)}}A(!1,"invalid numeric value",t||"value",e)}function Nm(e){return Se(So(e))}function vn(e,t){let n=jo(e,"value").toString(16);if(t==null)n.length%2&&(n="0"+n);else{const s=Se(t,"width");for(W(s*2>=n.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:e});n.length<s*2;)n="0"+n}return"0x"+n}function tt(e){const t=jo(e,"value");if(t===To)return new Uint8Array([]);let r=t.toString(16);r.length%2&&(r="0"+r);const n=new Uint8Array(r.length/2);for(let s=0;s<n.length;s++){const a=s*2;n[s]=parseInt(r.substring(a,a+2),16)}return n}function sr(e){let t=ue(rl(e)?e:tt(e)).substring(2);for(;t.startsWith("0");)t=t.substring(1);return t===""&&(t="0"),"0x"+t}const oo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";let Va=null;function Am(e){if(Va==null){Va={};for(let r=0;r<oo.length;r++)Va[oo[r]]=BigInt(r)}const t=Va[e];return A(t!=null,"invalid base58 value","letter",e),t}const vm=BigInt(0),pc=BigInt(58);function Em(e){const t=je(e);let r=So(t),n="";for(;r;)n=oo[Number(r%pc)]+n,r/=pc;for(let s=0;s<t.length&&!t[s];s++)n=oo[0]+n;return n}function jy(e){let t=vm;for(let r=0;r<e.length;r++)t*=pc,t+=Am(e[r]);return t}function km(e){e=atob(e);const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return je(t)}function Cm(e){const t=je(e);let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return btoa(r)}var Gs;class vu{constructor(t,r,n){T(this,"filter");T(this,"emitter");B(this,Gs);x(this,Gs,r),ve(this,{emitter:t,filter:n})}async removeListener(){f(this,Gs)!=null&&await this.emitter.off(this.filter,f(this,Gs))}}Gs=new WeakMap;function Tm(e,t,r,n,s){A(!1,`invalid codepoint at offset ${t}; ${e}`,"bytes",r)}function Eu(e,t,r,n,s){if(e==="BAD_PREFIX"||e==="UNEXPECTED_CONTINUE"){let a=0;for(let o=t+1;o<r.length&&r[o]>>6===2;o++)a++;return a}return e==="OVERRUN"?r.length-t-1:0}function jm(e,t,r,n,s){return e==="OVERLONG"?(A(typeof s=="number","invalid bad code point for replacement","badCodepoint",s),n.push(s),0):(n.push(65533),Eu(e,t,r))}const Sm=Object.freeze({error:Tm,ignore:Eu,replace:jm});function ku(e,t){t==null&&(t=Sm.error);const r=je(e,"bytes"),n=[];let s=0;for(;s<r.length;){const a=r[s++];if(a>>7===0){n.push(a);continue}let o=null,c=null;if((a&224)===192)o=1,c=127;else if((a&240)===224)o=2,c=2047;else if((a&248)===240)o=3,c=65535;else{(a&192)===128?s+=t("UNEXPECTED_CONTINUE",s-1,r,n):s+=t("BAD_PREFIX",s-1,r,n);continue}if(s-1+o>=r.length){s+=t("OVERRUN",s-1,r,n);continue}let l=a&(1<<8-o-1)-1;for(let d=0;d<o;d++){let u=r[s];if((u&192)!=128){s+=t("MISSING_CONTINUE",s,r,n),l=null;break}l=l<<6|u&63,s++}if(l!==null){if(l>1114111){s+=t("OUT_OF_RANGE",s-1-o,r,n,l);continue}if(l>=55296&&l<=57343){s+=t("UTF16_SURROGATE",s-1-o,r,n,l);continue}if(l<=c){s+=t("OVERLONG",s-1-o,r,n,l);continue}n.push(l)}}return n}function Ar(e,t){A(typeof e=="string","invalid string value","str",e),t!=null&&(ym(t),e=e.normalize(t));let r=[];for(let n=0;n<e.length;n++){const s=e.charCodeAt(n);if(s<128)r.push(s);else if(s<2048)r.push(s>>6|192),r.push(s&63|128);else if((s&64512)==55296){n++;const a=e.charCodeAt(n);A(n<e.length&&(a&64512)===56320,"invalid surrogate pair","str",e);const o=65536+((s&1023)<<10)+(a&1023);r.push(o>>18|240),r.push(o>>12&63|128),r.push(o>>6&63|128),r.push(o&63|128)}else r.push(s>>12|224),r.push(s>>6&63|128),r.push(s&63|128)}return new Uint8Array(r)}function Fm(e){return e.map(t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10&1023)+55296,(t&1023)+56320))).join("")}function co(e,t){return Fm(ku(e,t))}function Sy(e,t){return ku(Ar(e,t))}function Cu(e){async function t(r,n){W(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const s=r.url.split(":")[0].toLowerCase();W(s==="http"||s==="https",`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),W(s==="https"||!r.credentials||r.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let a=null;const o=new AbortController,c=setTimeout(()=>{a=Ke("request timeout","TIMEOUT"),o.abort()},r.timeout);n&&n.addListener(()=>{a=Ke("request cancelled","CANCELLED"),o.abort()});const l=Object.assign({},e,{method:r.method,headers:new Headers(Array.from(r)),body:r.body||void 0,signal:o.signal});let d;try{d=await fetch(r.url,l)}catch(p){throw clearTimeout(c),a||p}clearTimeout(c);const u={};d.headers.forEach((p,b)=>{u[b.toLowerCase()]=p});const h=await d.arrayBuffer(),m=h==null?null:new Uint8Array(h);return{statusCode:d.status,statusMessage:d.statusText,headers:u,body:m}}return t}const Rm=12,Pm=250;let Ul=Cu();const Bm=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Om=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let Ko=!1;async function Tu(e,t){try{const r=e.match(Bm);if(!r)throw new Error("invalid data");return new An(200,"OK",{"content-type":r[1]||"text/plain"},r[2]?km(r[3]):_m(r[3]))}catch{return new An(599,"BAD REQUEST (invalid data: URI)",{},null,new Ir(e))}}function ju(e){async function t(r,n){try{const s=r.match(Om);if(!s)throw new Error("invalid link");return new Ir(`${e}${s[2]}`)}catch{return new An(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Ir(r))}}return t}const Ga={data:Tu,ipfs:ju("https://gateway.ipfs.io/ipfs/")},Su=new WeakMap;var $n,nn;class Mm{constructor(t){B(this,$n);B(this,nn);x(this,$n,[]),x(this,nn,!1),Su.set(t,()=>{if(!f(this,nn)){x(this,nn,!0);for(const r of f(this,$n))setTimeout(()=>{r()},0);x(this,$n,[])}})}addListener(t){W(!f(this,nn),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),f(this,$n).push(t)}get cancelled(){return f(this,nn)}checkSignal(){W(!this.cancelled,"cancelled","CANCELLED",{})}}$n=new WeakMap,nn=new WeakMap;function za(e){if(e==null)throw new Error("missing signal; should not happen");return e.checkSignal(),e}var zs,Hs,Lt,Rr,$s,Qs,nt,_t,Pr,Qn,qn,Jn,dr,Dt,sn,Kn,Li;const wo=class wo{constructor(t){B(this,Kn);B(this,zs);B(this,Hs);B(this,Lt);B(this,Rr);B(this,$s);B(this,Qs);B(this,nt);B(this,_t);B(this,Pr);B(this,Qn);B(this,qn);B(this,Jn);B(this,dr);B(this,Dt);B(this,sn);x(this,Qs,String(t)),x(this,zs,!1),x(this,Hs,!0),x(this,Lt,{}),x(this,Rr,""),x(this,$s,3e5),x(this,Dt,{slotInterval:Pm,maxAttempts:Rm}),x(this,sn,null)}get url(){return f(this,Qs)}set url(t){x(this,Qs,String(t))}get body(){return f(this,nt)==null?null:new Uint8Array(f(this,nt))}set body(t){if(t==null)x(this,nt,void 0),x(this,_t,void 0);else if(typeof t=="string")x(this,nt,Ar(t)),x(this,_t,"text/plain");else if(t instanceof Uint8Array)x(this,nt,t),x(this,_t,"application/octet-stream");else if(typeof t=="object")x(this,nt,Ar(JSON.stringify(t))),x(this,_t,"application/json");else throw new Error("invalid body")}hasBody(){return f(this,nt)!=null}get method(){return f(this,Rr)?f(this,Rr):this.hasBody()?"POST":"GET"}set method(t){t==null&&(t=""),x(this,Rr,String(t).toUpperCase())}get headers(){const t=Object.assign({},f(this,Lt));return f(this,Pr)&&(t.authorization=`Basic ${Cm(Ar(f(this,Pr)))}`),this.allowGzip&&(t["accept-encoding"]="gzip"),t["content-type"]==null&&f(this,_t)&&(t["content-type"]=f(this,_t)),this.body&&(t["content-length"]=String(this.body.length)),t}getHeader(t){return this.headers[t.toLowerCase()]}setHeader(t,r){f(this,Lt)[String(t).toLowerCase()]=String(r)}clearHeaders(){x(this,Lt,{})}[Symbol.iterator](){const t=this.headers,r=Object.keys(t);let n=0;return{next:()=>{if(n<r.length){const s=r[n++];return{value:[s,t[s]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return f(this,Pr)||null}setCredentials(t,r){A(!t.match(/:/),"invalid basic authentication username","username","[REDACTED]"),x(this,Pr,`${t}:${r}`)}get allowGzip(){return f(this,Hs)}set allowGzip(t){x(this,Hs,!!t)}get allowInsecureAuthentication(){return!!f(this,zs)}set allowInsecureAuthentication(t){x(this,zs,!!t)}get timeout(){return f(this,$s)}set timeout(t){A(t>=0,"timeout must be non-zero","timeout",t),x(this,$s,t)}get preflightFunc(){return f(this,Qn)||null}set preflightFunc(t){x(this,Qn,t)}get processFunc(){return f(this,qn)||null}set processFunc(t){x(this,qn,t)}get retryFunc(){return f(this,Jn)||null}set retryFunc(t){x(this,Jn,t)}get getUrlFunc(){return f(this,sn)||Ul}set getUrlFunc(t){x(this,sn,t)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${f(this,nt)?ue(f(this,nt)):"null"}>`}setThrottleParams(t){t.slotInterval!=null&&(f(this,Dt).slotInterval=t.slotInterval),t.maxAttempts!=null&&(f(this,Dt).maxAttempts=t.maxAttempts)}send(){return W(f(this,dr)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),x(this,dr,new Mm(this)),te(this,Kn,Li).call(this,0,Vl()+this.timeout,0,this,new An(0,"",{},null,this))}cancel(){W(f(this,dr)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const t=Su.get(this);if(!t)throw new Error("missing signal; should not happen");t()}redirect(t){const r=this.url.split(":")[0].toLowerCase(),n=t.split(":")[0].toLowerCase();W(this.method==="GET"&&(r!=="https"||n!=="http")&&t.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(t)})`});const s=new wo(t);return s.method="GET",s.allowGzip=this.allowGzip,s.timeout=this.timeout,x(s,Lt,Object.assign({},f(this,Lt))),f(this,nt)&&x(s,nt,new Uint8Array(f(this,nt))),x(s,_t,f(this,_t)),s}clone(){const t=new wo(this.url);return x(t,Rr,f(this,Rr)),f(this,nt)&&x(t,nt,f(this,nt)),x(t,_t,f(this,_t)),x(t,Lt,Object.assign({},f(this,Lt))),x(t,Pr,f(this,Pr)),this.allowGzip&&(t.allowGzip=!0),t.timeout=this.timeout,this.allowInsecureAuthentication&&(t.allowInsecureAuthentication=!0),x(t,Qn,f(this,Qn)),x(t,qn,f(this,qn)),x(t,Jn,f(this,Jn)),x(t,Dt,Object.assign({},f(this,Dt))),x(t,sn,f(this,sn)),t}static lockConfig(){Ko=!0}static getGateway(t){return Ga[t.toLowerCase()]||null}static registerGateway(t,r){if(t=t.toLowerCase(),t==="http"||t==="https")throw new Error(`cannot intercept ${t}; use registerGetUrl`);if(Ko)throw new Error("gateways locked");Ga[t]=r}static registerGetUrl(t){if(Ko)throw new Error("gateways locked");Ul=t}static createGetUrlFunc(t){return Cu(t)}static createDataGateway(){return Tu}static createIpfsGatewayFunc(t){return ju(t)}};zs=new WeakMap,Hs=new WeakMap,Lt=new WeakMap,Rr=new WeakMap,$s=new WeakMap,Qs=new WeakMap,nt=new WeakMap,_t=new WeakMap,Pr=new WeakMap,Qn=new WeakMap,qn=new WeakMap,Jn=new WeakMap,dr=new WeakMap,Dt=new WeakMap,sn=new WeakMap,Kn=new WeakSet,Li=async function(t,r,n,s,a){var u,h,m;if(t>=f(this,Dt).maxAttempts)return a.makeServerError("exceeded maximum retry limit");W(Vl()<=r,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:s}),n>0&&await Um(n);let o=this.clone();const c=(o.url.split(":")[0]||"").toLowerCase();if(c in Ga){const p=await Ga[c](o.url,za(f(s,dr)));if(p instanceof An){let b=p;if(this.processFunc){za(f(s,dr));try{b=await this.processFunc(o,b)}catch(g){(g.throttle==null||typeof g.stall!="number")&&b.makeServerError("error in post-processing function",g).assertOk()}}return b}o=p}this.preflightFunc&&(o=await this.preflightFunc(o));const l=await this.getUrlFunc(o,za(f(s,dr)));let d=new An(l.statusCode,l.statusMessage,l.headers,l.body,s);if(d.statusCode===301||d.statusCode===302){try{const p=d.headers.location||"";return te(u=o.redirect(p),Kn,Li).call(u,t+1,r,0,s,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,d,t))){const p=d.headers["retry-after"];let b=f(this,Dt).slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return typeof p=="string"&&p.match(/^[1-9][0-9]*$/)&&(b=parseInt(p)),te(h=o.clone(),Kn,Li).call(h,t+1,r,b,s,d)}if(this.processFunc){za(f(s,dr));try{d=await this.processFunc(o,d)}catch(p){(p.throttle==null||typeof p.stall!="number")&&d.makeServerError("error in post-processing function",p).assertOk();let b=f(this,Dt).slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return p.stall>=0&&(b=p.stall),te(m=o.clone(),Kn,Li).call(m,t+1,r,b,s,d)}}return d};let Ir=wo;var ba,ya,wa,Ut,qs,In;const vl=class vl{constructor(t,r,n,s,a){B(this,ba);B(this,ya);B(this,wa);B(this,Ut);B(this,qs);B(this,In);x(this,ba,t),x(this,ya,r),x(this,wa,Object.keys(n).reduce((o,c)=>(o[c.toLowerCase()]=String(n[c]),o),{})),x(this,Ut,s==null?null:new Uint8Array(s)),x(this,qs,a||null),x(this,In,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${f(this,Ut)?ue(f(this,Ut)):"null"}>`}get statusCode(){return f(this,ba)}get statusMessage(){return f(this,ya)}get headers(){return Object.assign({},f(this,wa))}get body(){return f(this,Ut)==null?null:new Uint8Array(f(this,Ut))}get bodyText(){try{return f(this,Ut)==null?"":co(f(this,Ut))}catch{W(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{W(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const t=this.headers,r=Object.keys(t);let n=0;return{next:()=>{if(n<r.length){const s=r[n++];return{value:[s,t[s]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(t,r){let n;t?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${t})`:(t=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${t})`);const s=new vl(599,n,this.headers,this.body,f(this,qs)||void 0);return x(s,In,{message:t,error:r}),s}throwThrottleError(t,r){r==null?r=-1:A(Number.isInteger(r)&&r>=0,"invalid stall timeout","stall",r);const n=new Error(t||"throttling requests");throw ve(n,{stall:r,throttle:!0}),n}getHeader(t){return this.headers[t.toLowerCase()]}hasBody(){return f(this,Ut)!=null}get request(){return f(this,qs)}ok(){return f(this,In).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:t,error:r}=f(this,In);t===""&&(t=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let s=null;try{f(this,Ut)&&(s=co(f(this,Ut)))}catch{}W(!1,t,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:r,info:{requestUrl:n,responseBody:s,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};ba=new WeakMap,ya=new WeakMap,wa=new WeakMap,Ut=new WeakMap,qs=new WeakMap,In=new WeakMap;let An=vl;function Vl(){return new Date().getTime()}function _m(e){return Ar(e.replace(/%([0-9a-f][0-9a-f])/gi,(t,r)=>String.fromCharCode(parseInt(r,16))))}function Um(e){return new Promise(t=>setTimeout(t,e))}const Vm=BigInt(-1),Yt=BigInt(0),Rs=BigInt(1),Gm=BigInt(5),As={};let _s="0000";for(;_s.length<80;)_s+=_s;function Sn(e){let t=_s;for(;t.length<e;)t+=t;return BigInt("1"+t.substring(0,e))}function Yi(e,t,r){const n=BigInt(t.width);if(t.signed){const s=Rs<<n-Rs;W(r==null||e>=-s&&e<s,"overflow","NUMERIC_FAULT",{operation:r,fault:"overflow",value:e}),e>Yt?e=ao(Vn(e,n),n):e=-ao(Vn(-e,n),n)}else{const s=Rs<<n;W(r==null||e>=0&&e<s,"overflow","NUMERIC_FAULT",{operation:r,fault:"overflow",value:e}),e=(e%s+s)%s&s-Rs}return e}function Io(e){typeof e=="number"&&(e=`fixed128x${e}`);let t=!0,r=128,n=18;if(typeof e=="string"){if(e!=="fixed")if(e==="ufixed")t=!1;else{const a=e.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);A(a,"invalid fixed format","format",e),t=a[1]!=="u",r=parseInt(a[2]),n=parseInt(a[3])}}else if(e){const a=e,o=(c,l,d)=>a[c]==null?d:(A(typeof a[c]===l,"invalid fixed format ("+c+" not "+l+")","format."+c,a[c]),a[c]);t=o("signed","boolean",t),r=o("width","number",r),n=o("decimals","number",n)}A(r%8===0,"invalid FixedNumber width (not byte aligned)","format.width",r),A(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const s=(t?"":"u")+"fixed"+String(r)+"x"+String(n);return{signed:t,width:r,decimals:n,name:s}}function zm(e,t){let r="";e<Yt&&(r="-",e*=Vm);let n=e.toString();if(t===0)return r+n;for(;n.length<=t;)n=_s+n;const s=n.length-t;for(n=n.substring(0,s)+"."+n.substring(s);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return r+n}var er,$e,xt,Ge,Rn,Cr,gc,xc,bc,yc;const rn=class rn{constructor(t,r,n){B(this,Ge);T(this,"format");B(this,er);B(this,$e);B(this,xt);T(this,"_value");Ra(t,As,"FixedNumber"),x(this,$e,r),x(this,er,n);const s=zm(r,n.decimals);ve(this,{format:n.name,_value:s}),x(this,xt,Sn(n.decimals))}get signed(){return f(this,er).signed}get width(){return f(this,er).width}get decimals(){return f(this,er).decimals}get value(){return f(this,$e)}addUnsafe(t){return te(this,Ge,gc).call(this,t)}add(t){return te(this,Ge,gc).call(this,t,"add")}subUnsafe(t){return te(this,Ge,xc).call(this,t)}sub(t){return te(this,Ge,xc).call(this,t,"sub")}mulUnsafe(t){return te(this,Ge,bc).call(this,t)}mul(t){return te(this,Ge,bc).call(this,t,"mul")}mulSignal(t){te(this,Ge,Rn).call(this,t);const r=f(this,$e)*f(t,$e);return W(r%f(this,xt)===Yt,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),te(this,Ge,Cr).call(this,r/f(this,xt),"mulSignal")}divUnsafe(t){return te(this,Ge,yc).call(this,t)}div(t){return te(this,Ge,yc).call(this,t,"div")}divSignal(t){W(f(t,$e)!==Yt,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),te(this,Ge,Rn).call(this,t);const r=f(this,$e)*f(this,xt);return W(r%f(t,$e)===Yt,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),te(this,Ge,Cr).call(this,r/f(t,$e),"divSignal")}cmp(t){let r=this.value,n=t.value;const s=this.decimals-t.decimals;return s>0?n*=Sn(s):s<0&&(r*=Sn(-s)),r<n?-1:r>n?1:0}eq(t){return this.cmp(t)===0}lt(t){return this.cmp(t)<0}lte(t){return this.cmp(t)<=0}gt(t){return this.cmp(t)>0}gte(t){return this.cmp(t)>=0}floor(){let t=f(this,$e);return f(this,$e)<Yt&&(t-=f(this,xt)-Rs),t=f(this,$e)/f(this,xt)*f(this,xt),te(this,Ge,Cr).call(this,t,"floor")}ceiling(){let t=f(this,$e);return f(this,$e)>Yt&&(t+=f(this,xt)-Rs),t=f(this,$e)/f(this,xt)*f(this,xt),te(this,Ge,Cr).call(this,t,"ceiling")}round(t){if(t==null&&(t=0),t>=this.decimals)return this;const r=this.decimals-t,n=Gm*Sn(r-1);let s=this.value+n;const a=Sn(r);return s=s/a*a,Yi(s,f(this,er),"round"),new rn(As,s,f(this,er))}isZero(){return f(this,$e)===Yt}isNegative(){return f(this,$e)<Yt}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return rn.fromString(this.toString(),t)}static fromValue(t,r,n){const s=r==null?0:Se(r),a=Io(n);let o=me(t,"value");const c=s-a.decimals;if(c>0){const l=Sn(c);W(o%l===Yt,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:t}),o/=l}else c<0&&(o*=Sn(-c));return Yi(o,a,"fromValue"),new rn(As,o,a)}static fromString(t,r){const n=t.match(/^(-?)([0-9]*)\.?([0-9]*)$/);A(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",t);const s=Io(r);let a=n[2]||"0",o=n[3]||"";for(;o.length<s.decimals;)o+=_s;W(o.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:t}),o=o.substring(0,s.decimals);const c=BigInt(n[1]+a+o);return Yi(c,s,"fromString"),new rn(As,c,s)}static fromBytes(t,r){let n=So(je(t,"value"));const s=Io(r);return s.signed&&(n=ao(n,s.width)),Yi(n,s,"fromBytes"),new rn(As,n,s)}};er=new WeakMap,$e=new WeakMap,xt=new WeakMap,Ge=new WeakSet,Rn=function(t){A(this.format===t.format,"incompatible format; use fixedNumber.toFormat","other",t)},Cr=function(t,r){return t=Yi(t,f(this,er),r),new rn(As,t,f(this,er))},gc=function(t,r){return te(this,Ge,Rn).call(this,t),te(this,Ge,Cr).call(this,f(this,$e)+f(t,$e),r)},xc=function(t,r){return te(this,Ge,Rn).call(this,t),te(this,Ge,Cr).call(this,f(this,$e)-f(t,$e),r)},bc=function(t,r){return te(this,Ge,Rn).call(this,t),te(this,Ge,Cr).call(this,f(this,$e)*f(t,$e)/f(this,xt),r)},yc=function(t,r){return W(f(t,$e)!==Yt,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),te(this,Ge,Rn).call(this,t),te(this,Ge,Cr).call(this,f(this,$e)*f(this,xt)/f(t,$e),r)};let lo=rn;function Hm(e){let t=e.toString(16);for(;t.length<2;)t="0"+t;return"0x"+t}function Gl(e,t,r){let n=0;for(let s=0;s<r;s++)n=n*256+e[t+s];return n}function zl(e,t,r,n){const s=[];for(;r<t+1+n;){const a=Fu(e,r);s.push(a.result),r+=a.consumed,W(r<=t+1+n,"child data too short","BUFFER_OVERRUN",{buffer:e,length:n,offset:t})}return{consumed:1+n,result:s}}function Fu(e,t){W(e.length!==0,"data too short","BUFFER_OVERRUN",{buffer:e,length:0,offset:1});const r=n=>{W(n<=e.length,"data short segment too short","BUFFER_OVERRUN",{buffer:e,length:e.length,offset:n})};if(e[t]>=248){const n=e[t]-247;r(t+1+n);const s=Gl(e,t+1,n);return r(t+1+n+s),zl(e,t,t+1+n,n+s)}else if(e[t]>=192){const n=e[t]-192;return r(t+1+n),zl(e,t,t+1,n)}else if(e[t]>=184){const n=e[t]-183;r(t+1+n);const s=Gl(e,t+1,n);r(t+1+n+s);const a=ue(e.slice(t+1+n,t+1+n+s));return{consumed:1+n+s,result:a}}else if(e[t]>=128){const n=e[t]-128;r(t+1+n);const s=ue(e.slice(t+1,t+1+n));return{consumed:1+n,result:s}}return{consumed:1,result:Hm(e[t])}}function Pa(e){const t=je(e,"data"),r=Fu(t,0);return A(r.consumed===t.length,"unexpected junk after rlp payload","data",e),r.result}function Hl(e){const t=[];for(;e;)t.unshift(e&255),e>>=8;return t}function Ru(e){if(Array.isArray(e)){let n=[];if(e.forEach(function(a){n=n.concat(Ru(a))}),n.length<=55)return n.unshift(192+n.length),n;const s=Hl(n.length);return s.unshift(247+s.length),s.concat(n)}const t=Array.prototype.slice.call(je(e,"object"));if(t.length===1&&t[0]<=127)return t;if(t.length<=55)return t.unshift(128+t.length),t;const r=Hl(t.length);return r.unshift(183+r.length),r.concat(t)}const $l="0123456789abcdef";function En(e){let t="0x";for(const r of Ru(e))t+=$l[r>>4],t+=$l[r&15];return t}const Pu=["wei","kwei","mwei","gwei","szabo","finney","ether"];function $m(e,t){let r=18;if(typeof t=="string"){const n=Pu.indexOf(t);A(n>=0,"invalid unit","unit",t),r=3*n}else t!=null&&(r=Se(t,"unit"));return lo.fromValue(e,r,{decimals:r,width:512}).toString()}function Qm(e,t){A(typeof e=="string","value must be a string","value",e);let r=18;if(typeof t=="string"){const n=Pu.indexOf(t);A(n>=0,"invalid unit","unit",t),r=3*n}else t!=null&&(r=Se(t,"unit"));return lo.fromString(e,{decimals:r,width:512}).value}function vs(e){return $m(e,18)}function Fy(e){return Qm(e,18)}const Nt=32,wc=new Uint8Array(Nt),qm=["then"],Ha={},Bu=new WeakMap;function Bn(e){return Bu.get(e)}function Ql(e,t){Bu.set(e,t)}function Zi(e,t){const r=new Error(`deferred error during ABI decoding triggered accessing ${e}`);throw r.error=t,r}function Nc(e,t,r){return e.indexOf(null)>=0?t.map((n,s)=>n instanceof Si?Nc(Bn(n),n,r):n):e.reduce((n,s,a)=>{let o=t.getValue(s);return s in n||(r&&o instanceof Si&&(o=Nc(Bn(o),o,r)),n[s]=o),n},{})}var Js;const Ps=class Ps extends Array{constructor(...r){const n=r[0];let s=r[1],a=(r[2]||[]).slice(),o=!0;n!==Ha&&(s=r,a=[],o=!1);super(s.length);B(this,Js);s.forEach((d,u)=>{this[u]=d});const c=a.reduce((d,u)=>(typeof u=="string"&&d.set(u,(d.get(u)||0)+1),d),new Map);if(Ql(this,Object.freeze(s.map((d,u)=>{const h=a[u];return h!=null&&c.get(h)===1?h:null}))),x(this,Js,[]),f(this,Js)==null&&f(this,Js),!o)return;Object.freeze(this);const l=new Proxy(this,{get:(d,u,h)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const p=Se(u,"%index");if(p<0||p>=this.length)throw new RangeError("out of result range");const b=d[p];return b instanceof Error&&Zi(`index ${p}`,b),b}if(qm.indexOf(u)>=0)return Reflect.get(d,u,h);const m=d[u];if(m instanceof Function)return function(...p){return m.apply(this===h?d:this,p)};if(!(u in d))return d.getValue.apply(this===h?d:this,[u])}return Reflect.get(d,u,h)}});return Ql(l,Bn(this)),l}toArray(r){const n=[];return this.forEach((s,a)=>{s instanceof Error&&Zi(`index ${a}`,s),r&&s instanceof Ps&&(s=s.toArray(r)),n.push(s)}),n}toObject(r){const n=Bn(this);return n.reduce((s,a,o)=>(W(a!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Nc(n,this,r)),{})}slice(r,n){r==null&&(r=0),r<0&&(r+=this.length,r<0&&(r=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const s=Bn(this),a=[],o=[];for(let c=r;c<n;c++)a.push(this[c]),o.push(s[c]);return new Ps(Ha,a,o)}filter(r,n){const s=Bn(this),a=[],o=[];for(let c=0;c<this.length;c++){const l=this[c];l instanceof Error&&Zi(`index ${c}`,l),r.call(n,l,c,this)&&(a.push(l),o.push(s[c]))}return new Ps(Ha,a,o)}map(r,n){const s=[];for(let a=0;a<this.length;a++){const o=this[a];o instanceof Error&&Zi(`index ${a}`,o),s.push(r.call(n,o,a,this))}return s}getValue(r){const n=Bn(this).indexOf(r);if(n===-1)return;const s=this[n];return s instanceof Error&&Zi(`property ${JSON.stringify(r)}`,s.error),s}static fromItems(r,n){return new Ps(Ha,r,n)}};Js=new WeakMap;let Si=Ps;function Ry(e){const t=[],r=function(n,s){if(Array.isArray(s))for(let a in s){const o=n.slice();o.push(a);try{r(o,s[a])}catch(c){t.push({path:o,error:c})}}};return r([],e),t}function ql(e){let t=tt(e);return W(t.length<=Nt,"value out-of-bounds","BUFFER_OVERRUN",{buffer:t,length:Nt,offset:t.length}),t.length!==Nt&&(t=wt(Ye([wc.slice(t.length%Nt),t]))),t}class Yr{constructor(t,r,n,s){T(this,"name");T(this,"type");T(this,"localName");T(this,"dynamic");ve(this,{name:t,type:r,localName:n,dynamic:s},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(t,r){A(!1,t,this.localName,r)}}var Br,Wn,Ks,Wa;class Ac{constructor(){B(this,Ks);B(this,Br);B(this,Wn);x(this,Br,[]),x(this,Wn,0)}get data(){return Ye(f(this,Br))}get length(){return f(this,Wn)}appendWriter(t){return te(this,Ks,Wa).call(this,wt(t.data))}writeBytes(t){let r=wt(t);const n=r.length%Nt;return n&&(r=wt(Ye([r,wc.slice(n)]))),te(this,Ks,Wa).call(this,r)}writeValue(t){return te(this,Ks,Wa).call(this,ql(t))}writeUpdatableValue(){const t=f(this,Br).length;return f(this,Br).push(wc),x(this,Wn,f(this,Wn)+Nt),r=>{f(this,Br)[t]=ql(r)}}}Br=new WeakMap,Wn=new WeakMap,Ks=new WeakSet,Wa=function(t){return f(this,Br).push(t),x(this,Wn,f(this,Wn)+t.length),t.length};var kt,Vt,Yn,Zn,an,xs,Ec,Ou;const El=class El{constructor(t,r,n){B(this,xs);T(this,"allowLoose");B(this,kt);B(this,Vt);B(this,Yn);B(this,Zn);B(this,an);ve(this,{allowLoose:!!r}),x(this,kt,wt(t)),x(this,Yn,0),x(this,Zn,null),x(this,an,n??1024),x(this,Vt,0)}get data(){return ue(f(this,kt))}get dataLength(){return f(this,kt).length}get consumed(){return f(this,Vt)}get bytes(){return new Uint8Array(f(this,kt))}subReader(t){const r=new El(f(this,kt).slice(f(this,Vt)+t),this.allowLoose,f(this,an));return x(r,Zn,this),r}readBytes(t,r){let n=te(this,xs,Ou).call(this,0,t,!!r);return te(this,xs,Ec).call(this,t),x(this,Vt,f(this,Vt)+n.length),n.slice(0,t)}readValue(){return So(this.readBytes(Nt))}readIndex(){return Nm(this.readBytes(Nt))}};kt=new WeakMap,Vt=new WeakMap,Yn=new WeakMap,Zn=new WeakMap,an=new WeakMap,xs=new WeakSet,Ec=function(t){var r;if(f(this,Zn))return te(r=f(this,Zn),xs,Ec).call(r,t);x(this,Yn,f(this,Yn)+t),W(f(this,an)<1||f(this,Yn)<=f(this,an)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${f(this,an)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:wt(f(this,kt)),offset:f(this,Vt),length:t,info:{bytesRead:f(this,Yn),dataLength:this.dataLength}})},Ou=function(t,r,n){let s=Math.ceil(r/Nt)*Nt;return f(this,Vt)+s>f(this,kt).length&&(this.allowLoose&&n&&f(this,Vt)+r<=f(this,kt).length?s=r:W(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:wt(f(this,kt)),length:f(this,kt).length,offset:f(this,Vt)+s})),f(this,kt).slice(f(this,Vt),f(this,Vt)+s)};let vc=El;function ls(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function nl(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Mu(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ls(e.outputLen),ls(e.blockLen)}function Fi(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function _u(e,t){nl(e);const r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const Wo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Uu=e=>e instanceof Uint8Array,Jm=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),Ya=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),cr=(e,t)=>e<<32-t|e>>>t,Km=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Km)throw new Error("Non little-endian hardware is not supported");const Im=async()=>{};async function Py(e,t,r){let n=Date.now();for(let s=0;s<e;s++){r(s);const a=Date.now()-n;a>=0&&a<t||(await Im(),n+=a)}}function Wm(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Ri(e){if(typeof e=="string"&&(e=Wm(e)),!Uu(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}function Ym(...e){const t=new Uint8Array(e.reduce((n,s)=>n+s.length,0));let r=0;return e.forEach(n=>{if(!Uu(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}class sl{clone(){return this._cloneInto()}}const Zm={}.toString;function Xm(e,t){if(t!==void 0&&Zm.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function il(e){const t=n=>e().update(Ri(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Lm(e=32){if(Wo&&typeof Wo.getRandomValues=="function")return Wo.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}class Vu extends sl{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,Mu(t);const n=Ri(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,a=new Uint8Array(s);a.set(n.length>s?t.create().update(n).digest():n);for(let o=0;o<a.length;o++)a[o]^=54;this.iHash.update(a),this.oHash=t.create();for(let o=0;o<a.length;o++)a[o]^=106;this.oHash.update(a),a.fill(0)}update(t){return Fi(this),this.iHash.update(t),this}digestInto(t){Fi(this),nl(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:a,blockLen:o,outputLen:c}=this;return t=t,t.finished=s,t.destroyed=a,t.blockLen=o,t.outputLen=c,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Fo=(e,t,r)=>new Vu(e,t).update(r).digest();Fo.create=(e,t)=>new Vu(e,t);function Dm(e,t,r,n){Mu(e);const s=Xm({dkLen:32,asyncTick:10},n),{c:a,dkLen:o,asyncTick:c}=s;if(ls(a),ls(o),ls(c),a<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const l=Ri(t),d=Ri(r),u=new Uint8Array(o),h=Fo.create(e,l),m=h._cloneInto().update(d);return{c:a,dkLen:o,asyncTick:c,DK:u,PRF:h,PRFSalt:m}}function ep(e,t,r,n,s){return e.destroy(),t.destroy(),n&&n.destroy(),s.fill(0),r}function tp(e,t,r,n){const{c:s,dkLen:a,DK:o,PRF:c,PRFSalt:l}=Dm(e,t,r,n);let d;const u=new Uint8Array(4),h=Ya(u),m=new Uint8Array(c.outputLen);for(let p=1,b=0;b<a;p++,b+=c.outputLen){const g=o.subarray(b,b+c.outputLen);h.setInt32(0,p,!1),(d=l._cloneInto(d)).update(u).digestInto(m),g.set(m.subarray(0,g.length));for(let v=1;v<s;v++){c._cloneInto(d).update(m).digestInto(m);for(let N=0;N<g.length;N++)g[N]^=m[N]}}return ep(c,l,o,d,m)}function rp(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);const s=BigInt(32),a=BigInt(4294967295),o=Number(r>>s&a),c=Number(r&a),l=n?4:0,d=n?0:4;e.setUint32(t+l,o,n),e.setUint32(t+d,c,n)}class Gu extends sl{constructor(t,r,n,s){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ya(this.buffer)}update(t){Fi(this);const{view:r,buffer:n,blockLen:s}=this;t=Ri(t);const a=t.length;for(let o=0;o<a;){const c=Math.min(s-this.pos,a-o);if(c===s){const l=Ya(t);for(;s<=a-o;o+=s)this.process(l,o);continue}n.set(t.subarray(o,o+c),this.pos),this.pos+=c,o+=c,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Fi(this),_u(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:a}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let h=o;h<s;h++)r[h]=0;rp(n,s-8,BigInt(this.length*8),a),this.process(n,0);const c=Ya(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=l/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)c.setUint32(4*h,u[h],a)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:a,destroyed:o,pos:c}=this;return t.length=s,t.pos=c,t.finished=a,t.destroyed=o,s%r&&t.buffer.set(n),t}}const np=(e,t,r)=>e&t^~e&r,sp=(e,t,r)=>e&t^e&r^t&r,ip=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xr=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Lr=new Uint32Array(64);class ap extends Gu{constructor(){super(64,32,8,!1),this.A=Xr[0]|0,this.B=Xr[1]|0,this.C=Xr[2]|0,this.D=Xr[3]|0,this.E=Xr[4]|0,this.F=Xr[5]|0,this.G=Xr[6]|0,this.H=Xr[7]|0}get(){const{A:t,B:r,C:n,D:s,E:a,F:o,G:c,H:l}=this;return[t,r,n,s,a,o,c,l]}set(t,r,n,s,a,o,c,l){this.A=t|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=a|0,this.F=o|0,this.G=c|0,this.H=l|0}process(t,r){for(let h=0;h<16;h++,r+=4)Lr[h]=t.getUint32(r,!1);for(let h=16;h<64;h++){const m=Lr[h-15],p=Lr[h-2],b=cr(m,7)^cr(m,18)^m>>>3,g=cr(p,17)^cr(p,19)^p>>>10;Lr[h]=g+Lr[h-7]+b+Lr[h-16]|0}let{A:n,B:s,C:a,D:o,E:c,F:l,G:d,H:u}=this;for(let h=0;h<64;h++){const m=cr(c,6)^cr(c,11)^cr(c,25),p=u+m+np(c,l,d)+ip[h]+Lr[h]|0,g=(cr(n,2)^cr(n,13)^cr(n,22))+sp(n,s,a)|0;u=d,d=l,l=c,c=o+p|0,o=a,a=s,s=n,n=p+g|0}n=n+this.A|0,s=s+this.B|0,a=a+this.C|0,o=o+this.D|0,c=c+this.E|0,l=l+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(n,s,a,o,c,l,d,u)}roundClean(){Lr.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ro=il(()=>new ap),$a=BigInt(2**32-1),kc=BigInt(32);function zu(e,t=!1){return t?{h:Number(e&$a),l:Number(e>>kc&$a)}:{h:Number(e>>kc&$a)|0,l:Number(e&$a)|0}}function Hu(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:a,l:o}=zu(e[s],t);[r[s],n[s]]=[a,o]}return[r,n]}const op=(e,t)=>BigInt(e>>>0)<<kc|BigInt(t>>>0),cp=(e,t,r)=>e>>>r,lp=(e,t,r)=>e<<32-r|t>>>r,dp=(e,t,r)=>e>>>r|t<<32-r,up=(e,t,r)=>e<<32-r|t>>>r,hp=(e,t,r)=>e<<64-r|t>>>r-32,fp=(e,t,r)=>e>>>r-32|t<<64-r,mp=(e,t)=>t,pp=(e,t)=>e,$u=(e,t,r)=>e<<r|t>>>32-r,Qu=(e,t,r)=>t<<r|e>>>32-r,qu=(e,t,r)=>t<<r-32|e>>>64-r,Ju=(e,t,r)=>e<<r-32|t>>>64-r;function gp(e,t,r,n){const s=(t>>>0)+(n>>>0);return{h:e+r+(s/2**32|0)|0,l:s|0}}const xp=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),bp=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,yp=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),wp=(e,t,r,n,s)=>t+r+n+s+(e/2**32|0)|0,Np=(e,t,r,n,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(s>>>0),Ap=(e,t,r,n,s,a)=>t+r+n+s+a+(e/2**32|0)|0,Fe={fromBig:zu,split:Hu,toBig:op,shrSH:cp,shrSL:lp,rotrSH:dp,rotrSL:up,rotrBH:hp,rotrBL:fp,rotr32H:mp,rotr32L:pp,rotlSH:$u,rotlSL:Qu,rotlBH:qu,rotlBL:Ju,add:gp,add3L:xp,add3H:bp,add4L:yp,add4H:wp,add5H:Ap,add5L:Np},[vp,Ep]=Fe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Dr=new Uint32Array(80),en=new Uint32Array(80);class kp extends Gu{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:r,Bh:n,Bl:s,Ch:a,Cl:o,Dh:c,Dl:l,Eh:d,El:u,Fh:h,Fl:m,Gh:p,Gl:b,Hh:g,Hl:v}=this;return[t,r,n,s,a,o,c,l,d,u,h,m,p,b,g,v]}set(t,r,n,s,a,o,c,l,d,u,h,m,p,b,g,v){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=a|0,this.Cl=o|0,this.Dh=c|0,this.Dl=l|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=m|0,this.Gh=p|0,this.Gl=b|0,this.Hh=g|0,this.Hl=v|0}process(t,r){for(let E=0;E<16;E++,r+=4)Dr[E]=t.getUint32(r),en[E]=t.getUint32(r+=4);for(let E=16;E<80;E++){const Y=Dr[E-15]|0,O=en[E-15]|0,Z=Fe.rotrSH(Y,O,1)^Fe.rotrSH(Y,O,8)^Fe.shrSH(Y,O,7),q=Fe.rotrSL(Y,O,1)^Fe.rotrSL(Y,O,8)^Fe.shrSL(Y,O,7),R=Dr[E-2]|0,K=en[E-2]|0,ne=Fe.rotrSH(R,K,19)^Fe.rotrBH(R,K,61)^Fe.shrSH(R,K,6),z=Fe.rotrSL(R,K,19)^Fe.rotrBL(R,K,61)^Fe.shrSL(R,K,6),k=Fe.add4L(q,z,en[E-7],en[E-16]),S=Fe.add4H(k,Z,ne,Dr[E-7],Dr[E-16]);Dr[E]=S|0,en[E]=k|0}let{Ah:n,Al:s,Bh:a,Bl:o,Ch:c,Cl:l,Dh:d,Dl:u,Eh:h,El:m,Fh:p,Fl:b,Gh:g,Gl:v,Hh:N,Hl:V}=this;for(let E=0;E<80;E++){const Y=Fe.rotrSH(h,m,14)^Fe.rotrSH(h,m,18)^Fe.rotrBH(h,m,41),O=Fe.rotrSL(h,m,14)^Fe.rotrSL(h,m,18)^Fe.rotrBL(h,m,41),Z=h&p^~h&g,q=m&b^~m&v,R=Fe.add5L(V,O,q,Ep[E],en[E]),K=Fe.add5H(R,N,Y,Z,vp[E],Dr[E]),ne=R|0,z=Fe.rotrSH(n,s,28)^Fe.rotrBH(n,s,34)^Fe.rotrBH(n,s,39),k=Fe.rotrSL(n,s,28)^Fe.rotrBL(n,s,34)^Fe.rotrBL(n,s,39),S=n&a^n&c^a&c,ce=s&o^s&l^o&l;N=g|0,V=v|0,g=p|0,v=b|0,p=h|0,b=m|0,{h,l:m}=Fe.add(d|0,u|0,K|0,ne|0),d=c|0,u=l|0,c=a|0,l=o|0,a=n|0,o=s|0;const U=Fe.add3L(ne,k,ce);n=Fe.add3H(U,K,z,S),s=U|0}({h:n,l:s}=Fe.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:a,l:o}=Fe.add(this.Bh|0,this.Bl|0,a|0,o|0),{h:c,l}=Fe.add(this.Ch|0,this.Cl|0,c|0,l|0),{h:d,l:u}=Fe.add(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:m}=Fe.add(this.Eh|0,this.El|0,h|0,m|0),{h:p,l:b}=Fe.add(this.Fh|0,this.Fl|0,p|0,b|0),{h:g,l:v}=Fe.add(this.Gh|0,this.Gl|0,g|0,v|0),{h:N,l:V}=Fe.add(this.Hh|0,this.Hl|0,N|0,V|0),this.set(n,s,a,o,c,l,d,u,h,m,p,b,g,v,N,V)}roundClean(){Dr.fill(0),en.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const al=il(()=>new kp);function Cp(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const Jl=Cp(),Kl=Jl.crypto||Jl.msCrypto;function Ku(e){switch(e){case"sha256":return Ro.create();case"sha512":return al.create()}A(!1,"invalid hashing algorithm name","algorithm",e)}function By(e,t){const r={sha256:Ro,sha512:al}[e];return A(r!=null,"invalid hmac algorithm","algorithm",e),Fo.create(r,t)}function Oy(e,t,r,n,s){const a={sha256:Ro,sha512:al}[s];return A(a!=null,"invalid pbkdf2 algorithm","algorithm",s),tp(a,e,t,{c:r,dkLen:n})}function My(e){W(Kl!=null,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),A(Number.isInteger(e)&&e>0&&e<=1024,"invalid length","length",e);const t=new Uint8Array(e);return Kl.getRandomValues(t),t}const[Iu,Wu,Yu]=[[],[],[]],Tp=BigInt(0),Xi=BigInt(1),jp=BigInt(2),Sp=BigInt(7),Fp=BigInt(256),Rp=BigInt(113);for(let e=0,t=Xi,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],Iu.push(2*(5*n+r)),Wu.push((e+1)*(e+2)/2%64);let s=Tp;for(let a=0;a<7;a++)t=(t<<Xi^(t>>Sp)*Rp)%Fp,t&jp&&(s^=Xi<<(Xi<<BigInt(a))-Xi);Yu.push(s)}const[Pp,Bp]=Hu(Yu,!0),Il=(e,t,r)=>r>32?qu(e,t,r):$u(e,t,r),Wl=(e,t,r)=>r>32?Ju(e,t,r):Qu(e,t,r);function Op(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let o=0;o<10;o++)r[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const c=(o+8)%10,l=(o+2)%10,d=r[l],u=r[l+1],h=Il(d,u,1)^r[c],m=Wl(d,u,1)^r[c+1];for(let p=0;p<50;p+=10)e[o+p]^=h,e[o+p+1]^=m}let s=e[2],a=e[3];for(let o=0;o<24;o++){const c=Wu[o],l=Il(s,a,c),d=Wl(s,a,c),u=Iu[o];s=e[u],a=e[u+1],e[u]=l,e[u+1]=d}for(let o=0;o<50;o+=10){for(let c=0;c<10;c++)r[c]=e[o+c];for(let c=0;c<10;c++)e[o+c]^=~r[(c+2)%10]&r[(c+4)%10]}e[0]^=Pp[n],e[1]^=Bp[n]}r.fill(0)}class ol extends sl{constructor(t,r,n,s=!1,a=24){if(super(),this.blockLen=t,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=a,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ls(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Jm(this.state)}keccak(){Op(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){Fi(this);const{blockLen:r,state:n}=this;t=Ri(t);const s=t.length;for(let a=0;a<s;){const o=Math.min(r-this.pos,s-a);for(let c=0;c<o;c++)n[this.pos++]^=t[a++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:r,pos:n,blockLen:s}=this;t[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){Fi(this,!1),nl(t),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,a=t.length;s<a;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,a-s);t.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return ls(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(_u(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:r,suffix:n,outputLen:s,rounds:a,enableXOF:o}=this;return t||(t=new ol(r,n,s,o,a)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=a,t.suffix=n,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}}const Mp=(e,t,r)=>il(()=>new ol(t,e,r)),_p=Mp(1,136,256/8);let Zu=!1;const Xu=function(e){return _p(e)};let Lu=Xu;function Le(e){const t=je(e,"data");return ue(Lu(t))}Le._=Xu;Le.lock=function(){Zu=!0};Le.register=function(e){if(Zu)throw new TypeError("keccak256 is locked");Lu=e};Object.freeze(Le);const Du=function(e){return Ku("sha256").update(e).digest()},eh=function(e){return Ku("sha512").update(e).digest()};let th=Du,rh=eh,nh=!1,sh=!1;function $i(e){const t=je(e,"data");return ue(th(t))}$i._=Du;$i.lock=function(){nh=!0};$i.register=function(e){if(nh)throw new Error("sha256 is locked");th=e};Object.freeze($i);function cl(e){const t=je(e,"data");return ue(rh(t))}cl._=eh;cl.lock=function(){sh=!0};cl.register=function(e){if(sh)throw new Error("sha512 is locked");rh=e};Object.freeze($i);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ih=BigInt(0),Po=BigInt(1),Up=BigInt(2),Bo=e=>e instanceof Uint8Array,Vp=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Pi(e){if(!Bo(e))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=Vp[e[r]];return t}function ah(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function ll(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return BigInt(e===""?"0":`0x${e}`)}function Bi(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(t/2);for(let n=0;n<r.length;n++){const s=n*2,a=e.slice(s,s+2),o=Number.parseInt(a,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function ds(e){return ll(Pi(e))}function dl(e){if(!Bo(e))throw new Error("Uint8Array expected");return ll(Pi(Uint8Array.from(e).reverse()))}function Oi(e,t){return Bi(e.toString(16).padStart(t*2,"0"))}function ul(e,t){return Oi(e,t).reverse()}function Gp(e){return Bi(ah(e))}function Xt(e,t,r){let n;if(typeof t=="string")try{n=Bi(t)}catch(a){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${a}`)}else if(Bo(t))n=Uint8Array.from(t);else throw new Error(`${e} must be hex string or Uint8Array`);const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(`${e} expected ${r} bytes, got ${s}`);return n}function aa(...e){const t=new Uint8Array(e.reduce((n,s)=>n+s.length,0));let r=0;return e.forEach(n=>{if(!Bo(n))throw new Error("Uint8Array expected");t.set(n,r),r+=n.length}),t}function zp(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Hp(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function $p(e){let t;for(t=0;e>ih;e>>=Po,t+=1);return t}function Qp(e,t){return e>>BigInt(t)&Po}const qp=(e,t,r)=>e|(r?Po:ih)<<BigInt(t),hl=e=>(Up<<BigInt(e-1))-Po,Yo=e=>new Uint8Array(e),Yl=e=>Uint8Array.from(e);function oh(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Yo(e),s=Yo(e),a=0;const o=()=>{n.fill(1),s.fill(0),a=0},c=(...h)=>r(s,n,...h),l=(h=Yo())=>{s=c(Yl([0]),h),n=c(),h.length!==0&&(s=c(Yl([1]),h),n=c())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const m=[];for(;h<t;){n=c();const p=n.slice();m.push(p),h+=n.length}return aa(...m)};return(h,m)=>{o(),l(h);let p;for(;!(p=m(d()));)l();return o(),p}}const Jp={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||e instanceof Uint8Array,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Ba(e,t,r={}){const n=(s,a,o)=>{const c=Jp[a];if(typeof c!="function")throw new Error(`Invalid validator "${a}", expected function`);const l=e[s];if(!(o&&l===void 0)&&!c(l,e))throw new Error(`Invalid param ${String(s)}=${l} (${typeof l}), expected ${a}`)};for(const[s,a]of Object.entries(t))n(s,a,!1);for(const[s,a]of Object.entries(r))n(s,a,!0);return e}const Kp=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Qp,bitLen:$p,bitMask:hl,bitSet:qp,bytesToHex:Pi,bytesToNumberBE:ds,bytesToNumberLE:dl,concatBytes:aa,createHmacDrbg:oh,ensureBytes:Xt,equalBytes:zp,hexToBytes:Bi,hexToNumber:ll,numberToBytesBE:Oi,numberToBytesLE:ul,numberToHexUnpadded:ah,numberToVarBytesBE:Gp,utf8ToBytes:Hp,validateObject:Ba},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const at=BigInt(0),Xe=BigInt(1),On=BigInt(2),Ip=BigInt(3),Cc=BigInt(4),Zl=BigInt(5),Xl=BigInt(8);BigInt(9);BigInt(16);function Tt(e,t){const r=e%t;return r>=at?r:t+r}function Wp(e,t,r){if(r<=at||t<at)throw new Error("Expected power/modulo > 0");if(r===Xe)return at;let n=Xe;for(;t>at;)t&Xe&&(n=n*e%r),e=e*e%r,t>>=Xe;return n}function Ht(e,t,r){let n=e;for(;t-- >at;)n*=n,n%=r;return n}function Tc(e,t){if(e===at||t<=at)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=Tt(e,t),n=t,s=at,a=Xe;for(;r!==at;){const c=n/r,l=n%r,d=s-a*c;n=r,r=l,s=a,a=d}if(n!==Xe)throw new Error("invert: does not exist");return Tt(s,t)}function Yp(e){const t=(e-Xe)/On;let r,n,s;for(r=e-Xe,n=0;r%On===at;r/=On,n++);for(s=On;s<e&&Wp(s,t,e)!==e-Xe;s++);if(n===1){const o=(e+Xe)/Cc;return function(l,d){const u=l.pow(d,o);if(!l.eql(l.sqr(u),d))throw new Error("Cannot find square root");return u}}const a=(r+Xe)/On;return function(c,l){if(c.pow(l,t)===c.neg(c.ONE))throw new Error("Cannot find square root");let d=n,u=c.pow(c.mul(c.ONE,s),r),h=c.pow(l,a),m=c.pow(l,r);for(;!c.eql(m,c.ONE);){if(c.eql(m,c.ZERO))return c.ZERO;let p=1;for(let g=c.sqr(m);p<d&&!c.eql(g,c.ONE);p++)g=c.sqr(g);const b=c.pow(u,Xe<<BigInt(d-p-1));u=c.sqr(b),h=c.mul(h,b),m=c.mul(m,u),d=p}return h}}function Zp(e){if(e%Cc===Ip){const t=(e+Xe)/Cc;return function(n,s){const a=n.pow(s,t);if(!n.eql(n.sqr(a),s))throw new Error("Cannot find square root");return a}}if(e%Xl===Zl){const t=(e-Zl)/Xl;return function(n,s){const a=n.mul(s,On),o=n.pow(a,t),c=n.mul(s,o),l=n.mul(n.mul(c,On),o),d=n.mul(c,n.sub(l,n.ONE));if(!n.eql(n.sqr(d),s))throw new Error("Cannot find square root");return d}}return Yp(e)}const Xp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Lp(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Xp.reduce((n,s)=>(n[s]="function",n),t);return Ba(e,r)}function Dp(e,t,r){if(r<at)throw new Error("Expected power > 0");if(r===at)return e.ONE;if(r===Xe)return t;let n=e.ONE,s=t;for(;r>at;)r&Xe&&(n=e.mul(n,s)),s=e.sqr(s),r>>=Xe;return n}function eg(e,t){const r=new Array(t.length),n=t.reduce((a,o,c)=>e.is0(o)?a:(r[c]=a,e.mul(a,o)),e.ONE),s=e.inv(n);return t.reduceRight((a,o,c)=>e.is0(o)?a:(r[c]=e.mul(a,r[c]),e.mul(a,o)),s),r}function ch(e,t){const r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function tg(e,t,r=!1,n={}){if(e<=at)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:s,nByteLength:a}=ch(e,t);if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Zp(e),c=Object.freeze({ORDER:e,BITS:s,BYTES:a,MASK:hl(s),ZERO:at,ONE:Xe,create:l=>Tt(l,e),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return at<=l&&l<e},is0:l=>l===at,isOdd:l=>(l&Xe)===Xe,neg:l=>Tt(-l,e),eql:(l,d)=>l===d,sqr:l=>Tt(l*l,e),add:(l,d)=>Tt(l+d,e),sub:(l,d)=>Tt(l-d,e),mul:(l,d)=>Tt(l*d,e),pow:(l,d)=>Dp(c,l,d),div:(l,d)=>Tt(l*Tc(d,e),e),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>Tc(l,e),sqrt:n.sqrt||(l=>o(c,l)),invertBatch:l=>eg(c,l),cmov:(l,d,u)=>u?d:l,toBytes:l=>r?ul(l,a):Oi(l,a),fromBytes:l=>{if(l.length!==a)throw new Error(`Fp.fromBytes: expected ${a}, got ${l.length}`);return r?dl(l):ds(l)}});return Object.freeze(c)}function lh(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function dh(e){const t=lh(e);return t+Math.ceil(t/2)}function rg(e,t,r=!1){const n=e.length,s=lh(t),a=dh(t);if(n<16||n<a||n>1024)throw new Error(`expected ${a}-1024 bytes of input, got ${n}`);const o=r?ds(e):dl(e),c=Tt(o,t-Xe)+Xe;return r?ul(c,s):Oi(c,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ng=BigInt(0),Zo=BigInt(1);function sg(e,t){const r=(s,a)=>{const o=a.negate();return s?o:a},n=s=>{const a=Math.ceil(t/s)+1,o=2**(s-1);return{windows:a,windowSize:o}};return{constTimeNegate:r,unsafeLadder(s,a){let o=e.ZERO,c=s;for(;a>ng;)a&Zo&&(o=o.add(c)),c=c.double(),a>>=Zo;return o},precomputeWindow(s,a){const{windows:o,windowSize:c}=n(a),l=[];let d=s,u=d;for(let h=0;h<o;h++){u=d,l.push(u);for(let m=1;m<c;m++)u=u.add(d),l.push(u);d=u.double()}return l},wNAF(s,a,o){const{windows:c,windowSize:l}=n(s);let d=e.ZERO,u=e.BASE;const h=BigInt(2**s-1),m=2**s,p=BigInt(s);for(let b=0;b<c;b++){const g=b*l;let v=Number(o&h);o>>=p,v>l&&(v-=m,o+=Zo);const N=g,V=g+Math.abs(v)-1,E=b%2!==0,Y=v<0;v===0?u=u.add(r(E,a[N])):d=d.add(r(Y,a[V]))}return{p:d,f:u}},wNAFCached(s,a,o,c){const l=s._WINDOW_SIZE||1;let d=a.get(s);return d||(d=this.precomputeWindow(s,l),l!==1&&a.set(s,c(d))),this.wNAF(l,d,o)}}}function uh(e){return Lp(e.Fp),Ba(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ch(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ig(e){const t=uh(e);Ba(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=t;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:ag,hexToBytes:og}=Kp,Gn={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(e){const{Err:t}=Gn;if(e.length<2||e[0]!==2)throw new t("Invalid signature integer tag");const r=e[1],n=e.subarray(2,r+2);if(!r||n.length!==r)throw new t("Invalid signature integer: wrong length");if(n[0]&128)throw new t("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new t("Invalid signature integer: unnecessary leading zero");return{d:ag(n),l:e.subarray(r+2)}},toSig(e){const{Err:t}=Gn,r=typeof e=="string"?og(e):e;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new t("Invalid signature tag");if(r[1]!==n-2)throw new t("Invalid signature: incorrect length");const{d:s,l:a}=Gn._parseInt(r.subarray(2)),{d:o,l:c}=Gn._parseInt(a);if(c.length)throw new t("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(e){const t=d=>Number.parseInt(d[0],16)&8?"00"+d:d,r=d=>{const u=d.toString(16);return u.length&1?`0${u}`:u},n=t(r(e.s)),s=t(r(e.r)),a=n.length/2,o=s.length/2,c=r(a),l=r(o);return`30${r(o+a+4)}02${l}${s}02${c}${n}`}},Qr=BigInt(0),Wt=BigInt(1);BigInt(2);const Ll=BigInt(3);BigInt(4);function cg(e){const t=ig(e),{Fp:r}=t,n=t.toBytes||((b,g,v)=>{const N=g.toAffine();return aa(Uint8Array.from([4]),r.toBytes(N.x),r.toBytes(N.y))}),s=t.fromBytes||(b=>{const g=b.subarray(1),v=r.fromBytes(g.subarray(0,r.BYTES)),N=r.fromBytes(g.subarray(r.BYTES,2*r.BYTES));return{x:v,y:N}});function a(b){const{a:g,b:v}=t,N=r.sqr(b),V=r.mul(N,b);return r.add(r.add(V,r.mul(b,g)),v)}if(!r.eql(r.sqr(t.Gy),a(t.Gx)))throw new Error("bad generator point: equation left != right");function o(b){return typeof b=="bigint"&&Qr<b&&b<t.n}function c(b){if(!o(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(b){const{allowedPrivateKeyLengths:g,nByteLength:v,wrapPrivateKey:N,n:V}=t;if(g&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=Pi(b)),typeof b!="string"||!g.includes(b.length))throw new Error("Invalid key");b=b.padStart(v*2,"0")}let E;try{E=typeof b=="bigint"?b:ds(Xt("private key",b,v))}catch{throw new Error(`private key must be ${v} bytes, hex or bigint, not ${typeof b}`)}return N&&(E=Tt(E,V)),c(E),E}const d=new Map;function u(b){if(!(b instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(g,v,N){if(this.px=g,this.py=v,this.pz=N,g==null||!r.isValid(g))throw new Error("x required");if(v==null||!r.isValid(v))throw new Error("y required");if(N==null||!r.isValid(N))throw new Error("z required")}static fromAffine(g){const{x:v,y:N}=g||{};if(!g||!r.isValid(v)||!r.isValid(N))throw new Error("invalid affine point");if(g instanceof h)throw new Error("projective point not allowed");const V=E=>r.eql(E,r.ZERO);return V(v)&&V(N)?h.ZERO:new h(v,N,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(g){const v=r.invertBatch(g.map(N=>N.pz));return g.map((N,V)=>N.toAffine(v[V])).map(h.fromAffine)}static fromHex(g){const v=h.fromAffine(s(Xt("pointHex",g)));return v.assertValidity(),v}static fromPrivateKey(g){return h.BASE.multiply(l(g))}_setWindowSize(g){this._WINDOW_SIZE=g,d.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:g,y:v}=this.toAffine();if(!r.isValid(g)||!r.isValid(v))throw new Error("bad point: x or y not FE");const N=r.sqr(v),V=a(g);if(!r.eql(N,V))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:g}=this.toAffine();if(r.isOdd)return!r.isOdd(g);throw new Error("Field doesn't support isOdd")}equals(g){u(g);const{px:v,py:N,pz:V}=this,{px:E,py:Y,pz:O}=g,Z=r.eql(r.mul(v,O),r.mul(E,V)),q=r.eql(r.mul(N,O),r.mul(Y,V));return Z&&q}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){const{a:g,b:v}=t,N=r.mul(v,Ll),{px:V,py:E,pz:Y}=this;let O=r.ZERO,Z=r.ZERO,q=r.ZERO,R=r.mul(V,V),K=r.mul(E,E),ne=r.mul(Y,Y),z=r.mul(V,E);return z=r.add(z,z),q=r.mul(V,Y),q=r.add(q,q),O=r.mul(g,q),Z=r.mul(N,ne),Z=r.add(O,Z),O=r.sub(K,Z),Z=r.add(K,Z),Z=r.mul(O,Z),O=r.mul(z,O),q=r.mul(N,q),ne=r.mul(g,ne),z=r.sub(R,ne),z=r.mul(g,z),z=r.add(z,q),q=r.add(R,R),R=r.add(q,R),R=r.add(R,ne),R=r.mul(R,z),Z=r.add(Z,R),ne=r.mul(E,Y),ne=r.add(ne,ne),R=r.mul(ne,z),O=r.sub(O,R),q=r.mul(ne,K),q=r.add(q,q),q=r.add(q,q),new h(O,Z,q)}add(g){u(g);const{px:v,py:N,pz:V}=this,{px:E,py:Y,pz:O}=g;let Z=r.ZERO,q=r.ZERO,R=r.ZERO;const K=t.a,ne=r.mul(t.b,Ll);let z=r.mul(v,E),k=r.mul(N,Y),S=r.mul(V,O),ce=r.add(v,N),U=r.add(E,Y);ce=r.mul(ce,U),U=r.add(z,k),ce=r.sub(ce,U),U=r.add(v,V);let C=r.add(E,O);return U=r.mul(U,C),C=r.add(z,S),U=r.sub(U,C),C=r.add(N,V),Z=r.add(Y,O),C=r.mul(C,Z),Z=r.add(k,S),C=r.sub(C,Z),R=r.mul(K,U),Z=r.mul(ne,S),R=r.add(Z,R),Z=r.sub(k,R),R=r.add(k,R),q=r.mul(Z,R),k=r.add(z,z),k=r.add(k,z),S=r.mul(K,S),U=r.mul(ne,U),k=r.add(k,S),S=r.sub(z,S),S=r.mul(K,S),U=r.add(U,S),z=r.mul(k,U),q=r.add(q,z),z=r.mul(C,U),Z=r.mul(ce,Z),Z=r.sub(Z,z),z=r.mul(ce,k),R=r.mul(C,R),R=r.add(R,z),new h(Z,q,R)}subtract(g){return this.add(g.negate())}is0(){return this.equals(h.ZERO)}wNAF(g){return p.wNAFCached(this,d,g,v=>{const N=r.invertBatch(v.map(V=>V.pz));return v.map((V,E)=>V.toAffine(N[E])).map(h.fromAffine)})}multiplyUnsafe(g){const v=h.ZERO;if(g===Qr)return v;if(c(g),g===Wt)return this;const{endo:N}=t;if(!N)return p.unsafeLadder(this,g);let{k1neg:V,k1:E,k2neg:Y,k2:O}=N.splitScalar(g),Z=v,q=v,R=this;for(;E>Qr||O>Qr;)E&Wt&&(Z=Z.add(R)),O&Wt&&(q=q.add(R)),R=R.double(),E>>=Wt,O>>=Wt;return V&&(Z=Z.negate()),Y&&(q=q.negate()),q=new h(r.mul(q.px,N.beta),q.py,q.pz),Z.add(q)}multiply(g){c(g);let v=g,N,V;const{endo:E}=t;if(E){const{k1neg:Y,k1:O,k2neg:Z,k2:q}=E.splitScalar(v);let{p:R,f:K}=this.wNAF(O),{p:ne,f:z}=this.wNAF(q);R=p.constTimeNegate(Y,R),ne=p.constTimeNegate(Z,ne),ne=new h(r.mul(ne.px,E.beta),ne.py,ne.pz),N=R.add(ne),V=K.add(z)}else{const{p:Y,f:O}=this.wNAF(v);N=Y,V=O}return h.normalizeZ([N,V])[0]}multiplyAndAddUnsafe(g,v,N){const V=h.BASE,E=(O,Z)=>Z===Qr||Z===Wt||!O.equals(V)?O.multiplyUnsafe(Z):O.multiply(Z),Y=E(this,v).add(E(g,N));return Y.is0()?void 0:Y}toAffine(g){const{px:v,py:N,pz:V}=this,E=this.is0();g==null&&(g=E?r.ONE:r.inv(V));const Y=r.mul(v,g),O=r.mul(N,g),Z=r.mul(V,g);if(E)return{x:r.ZERO,y:r.ZERO};if(!r.eql(Z,r.ONE))throw new Error("invZ was invalid");return{x:Y,y:O}}isTorsionFree(){const{h:g,isTorsionFree:v}=t;if(g===Wt)return!0;if(v)return v(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:g,clearCofactor:v}=t;return g===Wt?this:v?v(h,this):this.multiplyUnsafe(t.h)}toRawBytes(g=!0){return this.assertValidity(),n(h,this,g)}toHex(g=!0){return Pi(this.toRawBytes(g))}}h.BASE=new h(t.Gx,t.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);const m=t.nBitLength,p=sg(h,t.endo?Math.ceil(m/2):m);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:l,weierstrassEquation:a,isWithinCurveOrder:o}}function lg(e){const t=uh(e);return Ba(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function dg(e){const t=lg(e),{Fp:r,n}=t,s=r.BYTES+1,a=2*r.BYTES+1;function o(U){return Qr<U&&U<r.ORDER}function c(U){return Tt(U,n)}function l(U){return Tc(U,n)}const{ProjectivePoint:d,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:m}=cg({...t,toBytes(U,C,j){const w=C.toAffine(),H=r.toBytes(w.x),J=aa;return j?J(Uint8Array.from([C.hasEvenY()?2:3]),H):J(Uint8Array.from([4]),H,r.toBytes(w.y))},fromBytes(U){const C=U.length,j=U[0],w=U.subarray(1);if(C===s&&(j===2||j===3)){const H=ds(w);if(!o(H))throw new Error("Point is not on curve");const J=h(H);let y=r.sqrt(J);const M=(y&Wt)===Wt;return(j&1)===1!==M&&(y=r.neg(y)),{x:H,y}}else if(C===a&&j===4){const H=r.fromBytes(w.subarray(0,r.BYTES)),J=r.fromBytes(w.subarray(r.BYTES,2*r.BYTES));return{x:H,y:J}}else throw new Error(`Point of length ${C} was invalid. Expected ${s} compressed bytes or ${a} uncompressed bytes`)}}),p=U=>Pi(Oi(U,t.nByteLength));function b(U){const C=n>>Wt;return U>C}function g(U){return b(U)?c(-U):U}const v=(U,C,j)=>ds(U.slice(C,j));class N{constructor(C,j,w){this.r=C,this.s=j,this.recovery=w,this.assertValidity()}static fromCompact(C){const j=t.nByteLength;return C=Xt("compactSignature",C,j*2),new N(v(C,0,j),v(C,j,2*j))}static fromDER(C){const{r:j,s:w}=Gn.toSig(Xt("DER",C));return new N(j,w)}assertValidity(){if(!m(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!m(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(C){return new N(this.r,this.s,C)}recoverPublicKey(C){const{r:j,s:w,recovery:H}=this,J=q(Xt("msgHash",C));if(H==null||![0,1,2,3].includes(H))throw new Error("recovery id invalid");const y=H===2||H===3?j+t.n:j;if(y>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const M=(H&1)===0?"02":"03",P=d.fromHex(M+p(y)),Q=l(y),L=c(-J*Q),se=c(w*Q),F=d.BASE.multiplyAndAddUnsafe(P,L,se);if(!F)throw new Error("point at infinify");return F.assertValidity(),F}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new N(this.r,c(-this.s),this.recovery):this}toDERRawBytes(){return Bi(this.toDERHex())}toDERHex(){return Gn.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Bi(this.toCompactHex())}toCompactHex(){return p(this.r)+p(this.s)}}const V={isValidPrivateKey(U){try{return u(U),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const U=dh(t.n);return rg(t.randomBytes(U),t.n)},precompute(U=8,C=d.BASE){return C._setWindowSize(U),C.multiply(BigInt(3)),C}};function E(U,C=!0){return d.fromPrivateKey(U).toRawBytes(C)}function Y(U){const C=U instanceof Uint8Array,j=typeof U=="string",w=(C||j)&&U.length;return C?w===s||w===a:j?w===2*s||w===2*a:U instanceof d}function O(U,C,j=!0){if(Y(U))throw new Error("first arg must be private key");if(!Y(C))throw new Error("second arg must be public key");return d.fromHex(C).multiply(u(U)).toRawBytes(j)}const Z=t.bits2int||function(U){const C=ds(U),j=U.length*8-t.nBitLength;return j>0?C>>BigInt(j):C},q=t.bits2int_modN||function(U){return c(Z(U))},R=hl(t.nBitLength);function K(U){if(typeof U!="bigint")throw new Error("bigint expected");if(!(Qr<=U&&U<R))throw new Error(`bigint expected < 2^${t.nBitLength}`);return Oi(U,t.nByteLength)}function ne(U,C,j=z){if(["recovered","canonical"].some(ee=>ee in j))throw new Error("sign() legacy options not supported");const{hash:w,randomBytes:H}=t;let{lowS:J,prehash:y,extraEntropy:M}=j;J==null&&(J=!0),U=Xt("msgHash",U),y&&(U=Xt("prehashed msgHash",w(U)));const P=q(U),Q=u(C),L=[K(Q),K(P)];if(M!=null){const ee=M===!0?H(r.BYTES):M;L.push(Xt("extraEntropy",ee))}const se=aa(...L),F=P;function I(ee){const D=Z(ee);if(!m(D))return;const re=l(D),oe=d.BASE.multiply(D).toAffine(),pe=c(oe.x);if(pe===Qr)return;const Ne=c(re*c(F+pe*Q));if(Ne===Qr)return;let Te=(oe.x===pe?0:2)|Number(oe.y&Wt),ae=Ne;return J&&b(Ne)&&(ae=g(Ne),Te^=1),new N(pe,ae,Te)}return{seed:se,k2sig:I}}const z={lowS:t.lowS,prehash:!1},k={lowS:t.lowS,prehash:!1};function S(U,C,j=z){const{seed:w,k2sig:H}=ne(U,C,j),J=t;return oh(J.hash.outputLen,J.nByteLength,J.hmac)(w,H)}d.BASE._setWindowSize(8);function ce(U,C,j,w=k){var oe;const H=U;if(C=Xt("msgHash",C),j=Xt("publicKey",j),"strict"in w)throw new Error("options.strict was renamed to lowS");const{lowS:J,prehash:y}=w;let M,P;try{if(typeof H=="string"||H instanceof Uint8Array)try{M=N.fromDER(H)}catch(pe){if(!(pe instanceof Gn.Err))throw pe;M=N.fromCompact(H)}else if(typeof H=="object"&&typeof H.r=="bigint"&&typeof H.s=="bigint"){const{r:pe,s:Ne}=H;M=new N(pe,Ne)}else throw new Error("PARSE");P=d.fromHex(j)}catch(pe){if(pe.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(J&&M.hasHighS())return!1;y&&(C=t.hash(C));const{r:Q,s:L}=M,se=q(C),F=l(L),I=c(se*F),ee=c(Q*F),D=(oe=d.BASE.multiplyAndAddUnsafe(P,I,ee))==null?void 0:oe.toAffine();return D?c(D.x)===Q:!1}return{CURVE:t,getPublicKey:E,getSharedSecret:O,sign:S,verify:ce,ProjectivePoint:d,Signature:N,utils:V}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ug(e){return{hash:e,hmac:(t,...r)=>Fo(e,t,Ym(...r)),randomBytes:Lm}}function hg(e,t){const r=n=>dg({...e,...ug(n)});return Object.freeze({...r(t),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const hh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Dl=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),fg=BigInt(1),jc=BigInt(2),ed=(e,t)=>(e+t/jc)/t;function mg(e){const t=hh,r=BigInt(3),n=BigInt(6),s=BigInt(11),a=BigInt(22),o=BigInt(23),c=BigInt(44),l=BigInt(88),d=e*e*e%t,u=d*d*e%t,h=Ht(u,r,t)*u%t,m=Ht(h,r,t)*u%t,p=Ht(m,jc,t)*d%t,b=Ht(p,s,t)*p%t,g=Ht(b,a,t)*b%t,v=Ht(g,c,t)*g%t,N=Ht(v,l,t)*v%t,V=Ht(N,c,t)*g%t,E=Ht(V,r,t)*u%t,Y=Ht(E,o,t)*b%t,O=Ht(Y,n,t)*d%t,Z=Ht(O,jc,t);if(!Sc.eql(Sc.sqr(Z),e))throw new Error("Cannot find square root");return Z}const Sc=tg(hh,void 0,void 0,{sqrt:mg}),tn=hg({a:BigInt(0),b:BigInt(7),Fp:Sc,n:Dl,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Dl,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-fg*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,o=BigInt("0x100000000000000000000000000000000"),c=ed(a*e,t),l=ed(-n*e,t);let d=Tt(e-c*r-l*s,t),u=Tt(-c*n-l*a,t);const h=d>o,m=u>o;if(h&&(d=t-d),m&&(u=t-u),d>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:d,k2neg:m,k2:u}}}},Ro);BigInt(0);tn.ProjectivePoint;const oa="0x0000000000000000000000000000000000000000",td="0x0000000000000000000000000000000000000000000000000000000000000000",rd=BigInt(0),nd=BigInt(1),sd=BigInt(2),id=BigInt(27),ad=BigInt(28),Qa=BigInt(35),Es={};function od(e){return Kr(tt(e),32)}var Is,ur,Ws,Xn;const Zt=class Zt{constructor(t,r,n,s){B(this,Is);B(this,ur);B(this,Ws);B(this,Xn);Ra(t,Es,"Signature"),x(this,Is,r),x(this,ur,n),x(this,Ws,s),x(this,Xn,null)}get r(){return f(this,Is)}set r(t){A(Ms(t)===32,"invalid r","value",t),x(this,Is,ue(t))}get s(){return A(parseInt(f(this,ur).substring(0,3))<8,"non-canonical s; use ._s","s",f(this,ur)),f(this,ur)}set s(t){A(Ms(t)===32,"invalid s","value",t),x(this,ur,ue(t))}get _s(){return f(this,ur)}isValid(){return parseInt(f(this,ur).substring(0,3))<8}get v(){return f(this,Ws)}set v(t){const r=Se(t,"value");A(r===27||r===28,"invalid v","v",t),x(this,Ws,r)}get networkV(){return f(this,Xn)}get legacyChainId(){const t=this.networkV;return t==null?null:Zt.getChainId(t)}get yParity(){return this.v===27?0:1}get yParityAndS(){const t=je(this.s);return this.yParity&&(t[0]|=128),ue(t)}get compactSerialized(){return Ye([this.r,this.yParityAndS])}get serialized(){return Ye([this.r,this.s,this.yParity?"0x1c":"0x1b"])}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const t=new Zt(Es,this.r,this._s,this.v);return this.networkV&&x(t,Xn,this.networkV),t}toJSON(){const t=this.networkV;return{_type:"signature",networkV:t!=null?t.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(t){const r=me(t,"v");return r==id||r==ad?rd:(A(r>=Qa,"invalid EIP-155 v","v",t),(r-Qa)/sd)}static getChainIdV(t,r){return me(t)*sd+BigInt(35+r-27)}static getNormalizedV(t){const r=me(t);return r===rd||r===id?27:r===nd||r===ad?28:(A(r>=Qa,"invalid v","v",t),r&nd?27:28)}static from(t){function r(d,u){A(d,u,"signature",t)}if(t==null)return new Zt(Es,td,td,27);if(typeof t=="string"){const d=je(t,"signature");if(d.length===64){const u=ue(d.slice(0,32)),h=d.slice(32,64),m=h[0]&128?28:27;return h[0]&=127,new Zt(Es,u,ue(h),m)}if(d.length===65){const u=ue(d.slice(0,32)),h=ue(d.slice(32,64)),m=Zt.getNormalizedV(d[64]);return new Zt(Es,u,h,m)}r(!1,"invalid raw signature length")}if(t instanceof Zt)return t.clone();const n=t.r;r(n!=null,"missing r");const s=od(n),a=function(d,u){if(d!=null)return od(d);if(u!=null){r(qe(u,32),"invalid yParityAndS");const h=je(u);return h[0]&=127,ue(h)}r(!1,"missing s")}(t.s,t.yParityAndS),{networkV:o,v:c}=function(d,u,h){if(d!=null){const m=me(d);return{networkV:m>=Qa?m:void 0,v:Zt.getNormalizedV(m)}}if(u!=null)return r(qe(u,32),"invalid yParityAndS"),{v:je(u)[0]&128?28:27};if(h!=null){switch(Se(h,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}r(!1,"invalid yParity")}r(!1,"missing v")}(t.v,t.yParityAndS,t.yParity),l=new Zt(Es,s,a,c);return o&&x(l,Xn,o),r(t.yParity==null||Se(t.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),r(t.yParityAndS==null||t.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};Is=new WeakMap,ur=new WeakMap,Ws=new WeakMap,Xn=new WeakMap;let Rt=Zt;var Or;const Mn=class Mn{constructor(t){B(this,Or);A(Ms(t)===32,"invalid private key","privateKey","[REDACTED]"),x(this,Or,ue(t))}get privateKey(){return f(this,Or)}get publicKey(){return Mn.computePublicKey(f(this,Or))}get compressedPublicKey(){return Mn.computePublicKey(f(this,Or),!0)}sign(t){A(Ms(t)===32,"invalid digest length","digest",t);const r=tn.sign(wt(t),wt(f(this,Or)),{lowS:!0});return Rt.from({r:vn(r.r,32),s:vn(r.s,32),v:r.recovery?28:27})}computeSharedSecret(t){const r=Mn.computePublicKey(t);return ue(tn.getSharedSecret(wt(f(this,Or)),je(r),!1))}static computePublicKey(t,r){let n=je(t,"key");if(n.length===32){const a=tn.getPublicKey(n,!!r);return ue(a)}if(n.length===64){const a=new Uint8Array(65);a[0]=4,a.set(n,1),n=a}const s=tn.ProjectivePoint.fromHex(n);return ue(s.toRawBytes(r))}static recoverPublicKey(t,r){A(Ms(t)===32,"invalid digest length","digest",t);const n=Rt.from(r);let s=tn.Signature.fromCompact(wt(Ye([n.r,n.s])));s=s.addRecoveryBit(n.yParity);const a=s.recoverPublicKey(wt(t));return A(a!=null,"invalid signature for digest","signature",r),"0x"+a.toHex(!1)}static addPoints(t,r,n){const s=tn.ProjectivePoint.fromHex(Mn.computePublicKey(t).substring(2)),a=tn.ProjectivePoint.fromHex(Mn.computePublicKey(r).substring(2));return"0x"+s.add(a).toHex(!!n)}};Or=new WeakMap;let ca=Mn;const pg=BigInt(0),gg=BigInt(36);function cd(e){e=e.toLowerCase();const t=e.substring(2).split(""),r=new Uint8Array(40);for(let s=0;s<40;s++)r[s]=t[s].charCodeAt(0);const n=je(Le(r));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(t[s]=t[s].toUpperCase()),(n[s>>1]&15)>=8&&(t[s+1]=t[s+1].toUpperCase());return"0x"+t.join("")}const fl={};for(let e=0;e<10;e++)fl[String(e)]=String(e);for(let e=0;e<26;e++)fl[String.fromCharCode(65+e)]=String(10+e);const ld=15;function fh(e){e=e.toUpperCase(),e=e.substring(4)+e.substring(0,2)+"00";let t=e.split("").map(n=>fl[n]).join("");for(;t.length>=ld;){let n=t.substring(0,ld);t=parseInt(n,10)%97+t.substring(n.length)}let r=String(98-parseInt(t,10)%97);for(;r.length<2;)r="0"+r;return r}const xg=function(){const e={};for(let t=0;t<36;t++){const r="0123456789abcdefghijklmnopqrstuvwxyz"[t];e[r]=BigInt(t)}return e}();function bg(e){e=e.toLowerCase();let t=pg;for(let r=0;r<e.length;r++)t=t*gg+xg[e[r]];return t}function Ue(e){if(A(typeof e=="string","invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/)){e.startsWith("0x")||(e="0x"+e);const t=cd(e);return A(!e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||t===e,"bad address checksum","address",e),t}if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){A(e.substring(2,4)===fh(e),"bad icap checksum","address",e);let t=bg(e.substring(4)).toString(16);for(;t.length<40;)t="0"+t;return cd("0x"+t)}A(!1,"invalid address","address",e)}function Uy(e){let t=BigInt(Ue(e)).toString(36).toUpperCase();for(;t.length<30;)t="0"+t;return"XE"+fh("XE00"+t)+t}function yg(e){const t=Ue(e.from);let n=me(e.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,Ue(Ie(Le(En([t,n])),12))}function Vy(e,t,r){const n=Ue(e),s=je(t,"salt"),a=je(r,"initCodeHash");return A(s.length===32,"salt must be 32 bytes","salt",t),A(a.length===32,"initCodeHash must be 32 bytes","initCodeHash",r),Ue(Ie(Le(Ye(["0xff",n,s,a])),12))}function mh(e){return e&&typeof e.getAddress=="function"}function Gy(e){try{return Ue(e),!0}catch{}return!1}async function Xo(e,t){const r=await t;return(r==null||r==="0x0000000000000000000000000000000000000000")&&(W(typeof e!="string","unconfigured name","UNCONFIGURED_NAME",{value:e}),A(!1,"invalid AddressLike value; did not resolve to a value address","target",e)),Ue(r)}function At(e,t){if(typeof e=="string")return e.match(/^0x[0-9a-f]{40}$/i)?Ue(e):(W(t!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Xo(e,t.resolveName(e)));if(mh(e))return Xo(e,e.getAddress());if(e&&typeof e.then=="function")return Xo(e,e);A(!1,"unsupported addressable value","target",e)}const Tr={};function fe(e,t){let r=!1;return t<0&&(r=!0,t*=-1),new pt(Tr,`${r?"":"u"}int${t}`,e,{signed:r,width:t})}function Ve(e,t){return new pt(Tr,`bytes${t||""}`,e,{size:t})}const dd=Symbol.for("_ethers_typed");var Ln;const jr=class jr{constructor(t,r,n,s){T(this,"type");T(this,"value");B(this,Ln);T(this,"_typedSymbol");s==null&&(s=null),Ra(Tr,t,"Typed"),ve(this,{_typedSymbol:dd,type:r,value:n}),x(this,Ln,s),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(t=>t.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return f(this,Ln)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return f(this,Ln)===!0?-1:f(this,Ln)===!1?this.value.length:null}static from(t,r){return new jr(Tr,t,r)}static uint8(t){return fe(t,8)}static uint16(t){return fe(t,16)}static uint24(t){return fe(t,24)}static uint32(t){return fe(t,32)}static uint40(t){return fe(t,40)}static uint48(t){return fe(t,48)}static uint56(t){return fe(t,56)}static uint64(t){return fe(t,64)}static uint72(t){return fe(t,72)}static uint80(t){return fe(t,80)}static uint88(t){return fe(t,88)}static uint96(t){return fe(t,96)}static uint104(t){return fe(t,104)}static uint112(t){return fe(t,112)}static uint120(t){return fe(t,120)}static uint128(t){return fe(t,128)}static uint136(t){return fe(t,136)}static uint144(t){return fe(t,144)}static uint152(t){return fe(t,152)}static uint160(t){return fe(t,160)}static uint168(t){return fe(t,168)}static uint176(t){return fe(t,176)}static uint184(t){return fe(t,184)}static uint192(t){return fe(t,192)}static uint200(t){return fe(t,200)}static uint208(t){return fe(t,208)}static uint216(t){return fe(t,216)}static uint224(t){return fe(t,224)}static uint232(t){return fe(t,232)}static uint240(t){return fe(t,240)}static uint248(t){return fe(t,248)}static uint256(t){return fe(t,256)}static uint(t){return fe(t,256)}static int8(t){return fe(t,-8)}static int16(t){return fe(t,-16)}static int24(t){return fe(t,-24)}static int32(t){return fe(t,-32)}static int40(t){return fe(t,-40)}static int48(t){return fe(t,-48)}static int56(t){return fe(t,-56)}static int64(t){return fe(t,-64)}static int72(t){return fe(t,-72)}static int80(t){return fe(t,-80)}static int88(t){return fe(t,-88)}static int96(t){return fe(t,-96)}static int104(t){return fe(t,-104)}static int112(t){return fe(t,-112)}static int120(t){return fe(t,-120)}static int128(t){return fe(t,-128)}static int136(t){return fe(t,-136)}static int144(t){return fe(t,-144)}static int152(t){return fe(t,-152)}static int160(t){return fe(t,-160)}static int168(t){return fe(t,-168)}static int176(t){return fe(t,-176)}static int184(t){return fe(t,-184)}static int192(t){return fe(t,-192)}static int200(t){return fe(t,-200)}static int208(t){return fe(t,-208)}static int216(t){return fe(t,-216)}static int224(t){return fe(t,-224)}static int232(t){return fe(t,-232)}static int240(t){return fe(t,-240)}static int248(t){return fe(t,-248)}static int256(t){return fe(t,-256)}static int(t){return fe(t,-256)}static bytes1(t){return Ve(t,1)}static bytes2(t){return Ve(t,2)}static bytes3(t){return Ve(t,3)}static bytes4(t){return Ve(t,4)}static bytes5(t){return Ve(t,5)}static bytes6(t){return Ve(t,6)}static bytes7(t){return Ve(t,7)}static bytes8(t){return Ve(t,8)}static bytes9(t){return Ve(t,9)}static bytes10(t){return Ve(t,10)}static bytes11(t){return Ve(t,11)}static bytes12(t){return Ve(t,12)}static bytes13(t){return Ve(t,13)}static bytes14(t){return Ve(t,14)}static bytes15(t){return Ve(t,15)}static bytes16(t){return Ve(t,16)}static bytes17(t){return Ve(t,17)}static bytes18(t){return Ve(t,18)}static bytes19(t){return Ve(t,19)}static bytes20(t){return Ve(t,20)}static bytes21(t){return Ve(t,21)}static bytes22(t){return Ve(t,22)}static bytes23(t){return Ve(t,23)}static bytes24(t){return Ve(t,24)}static bytes25(t){return Ve(t,25)}static bytes26(t){return Ve(t,26)}static bytes27(t){return Ve(t,27)}static bytes28(t){return Ve(t,28)}static bytes29(t){return Ve(t,29)}static bytes30(t){return Ve(t,30)}static bytes31(t){return Ve(t,31)}static bytes32(t){return Ve(t,32)}static address(t){return new jr(Tr,"address",t)}static bool(t){return new jr(Tr,"bool",!!t)}static bytes(t){return new jr(Tr,"bytes",t)}static string(t){return new jr(Tr,"string",t)}static array(t,r){throw new Error("not implemented yet")}static tuple(t,r){throw new Error("not implemented yet")}static overrides(t){return new jr(Tr,"overrides",Object.assign({},t))}static isTyped(t){return t&&typeof t=="object"&&"_typedSymbol"in t&&t._typedSymbol===dd}static dereference(t,r){if(jr.isTyped(t)){if(t.type!==r)throw new Error(`invalid type: expecetd ${r}, got ${t.type}`);return t.value}return t}};Ln=new WeakMap;let pt=jr;class wg extends Yr{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,r){let n=pt.dereference(r,"string");try{n=Ue(n)}catch(s){return this._throwError(s.message,r)}return t.writeValue(n)}decode(t){return Ue(vn(t.readValue(),20))}}class Ng extends Yr{constructor(r){super(r.name,r.type,"_",r.dynamic);T(this,"coder");this.coder=r}defaultValue(){return this.coder.defaultValue()}encode(r,n){return this.coder.encode(r,n)}decode(r){return this.coder.decode(r)}}function ph(e,t,r){let n=[];if(Array.isArray(r))n=r;else if(r&&typeof r=="object"){let l={};n=t.map(d=>{const u=d.localName;return W(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:r}),W(!l[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:r}),l[u]=!0,r[u]})}else A(!1,"invalid tuple value","tuple",r);A(t.length===n.length,"types/value length mismatch","tuple",r);let s=new Ac,a=new Ac,o=[];t.forEach((l,d)=>{let u=n[d];if(l.dynamic){let h=a.length;l.encode(a,u);let m=s.writeUpdatableValue();o.push(p=>{m(p+h)})}else l.encode(s,u)}),o.forEach(l=>{l(s.length)});let c=e.appendWriter(s);return c+=e.appendWriter(a),c}function gh(e,t){let r=[],n=[],s=e.subReader(0);return t.forEach(a=>{let o=null;if(a.dynamic){let c=e.readIndex(),l=s.subReader(c);try{o=a.decode(l)}catch(d){if(dt(d,"BUFFER_OVERRUN"))throw d;o=d,o.baseType=a.name,o.name=a.localName,o.type=a.type}}else try{o=a.decode(e)}catch(c){if(dt(c,"BUFFER_OVERRUN"))throw c;o=c,o.baseType=a.name,o.name=a.localName,o.type=a.type}if(o==null)throw new Error("investigate");r.push(o),n.push(a.localName||null)}),Si.fromItems(r,n)}class Ag extends Yr{constructor(r,n,s){const a=r.type+"["+(n>=0?n:"")+"]",o=n===-1||r.dynamic;super("array",a,s,o);T(this,"coder");T(this,"length");ve(this,{coder:r,length:n})}defaultValue(){const r=this.coder.defaultValue(),n=[];for(let s=0;s<this.length;s++)n.push(r);return n}encode(r,n){const s=pt.dereference(n,"array");Array.isArray(s)||this._throwError("expected array value",s);let a=this.length;a===-1&&(a=s.length,r.writeValue(s.length)),yu(s.length,a,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let c=0;c<s.length;c++)o.push(this.coder);return ph(r,o,s)}decode(r){let n=this.length;n===-1&&(n=r.readIndex(),W(n*Nt<=r.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:r.bytes,offset:n*Nt,length:r.dataLength}));let s=[];for(let a=0;a<n;a++)s.push(new Ng(this.coder));return gh(r,s)}}class vg extends Yr{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,r){const n=pt.dereference(r,"bool");return t.writeValue(n?1:0)}decode(t){return!!t.readValue()}}class xh extends Yr{constructor(t,r){super(t,t,r,!0)}defaultValue(){return"0x"}encode(t,r){r=wt(r);let n=t.writeValue(r.length);return n+=t.writeBytes(r),n}decode(t){return t.readBytes(t.readIndex(),!0)}}class Eg extends xh{constructor(t){super("bytes",t)}decode(t){return ue(super.decode(t))}}class kg extends Yr{constructor(r,n){let s="bytes"+String(r);super(s,s,n,!1);T(this,"size");ve(this,{size:r},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(r,n){let s=wt(pt.dereference(n,this.type));return s.length!==this.size&&this._throwError("incorrect data length",n),r.writeBytes(s)}decode(r){return ue(r.readBytes(this.size))}}const Cg=new Uint8Array([]);class Tg extends Yr{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,r){return r!=null&&this._throwError("not null",r),t.writeBytes(Cg)}decode(t){return t.readBytes(0),null}}const jg=BigInt(0),Sg=BigInt(1),Fg=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Rg extends Yr{constructor(r,n,s){const a=(n?"int":"uint")+r*8;super(a,a,s,!1);T(this,"size");T(this,"signed");ve(this,{size:r,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(r,n){let s=me(pt.dereference(n,this.type)),a=Vn(Fg,Nt*8);if(this.signed){let o=Vn(a,this.size*8-1);(s>o||s<-(o+Sg))&&this._throwError("value out-of-bounds",n),s=Au(s,8*Nt)}else(s<jg||s>Vn(a,this.size*8))&&this._throwError("value out-of-bounds",n);return r.writeValue(s)}decode(r){let n=Vn(r.readValue(),this.size*8);return this.signed&&(n=ao(n,this.size*8)),n}}class Pg extends xh{constructor(t){super("string",t)}defaultValue(){return""}encode(t,r){return super.encode(t,Ar(pt.dereference(r,"string")))}decode(t){return co(super.decode(t))}}class qa extends Yr{constructor(r,n){let s=!1;const a=[];r.forEach(c=>{c.dynamic&&(s=!0),a.push(c.type)});const o="tuple("+a.join(",")+")";super("tuple",o,n,s);T(this,"coders");ve(this,{coders:Object.freeze(r.slice())})}defaultValue(){const r=[];this.coders.forEach(s=>{r.push(s.defaultValue())});const n=this.coders.reduce((s,a)=>{const o=a.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});return this.coders.forEach((s,a)=>{let o=s.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),r[o]==null&&(r[o]=r[a]))}),Object.freeze(r)}encode(r,n){const s=pt.dereference(n,"tuple");return ph(r,this.coders,s)}decode(r){return gh(r,this.coders)}}function Lo(e,t){return{address:Ue(e),storageKeys:t.map((r,n)=>(A(qe(r,32),"invalid slot",`storageKeys[${n}]`,r),r.toLowerCase()))}}function bs(e){if(Array.isArray(e))return e.map((r,n)=>Array.isArray(r)?(A(r.length===2,"invalid slot set",`value[${n}]`,r),Lo(r[0],r[1])):(A(r!=null&&typeof r=="object","invalid address-slot set","value",e),Lo(r.address,r.storageKeys)));A(e!=null&&typeof e=="object","invalid access list","value",e);const t=Object.keys(e).map(r=>{const n=e[r].reduce((s,a)=>(s[a]=!0,s),{});return Lo(r,Object.keys(n).sort())});return t.sort((r,n)=>r.address.localeCompare(n.address)),t}function bh(e){return{address:Ue(e.address),nonce:me(e.nonce!=null?e.nonce:0),chainId:me(e.chainId!=null?e.chainId:0),signature:Rt.from(e.signature)}}function Bg(e){let t;return typeof e=="string"?t=ca.computePublicKey(e,!1):t=e.publicKey,Ue(Le("0x"+t.substring(4)).substring(26))}function yh(e,t){return Bg(ca.recoverPublicKey(e,t))}const st=BigInt(0),Og=BigInt(2),Mg=BigInt(27),_g=BigInt(28),Ug=BigInt(35),Vg=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Do=4096*32;function Gg(e){return{blobToKzgCommitment:n=>{if("computeBlobProof"in e){if("blobToKzgCommitment"in e&&typeof e.blobToKzgCommitment=="function")return je(e.blobToKzgCommitment(ue(n)))}else if("blobToKzgCommitment"in e&&typeof e.blobToKzgCommitment=="function")return je(e.blobToKzgCommitment(n));if("blobToKZGCommitment"in e&&typeof e.blobToKZGCommitment=="function")return je(e.blobToKZGCommitment(ue(n)));A(!1,"unsupported KZG library","kzg",e)},computeBlobKzgProof:(n,s)=>{if("computeBlobProof"in e&&typeof e.computeBlobProof=="function")return je(e.computeBlobProof(ue(n),ue(s)));if("computeBlobKzgProof"in e&&typeof e.computeBlobKzgProof=="function")return e.computeBlobKzgProof(n,s);if("computeBlobKZGProof"in e&&typeof e.computeBlobKZGProof=="function")return je(e.computeBlobKZGProof(ue(n),ue(s)));A(!1,"unsupported KZG library","kzg",e)}}}function ud(e,t){let r=e.toString(16);for(;r.length<2;)r="0"+r;return r+=$i(t).substring(4),"0x"+r}function Qi(e){return e==="0x"?null:Ue(e)}function Oo(e,t){try{return bs(e)}catch(r){A(!1,r.message,t,e)}}function zg(e,t){try{if(!Array.isArray(e))throw new Error("authorizationList: invalid array");const r=[];for(let n=0;n<e.length;n++){const s=e[n];if(!Array.isArray(s))throw new Error(`authorization[${n}]: invalid array`);if(s.length!==6)throw new Error(`authorization[${n}]: wrong length`);if(!s[1])throw new Error(`authorization[${n}]: null address`);r.push({address:Qi(s[1]),nonce:Qe(s[2],"nonce"),chainId:Qe(s[0],"chainId"),signature:Rt.from({yParity:ys(s[3],"yParity"),r:Kr(s[4],32),s:Kr(s[5],32)})})}return r}catch(r){A(!1,r.message,t,e)}}function ys(e,t){return e==="0x"?0:Se(e,t)}function Qe(e,t){if(e==="0x")return st;const r=me(e,t);return A(r<=Vg,"value exceeds uint size",t,r),r}function Me(e,t){const r=me(e,"value"),n=tt(r);return A(n.length<=32,"value too large",`tx.${t}`,r),n}function Mo(e){return bs(e).map(t=>[t.address,t.storageKeys])}function Hg(e){return e.map(t=>[Me(t.chainId,"chainId"),t.address,Me(t.nonce,"nonce"),Me(t.signature.yParity,"yParity"),tt(t.signature.r),tt(t.signature.s)])}function $g(e,t){A(Array.isArray(e),`invalid ${t}`,"value",e);for(let r=0;r<e.length;r++)A(qe(e[r],32),"invalid ${ param } hash",`value[${r}]`,e[r]);return e}function Qg(e){const t=Pa(e);A(Array.isArray(t)&&(t.length===9||t.length===6),"invalid field count for legacy transaction","data",e);const r={type:0,nonce:ys(t[0],"nonce"),gasPrice:Qe(t[1],"gasPrice"),gasLimit:Qe(t[2],"gasLimit"),to:Qi(t[3]),value:Qe(t[4],"value"),data:ue(t[5]),chainId:st};if(t.length===6)return r;const n=Qe(t[6],"v"),s=Qe(t[7],"r"),a=Qe(t[8],"s");if(s===st&&a===st)r.chainId=n;else{let o=(n-Ug)/Og;o<st&&(o=st),r.chainId=o,A(o!==st||n===Mg||n===_g,"non-canonical legacy v","v",t[6]),r.signature=Rt.from({r:Kr(t[7],32),s:Kr(t[8],32),v:n})}return r}function qg(e,t){const r=[Me(e.nonce,"nonce"),Me(e.gasPrice||0,"gasPrice"),Me(e.gasLimit,"gasLimit"),e.to||"0x",Me(e.value,"value"),e.data];let n=st;if(e.chainId!=st)n=me(e.chainId,"tx.chainId"),A(!t||t.networkV==null||t.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",t);else if(e.signature){const a=e.signature.legacyChainId;a!=null&&(n=a)}if(!t)return n!==st&&(r.push(tt(n)),r.push("0x"),r.push("0x")),En(r);let s=BigInt(27+t.yParity);return n!==st?s=Rt.getChainIdV(n,t.v):BigInt(t.v)!==s&&A(!1,"tx.chainId/sig.v mismatch","sig",t),r.push(tt(s)),r.push(tt(t.r)),r.push(tt(t.s)),En(r)}function _o(e,t){let r;try{if(r=ys(t[0],"yParity"),r!==0&&r!==1)throw new Error("bad yParity")}catch{A(!1,"invalid yParity","yParity",t[0])}const n=Kr(t[1],32),s=Kr(t[2],32),a=Rt.from({r:n,s,yParity:r});e.signature=a}function Jg(e){const t=Pa(je(e).slice(1));A(Array.isArray(t)&&(t.length===9||t.length===12),"invalid field count for transaction type: 2","data",ue(e));const r={type:2,chainId:Qe(t[0],"chainId"),nonce:ys(t[1],"nonce"),maxPriorityFeePerGas:Qe(t[2],"maxPriorityFeePerGas"),maxFeePerGas:Qe(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:Qe(t[4],"gasLimit"),to:Qi(t[5]),value:Qe(t[6],"value"),data:ue(t[7]),accessList:Oo(t[8],"accessList")};return t.length===9||_o(r,t.slice(9)),r}function Kg(e,t){const r=[Me(e.chainId,"chainId"),Me(e.nonce,"nonce"),Me(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Me(e.maxFeePerGas||0,"maxFeePerGas"),Me(e.gasLimit,"gasLimit"),e.to||"0x",Me(e.value,"value"),e.data,Mo(e.accessList||[])];return t&&(r.push(Me(t.yParity,"yParity")),r.push(tt(t.r)),r.push(tt(t.s))),Ye(["0x02",En(r)])}function Ig(e){const t=Pa(je(e).slice(1));A(Array.isArray(t)&&(t.length===8||t.length===11),"invalid field count for transaction type: 1","data",ue(e));const r={type:1,chainId:Qe(t[0],"chainId"),nonce:ys(t[1],"nonce"),gasPrice:Qe(t[2],"gasPrice"),gasLimit:Qe(t[3],"gasLimit"),to:Qi(t[4]),value:Qe(t[5],"value"),data:ue(t[6]),accessList:Oo(t[7],"accessList")};return t.length===8||_o(r,t.slice(8)),r}function Wg(e,t){const r=[Me(e.chainId,"chainId"),Me(e.nonce,"nonce"),Me(e.gasPrice||0,"gasPrice"),Me(e.gasLimit,"gasLimit"),e.to||"0x",Me(e.value,"value"),e.data,Mo(e.accessList||[])];return t&&(r.push(Me(t.yParity,"recoveryParam")),r.push(tt(t.r)),r.push(tt(t.s))),Ye(["0x01",En(r)])}function Yg(e){let t=Pa(je(e).slice(1)),r="3",n=null;if(t.length===4&&Array.isArray(t[0])){r="3 (network format)";const a=t[1],o=t[2],c=t[3];A(Array.isArray(a),"invalid network format: blobs not an array","fields[1]",a),A(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),A(Array.isArray(c),"invalid network format: proofs not an array","fields[3]",c),A(a.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",t),A(a.length===c.length,"invalid network format: blobs/proofs length mismatch","fields",t),n=[];for(let l=0;l<t[1].length;l++)n.push({data:a[l],commitment:o[l],proof:c[l]});t=t[0]}A(Array.isArray(t)&&(t.length===11||t.length===14),`invalid field count for transaction type: ${r}`,"data",ue(e));const s={type:3,chainId:Qe(t[0],"chainId"),nonce:ys(t[1],"nonce"),maxPriorityFeePerGas:Qe(t[2],"maxPriorityFeePerGas"),maxFeePerGas:Qe(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:Qe(t[4],"gasLimit"),to:Qi(t[5]),value:Qe(t[6],"value"),data:ue(t[7]),accessList:Oo(t[8],"accessList"),maxFeePerBlobGas:Qe(t[9],"maxFeePerBlobGas"),blobVersionedHashes:t[10]};n&&(s.blobs=n),A(s.to!=null,`invalid address for transaction type: ${r}`,"data",e),A(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",e);for(let a=0;a<s.blobVersionedHashes.length;a++)A(qe(s.blobVersionedHashes[a],32),`invalid blobVersionedHash at index ${a}: must be length 32`,"data",e);return t.length===11||_o(s,t.slice(11)),s}function Zg(e,t,r){const n=[Me(e.chainId,"chainId"),Me(e.nonce,"nonce"),Me(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Me(e.maxFeePerGas||0,"maxFeePerGas"),Me(e.gasLimit,"gasLimit"),e.to||oa,Me(e.value,"value"),e.data,Mo(e.accessList||[]),Me(e.maxFeePerBlobGas||0,"maxFeePerBlobGas"),$g(e.blobVersionedHashes||[],"blobVersionedHashes")];return t&&(n.push(Me(t.yParity,"yParity")),n.push(tt(t.r)),n.push(tt(t.s)),r)?Ye(["0x03",En([n,r.map(s=>s.data),r.map(s=>s.commitment),r.map(s=>s.proof)])]):Ye(["0x03",En(n)])}function Xg(e){const t=Pa(je(e).slice(1));A(Array.isArray(t)&&(t.length===10||t.length===13),"invalid field count for transaction type: 4","data",ue(e));const r={type:4,chainId:Qe(t[0],"chainId"),nonce:ys(t[1],"nonce"),maxPriorityFeePerGas:Qe(t[2],"maxPriorityFeePerGas"),maxFeePerGas:Qe(t[3],"maxFeePerGas"),gasPrice:null,gasLimit:Qe(t[4],"gasLimit"),to:Qi(t[5]),value:Qe(t[6],"value"),data:ue(t[7]),accessList:Oo(t[8],"accessList"),authorizationList:zg(t[9],"authorizationList")};return t.length===10||_o(r,t.slice(10)),r}function Lg(e,t){const r=[Me(e.chainId,"chainId"),Me(e.nonce,"nonce"),Me(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Me(e.maxFeePerGas||0,"maxFeePerGas"),Me(e.gasLimit,"gasLimit"),e.to||"0x",Me(e.value,"value"),e.data,Mo(e.accessList||[]),Hg(e.authorizationList||[])];return t&&(r.push(Me(t.yParity,"yParity")),r.push(tt(t.r)),r.push(tt(t.s))),Ye(["0x04",En(r)])}var tr,Ys,Zs,Xs,Ls,Ds,ei,ti,ri,ni,si,ii,Dn,on,hr,cn,ai,oi,Za;const lr=class lr{constructor(){B(this,oi);B(this,tr);B(this,Ys);B(this,Zs);B(this,Xs);B(this,Ls);B(this,Ds);B(this,ei);B(this,ti);B(this,ri);B(this,ni);B(this,si);B(this,ii);B(this,Dn);B(this,on);B(this,hr);B(this,cn);B(this,ai);x(this,tr,null),x(this,Ys,null),x(this,Xs,0),x(this,Ls,st),x(this,Ds,null),x(this,ei,null),x(this,ti,null),x(this,Zs,"0x"),x(this,ri,st),x(this,ni,st),x(this,si,null),x(this,ii,null),x(this,Dn,null),x(this,on,null),x(this,hr,null),x(this,cn,null),x(this,ai,null)}get type(){return f(this,tr)}set type(t){switch(t){case null:x(this,tr,null);break;case 0:case"legacy":x(this,tr,0);break;case 1:case"berlin":case"eip-2930":x(this,tr,1);break;case 2:case"london":case"eip-1559":x(this,tr,2);break;case 3:case"cancun":case"eip-4844":x(this,tr,3);break;case 4:case"pectra":case"eip-7702":x(this,tr,4);break;default:A(!1,"unsupported transaction type","type",t)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const t=f(this,Ys);return t==null&&this.type===3?oa:t}set to(t){x(this,Ys,t==null?null:Ue(t))}get nonce(){return f(this,Xs)}set nonce(t){x(this,Xs,Se(t,"value"))}get gasLimit(){return f(this,Ls)}set gasLimit(t){x(this,Ls,me(t))}get gasPrice(){const t=f(this,Ds);return t==null&&(this.type===0||this.type===1)?st:t}set gasPrice(t){x(this,Ds,t==null?null:me(t,"gasPrice"))}get maxPriorityFeePerGas(){const t=f(this,ei);return t??(this.type===2||this.type===3?st:null)}set maxPriorityFeePerGas(t){x(this,ei,t==null?null:me(t,"maxPriorityFeePerGas"))}get maxFeePerGas(){const t=f(this,ti);return t??(this.type===2||this.type===3?st:null)}set maxFeePerGas(t){x(this,ti,t==null?null:me(t,"maxFeePerGas"))}get data(){return f(this,Zs)}set data(t){x(this,Zs,ue(t))}get value(){return f(this,ri)}set value(t){x(this,ri,me(t,"value"))}get chainId(){return f(this,ni)}set chainId(t){x(this,ni,me(t))}get signature(){return f(this,si)||null}set signature(t){x(this,si,t==null?null:Rt.from(t))}get accessList(){const t=f(this,ii)||null;return t??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(t){x(this,ii,t==null?null:bs(t))}get authorizationList(){const t=f(this,ai)||null;return t==null&&this.type===4?[]:t}set authorizationList(t){x(this,ai,t==null?null:t.map(r=>bh(r)))}get maxFeePerBlobGas(){const t=f(this,Dn);return t==null&&this.type===3?st:t}set maxFeePerBlobGas(t){x(this,Dn,t==null?null:me(t,"maxFeePerBlobGas"))}get blobVersionedHashes(){let t=f(this,on);return t==null&&this.type===3?[]:t}set blobVersionedHashes(t){if(t!=null){A(Array.isArray(t),"blobVersionedHashes must be an Array","value",t),t=t.slice();for(let r=0;r<t.length;r++)A(qe(t[r],32),"invalid blobVersionedHash",`value[${r}]`,t[r])}x(this,on,t)}get blobs(){return f(this,cn)==null?null:f(this,cn).map(t=>Object.assign({},t))}set blobs(t){if(t==null){x(this,cn,null);return}const r=[],n=[];for(let s=0;s<t.length;s++){const a=t[s];if(rl(a)){W(f(this,hr),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=je(a);if(A(o.length<=Do,"blob is too large",`blobs[${s}]`,a),o.length!==Do){const d=new Uint8Array(Do);d.set(o),o=d}const c=f(this,hr).blobToKzgCommitment(o),l=ue(f(this,hr).computeBlobKzgProof(o,c));r.push({data:ue(o),commitment:ue(c),proof:l}),n.push(ud(1,c))}else{const o=ue(a.commitment);r.push({data:ue(a.data),commitment:o,proof:ue(a.proof)}),n.push(ud(1,o))}}x(this,cn,r),x(this,on,n)}get kzg(){return f(this,hr)}set kzg(t){t==null?x(this,hr,null):x(this,hr,Gg(t))}get hash(){return this.signature==null?null:Le(te(this,oi,Za).call(this,!0,!1))}get unsignedHash(){return Le(this.unsignedSerialized)}get from(){return this.signature==null?null:yh(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:ca.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}get serialized(){return te(this,oi,Za).call(this,!0,!0)}get unsignedSerialized(){return te(this,oi,Za).call(this,!1,!1)}inferType(){const t=this.inferTypes();return t.indexOf(2)>=0?2:t.pop()}inferTypes(){const t=this.gasPrice!=null,r=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,s=f(this,Dn)!=null||f(this,on);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&W(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),W(!r||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),W(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const a=[];return this.type!=null?a.push(this.type):this.authorizationList&&this.authorizationList.length?a.push(4):r?a.push(2):t?(a.push(1),n||a.push(0)):n?(a.push(1),a.push(2)):(s&&this.to||(a.push(0),a.push(1),a.push(2)),a.push(3)),a.sort(),a}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return lr.from(this)}toJSON(){const t=r=>r==null?null:r.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:t(this.gasLimit),gasPrice:t(this.gasPrice),maxPriorityFeePerGas:t(this.maxPriorityFeePerGas),maxFeePerGas:t(this.maxFeePerGas),value:t(this.value),chainId:t(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(t){if(t==null)return new lr;if(typeof t=="string"){const n=je(t);if(n[0]>=127)return lr.from(Qg(n));switch(n[0]){case 1:return lr.from(Ig(n));case 2:return lr.from(Jg(n));case 3:return lr.from(Yg(n));case 4:return lr.from(Xg(n))}W(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const r=new lr;return t.type!=null&&(r.type=t.type),t.to!=null&&(r.to=t.to),t.nonce!=null&&(r.nonce=t.nonce),t.gasLimit!=null&&(r.gasLimit=t.gasLimit),t.gasPrice!=null&&(r.gasPrice=t.gasPrice),t.maxPriorityFeePerGas!=null&&(r.maxPriorityFeePerGas=t.maxPriorityFeePerGas),t.maxFeePerGas!=null&&(r.maxFeePerGas=t.maxFeePerGas),t.maxFeePerBlobGas!=null&&(r.maxFeePerBlobGas=t.maxFeePerBlobGas),t.data!=null&&(r.data=t.data),t.value!=null&&(r.value=t.value),t.chainId!=null&&(r.chainId=t.chainId),t.signature!=null&&(r.signature=Rt.from(t.signature)),t.accessList!=null&&(r.accessList=t.accessList),t.authorizationList!=null&&(r.authorizationList=t.authorizationList),t.blobVersionedHashes!=null&&(r.blobVersionedHashes=t.blobVersionedHashes),t.kzg!=null&&(r.kzg=t.kzg),t.blobs!=null&&(r.blobs=t.blobs),t.hash!=null&&(A(r.isSigned(),"unsigned transaction cannot define '.hash'","tx",t),A(r.hash===t.hash,"hash mismatch","tx",t)),t.from!=null&&(A(r.isSigned(),"unsigned transaction cannot define '.from'","tx",t),A(r.from.toLowerCase()===(t.from||"").toLowerCase(),"from mismatch","tx",t)),r}};tr=new WeakMap,Ys=new WeakMap,Zs=new WeakMap,Xs=new WeakMap,Ls=new WeakMap,Ds=new WeakMap,ei=new WeakMap,ti=new WeakMap,ri=new WeakMap,ni=new WeakMap,si=new WeakMap,ii=new WeakMap,Dn=new WeakMap,on=new WeakMap,hr=new WeakMap,cn=new WeakMap,ai=new WeakMap,oi=new WeakSet,Za=function(t,r){W(!t||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=t?this.signature:null;switch(this.inferType()){case 0:return qg(this,n);case 1:return Wg(this,n);case 2:return Kg(this,n);case 3:return Zg(this,n,r?this.blobs:null);case 4:return Lg(this,n)}W(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let uo=lr;function fs(e){return Le(Ar(e))}var Dg="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";const hd=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),fd=4;function ex(e){let t=0;function r(){return e[t++]<<8|e[t++]}let n=r(),s=1,a=[0,1];for(let O=1;O<n;O++)a.push(s+=r());let o=r(),c=t;t+=o;let l=0,d=0;function u(){return l==0&&(d=d<<8|e[t++],l=8),d>>--l&1}const h=31,m=2**h,p=m>>>1,b=p>>1,g=m-1;let v=0;for(let O=0;O<h;O++)v=v<<1|u();let N=[],V=0,E=m;for(;;){let O=Math.floor(((v-V+1)*s-1)/E),Z=0,q=n;for(;q-Z>1;){let ne=Z+q>>>1;O<a[ne]?q=ne:Z=ne}if(Z==0)break;N.push(Z);let R=V+Math.floor(E*a[Z]/s),K=V+Math.floor(E*a[Z+1]/s)-1;for(;((R^K)&p)==0;)v=v<<1&g|u(),R=R<<1&g,K=K<<1&g|1;for(;R&~K&b;)v=v&p|v<<1&g>>>1|u(),R=R<<1^p,K=(K^p)<<1|p|1;V=R,E=1+K-R}let Y=n-4;return N.map(O=>{switch(O-Y){case 3:return Y+65792+(e[c++]<<16|e[c++]<<8|e[c++]);case 2:return Y+256+(e[c++]<<8|e[c++]);case 1:return Y+e[c++];default:return O-1}})}function tx(e){let t=0;return()=>e[t++]}function wh(e){return tx(ex(rx(e)))}function rx(e){let t=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((s,a)=>t[s.charCodeAt(0)]=a);let r=e.length,n=new Uint8Array(6*r>>3);for(let s=0,a=0,o=0,c=0;s<r;s++)c=c<<6|t[e.charCodeAt(s)],o+=6,o>=8&&(n[a++]=c>>(o-=8));return n}function nx(e){return e&1?~e>>1:e>>1}function sx(e,t){let r=Array(e);for(let n=0,s=0;n<e;n++)r[n]=s+=nx(t());return r}function la(e,t=0){let r=[];for(;;){let n=e(),s=e();if(!s)break;t+=n;for(let a=0;a<s;a++)r.push(t+a);t+=s+1}return r}function Nh(e){return da(()=>{let t=la(e);if(t.length)return t})}function Ah(e){let t=[];for(;;){let r=e();if(r==0)break;t.push(ix(r,e))}for(;;){let r=e()-1;if(r<0)break;t.push(ax(r,e))}return t.flat()}function da(e){let t=[];for(;;){let r=e(t.length);if(!r)break;t.push(r)}return t}function vh(e,t,r){let n=Array(e).fill().map(()=>[]);for(let s=0;s<t;s++)sx(e,r).forEach((a,o)=>n[o].push(a));return n}function ix(e,t){let r=1+t(),n=t(),s=da(t);return vh(s.length,1+e,t).flatMap((o,c)=>{let[l,...d]=o;return Array(s[c]).fill().map((u,h)=>{let m=h*n;return[l+h*r,d.map(p=>p+m)]})})}function ax(e,t){let r=1+t();return vh(r,1+e,t).map(s=>[s[0],s.slice(1)])}function ox(e){let t=[],r=la(e);return s(n([]),[]),t;function n(a){let o=e(),c=da(()=>{let l=la(e).map(d=>r[d]);if(l.length)return n(l)});return{S:o,B:c,Q:a}}function s({S:a,B:o},c,l){if(!(a&4&&l===c[c.length-1])){a&2&&(l=c[c.length-1]),a&1&&t.push(c);for(let d of o)for(let u of d.Q)s(d,[...c,u],l)}}}function cx(e){return e.toString(16).toUpperCase().padStart(2,"0")}function Eh(e){return`{${cx(e)}}`}function lx(e){let t=[];for(let r=0,n=e.length;r<n;){let s=e.codePointAt(r);r+=s<65536?1:2,t.push(s)}return t}function Mi(e){let r=e.length;if(r<4096)return String.fromCodePoint(...e);let n=[];for(let s=0;s<r;)n.push(String.fromCodePoint(...e.slice(s,s+=4096)));return n.join("")}function dx(e,t){let r=e.length,n=r-t.length;for(let s=0;n==0&&s<r;s++)n=e[s]-t[s];return n}var ux="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";const ua=44032,ho=4352,fo=4449,mo=4519,kh=19,Ch=21,_i=28,po=Ch*_i,hx=kh*po,fx=ua+hx,mx=ho+kh,px=fo+Ch,gx=mo+_i;function Di(e){return e>>24&255}function Th(e){return e&16777215}let Fc,md,Rc,Xa;function xx(){let e=wh(ux);Fc=new Map(Nh(e).flatMap((t,r)=>t.map(n=>[n,r+1<<24]))),md=new Set(la(e)),Rc=new Map,Xa=new Map;for(let[t,r]of Ah(e)){if(!md.has(t)&&r.length==2){let[n,s]=r,a=Xa.get(n);a||(a=new Map,Xa.set(n,a)),a.set(s,t)}Rc.set(t,r.reverse())}}function jh(e){return e>=ua&&e<fx}function bx(e,t){if(e>=ho&&e<mx&&t>=fo&&t<px)return ua+(e-ho)*po+(t-fo)*_i;if(jh(e)&&t>mo&&t<gx&&(e-ua)%_i==0)return e+(t-mo);{let r=Xa.get(e);return r&&(r=r.get(t),r)?r:-1}}function Sh(e){Fc||xx();let t=[],r=[],n=!1;function s(a){let o=Fc.get(a);o&&(n=!0,a|=o),t.push(a)}for(let a of e)for(;;){if(a<128)t.push(a);else if(jh(a)){let o=a-ua,c=o/po|0,l=o%po/_i|0,d=o%_i;s(ho+c),s(fo+l),d>0&&s(mo+d)}else{let o=Rc.get(a);o?r.push(...o):s(a)}if(!r.length)break;a=r.pop()}if(n&&t.length>1){let a=Di(t[0]);for(let o=1;o<t.length;o++){let c=Di(t[o]);if(c==0||a<=c){a=c;continue}let l=o-1;for(;;){let d=t[l+1];if(t[l+1]=t[l],t[l]=d,!l||(a=Di(t[--l]),a<=c))break}a=Di(t[o])}}return t}function yx(e){let t=[],r=[],n=-1,s=0;for(let a of e){let o=Di(a),c=Th(a);if(n==-1)o==0?n=c:t.push(c);else if(s>0&&s>=o)o==0?(t.push(n,...r),r.length=0,n=c):r.push(c),s=o;else{let l=bx(n,c);l>=0?n=l:s==0&&o==0?(t.push(n),n=c):(r.push(c),s=o)}}return n>=0&&t.push(n,...r),t}function Fh(e){return Sh(e).map(Th)}function wx(e){return yx(Sh(e))}const pd=45,Rh=".",Ph=65039,Bh=1,go=e=>Array.from(e);function ha(e,t){return e.P.has(t)||e.Q.has(t)}class Nx extends Array{get is_emoji(){return!0}}let Pc,Oh,zn,Bc,Mh,Us,ec,Cs,Pn,gd,Oc;function ml(){if(Pc)return;let e=wh(Dg);const t=()=>la(e),r=()=>new Set(t()),n=(u,h)=>h.forEach(m=>u.add(m));Pc=new Map(Ah(e)),Oh=r(),zn=t(),Bc=new Set(t().map(u=>zn[u])),zn=new Set(zn),Mh=r(),r();let s=Nh(e),a=e();const o=()=>{let u=new Set;return t().forEach(h=>n(u,s[h])),n(u,t()),u};Us=da(u=>{let h=da(e).map(m=>m+96);if(h.length){let m=u>=a;h[0]-=32,h=Mi(h),m&&(h=`Restricted[${h}]`);let p=o(),b=o(),g=!e();return{N:h,P:p,Q:b,M:g,R:m}}}),ec=r(),Cs=new Map;let c=t().concat(go(ec)).sort((u,h)=>u-h);c.forEach((u,h)=>{let m=e(),p=c[h]=m?c[h-m]:{V:[],M:new Map};p.V.push(u),ec.has(u)||Cs.set(u,p)});for(let{V:u,M:h}of new Set(Cs.values())){let m=[];for(let b of u){let g=Us.filter(N=>ha(N,b)),v=m.find(({G:N})=>g.some(V=>N.has(V)));v||(v={G:new Set,V:[]},m.push(v)),v.V.push(b),n(v.G,g)}let p=m.flatMap(b=>go(b.G));for(let{G:b,V:g}of m){let v=new Set(p.filter(N=>!b.has(N)));for(let N of g)h.set(N,v)}}Pn=new Set;let l=new Set;const d=u=>Pn.has(u)?l.add(u):Pn.add(u);for(let u of Us){for(let h of u.P)d(h);for(let h of u.Q)d(h)}for(let u of Pn)!Cs.has(u)&&!l.has(u)&&Cs.set(u,Bh);n(Pn,Fh(Pn)),gd=ox(e).map(u=>Nx.from(u)).sort(dx),Oc=new Map;for(let u of gd){let h=[Oc];for(let m of u){let p=h.map(b=>{let g=b.get(m);return g||(g=new Map,b.set(m,g)),g});m===Ph?h.push(...p):h=p}for(let m of h)m.V=u}}function pl(e){return(_h(e)?"":`${gl(Uo([e]))} `)+Eh(e)}function gl(e){return`"${e}"â€Ž`}function Ax(e){if(e.length>=4&&e[2]==pd&&e[3]==pd)throw new Error(`invalid label extension: "${Mi(e.slice(0,4))}"`)}function vx(e){for(let r=e.lastIndexOf(95);r>0;)if(e[--r]!==95)throw new Error("underscore allowed only at start")}function Ex(e){let t=e[0],r=hd.get(t);if(r)throw na(`leading ${r}`);let n=e.length,s=-1;for(let a=1;a<n;a++){t=e[a];let o=hd.get(t);if(o){if(s==a)throw na(`${r} + ${o}`);s=a+1,r=o}}if(s==n)throw na(`trailing ${r}`)}function Uo(e,t=1/0,r=Eh){let n=[];kx(e[0])&&n.push("â—Œ"),e.length>t&&(t>>=1,e=[...e.slice(0,t),8230,...e.slice(-t)]);let s=0,a=e.length;for(let o=0;o<a;o++){let c=e[o];_h(c)&&(n.push(Mi(e.slice(s,o))),n.push(r(c)),s=o+1)}return n.push(Mi(e.slice(s,a))),n.join("")}function kx(e){return ml(),zn.has(e)}function _h(e){return ml(),Mh.has(e)}function Cx(e){return Fx(Tx(e,wx,Bx))}function Tx(e,t,r){if(!e)return[];ml();let n=0;return e.split(Rh).map(s=>{let a=lx(s),o={input:a,offset:n};n+=a.length+1;try{let c=o.tokens=Px(a,t,r),l=c.length,d;if(!l)throw new Error("empty label");let u=o.output=c.flat();if(vx(u),!(o.emoji=l>1||c[0].is_emoji)&&u.every(m=>m<128))Ax(u),d="ASCII";else{let m=c.flatMap(p=>p.is_emoji?[]:p);if(!m.length)d="Emoji";else{if(zn.has(u[0]))throw na("leading combining mark");for(let g=1;g<l;g++){let v=c[g];if(!v.is_emoji&&zn.has(v[0]))throw na(`emoji + combining mark: "${Mi(c[g-1])} + ${Uo([v[0]])}"`)}Ex(u);let p=go(new Set(m)),[b]=Sx(p);Rx(b,m),jx(b,p),d=b.N}}o.type=d}catch(c){o.error=c}return o})}function jx(e,t){let r,n=[];for(let s of t){let a=Cs.get(s);if(a===Bh)return;if(a){let o=a.M.get(s);if(r=r?r.filter(c=>o.has(c)):go(o),!r.length)return}else n.push(s)}if(r){for(let s of r)if(n.every(a=>ha(s,a)))throw new Error(`whole-script confusable: ${e.N}/${s.N}`)}}function Sx(e){let t=Us;for(let r of e){let n=t.filter(s=>ha(s,r));if(!n.length)throw Us.some(s=>ha(s,r))?Vh(t[0],r):Uh(r);if(t=n,n.length==1)break}return t}function Fx(e){return e.map(({input:t,error:r,output:n})=>{if(r){let s=r.message;throw new Error(e.length==1?s:`Invalid label ${gl(Uo(t,63))}: ${s}`)}return Mi(n)}).join(Rh)}function Uh(e){return new Error(`disallowed character: ${pl(e)}`)}function Vh(e,t){let r=pl(t),n=Us.find(s=>s.P.has(t));return n&&(r=`${n.N} ${r}`),new Error(`illegal mixture: ${e.N} + ${r}`)}function na(e){return new Error(`illegal placement: ${e}`)}function Rx(e,t){for(let r of t)if(!ha(e,r))throw Vh(e,r);if(e.M){let r=Fh(t);for(let n=1,s=r.length;n<s;n++)if(Bc.has(r[n])){let a=n+1;for(let o;a<s&&Bc.has(o=r[a]);a++)for(let c=n;c<a;c++)if(r[c]==o)throw new Error(`duplicate non-spacing marks: ${pl(o)}`);if(a-n>fd)throw new Error(`excessive non-spacing marks: ${gl(Uo(r.slice(n-1,a)))} (${a-n}/${fd})`);n=a}}}function Px(e,t,r){let n=[],s=[];for(e=e.slice().reverse();e.length;){let a=Ox(e);if(a)s.length&&(n.push(t(s)),s=[]),n.push(r(a));else{let o=e.pop();if(Pn.has(o))s.push(o);else{let c=Pc.get(o);if(c)s.push(...c);else if(!Oh.has(o))throw Uh(o)}}}return s.length&&n.push(t(s)),n}function Bx(e){return e.filter(t=>t!=Ph)}function Ox(e,t){let r=Oc,n,s=e.length;for(;s&&(r=r.get(e[--s]),!!r);){let{V:a}=r;a&&(n=a,e.length=s)}return n}const Gh=new Uint8Array(32);Gh.fill(0);function xd(e){return A(e.length!==0,"invalid ENS name; empty component","comp",e),e}function xl(e){const t=Ar(Mx(e)),r=[];if(e.length===0)return r;let n=0;for(let s=0;s<t.length;s++)t[s]===46&&(r.push(xd(t.slice(n,s))),n=s+1);return A(n<t.length,"invalid ENS name; empty component","name",e),r.push(xd(t.slice(n))),r}function Mx(e){try{if(e.length===0)throw new Error("empty label");return Cx(e)}catch(t){A(!1,`invalid ENS name (${t.message})`,"name",e)}}function zy(e){try{return xl(e).length!==0}catch{}return!1}function Mc(e){A(typeof e=="string","invalid ENS name; not a string","name",e),A(e.length,"invalid ENS name (empty label)","name",e);let t=Gh;const r=xl(e);for(;r.length;)t=Le(Ye([t,Le(r.pop())]));return ue(t)}function _x(e,t){const r=t??63;return A(r<=255,"DNS encoded label cannot exceed 255","length",r),ue(Ye(xl(e).map(n=>{A(n.length<=r,`label ${JSON.stringify(e)} exceeds ${r} bytes`,"name",e);const s=new Uint8Array(n.length+1);return s.set(n,1),s[0]=s.length-1,s})))+"00"}const zh=new Uint8Array(32);zh.fill(0);const Ux=BigInt(-1),Hh=BigInt(0),$h=BigInt(1),Vx=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Gx(e){const t=je(e),r=t.length%32;return r?Ye([t,zh.slice(r)]):ue(t)}const zx=vn($h,32),Hx=vn(Hh,32),bd={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},tc=["name","version","chainId","verifyingContract","salt"];function yd(e){return function(t){return A(typeof t=="string",`invalid domain value for ${JSON.stringify(e)}`,`domain.${e}`,t),t}}const $x={name:yd("name"),version:yd("version"),chainId:function(e){const t=me(e,"domain.chainId");return A(t>=0,"invalid chain ID","domain.chainId",e),Number.isSafeInteger(t)?Number(t):sr(t)},verifyingContract:function(e){try{return Ue(e).toLowerCase()}catch{}A(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",e)},salt:function(e){const t=je(e,"domain.salt");return A(t.length===32,'invalid domain value "salt"',"domain.salt",e),ue(t)}};function rc(e){{const t=e.match(/^(u?)int(\d+)$/);if(t){const r=t[1]==="",n=parseInt(t[2]);A(n%8===0&&n!==0&&n<=256&&t[2]===String(n),"invalid numeric width","type",e);const s=Vn(Vx,r?n-1:n),a=r?(s+$h)*Ux:Hh;return function(o){const c=me(o,"value");return A(c>=a&&c<=s,`value out-of-bounds for ${e}`,"value",c),vn(r?Au(c,256):c,32)}}}{const t=e.match(/^bytes(\d+)$/);if(t){const r=parseInt(t[1]);return A(r!==0&&r<=32&&t[1]===String(r),"invalid bytes width","type",e),function(n){const s=je(n);return A(s.length===r,`invalid length for ${e}`,"value",n),Gx(n)}}}switch(e){case"address":return function(t){return Kr(Ue(t),32)};case"bool":return function(t){return t?zx:Hx};case"bytes":return function(t){return Le(t)};case"string":return function(t){return fs(t)}}return null}function wd(e,t){return`${e}(${t.map(({name:r,type:n})=>n+" "+r).join(",")})`}function Ja(e){const t=e.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return t?{base:t[1],index:t[2]+t[4],array:{base:t[1],prefix:t[1]+t[2],count:t[5]?parseInt(t[5]):-1}}:{base:e}}var Na,Mr,ci,No,Qh;const $t=class $t{constructor(t){B(this,No);T(this,"primaryType");B(this,Na);B(this,Mr);B(this,ci);x(this,Mr,new Map),x(this,ci,new Map);const r=new Map,n=new Map,s=new Map,a={};Object.keys(t).forEach(l=>{a[l]=t[l].map(({name:d,type:u})=>{let{base:h,index:m}=Ja(u);return h==="int"&&!t.int&&(h="int256"),h==="uint"&&!t.uint&&(h="uint256"),{name:d,type:h+(m||"")}}),r.set(l,new Set),n.set(l,[]),s.set(l,new Set)}),x(this,Na,JSON.stringify(a));for(const l in a){const d=new Set;for(const u of a[l]){A(!d.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(l)}`,"types",t),d.add(u.name);const h=Ja(u.type).base;A(h!==l,`circular type reference to ${JSON.stringify(h)}`,"types",t),!rc(h)&&(A(n.has(h),`unknown type ${JSON.stringify(h)}`,"types",t),n.get(h).push(l),r.get(l).add(h))}}const o=Array.from(n.keys()).filter(l=>n.get(l).length===0);A(o.length!==0,"missing primary type","types",t),A(o.length===1,`ambiguous primary types or unused types: ${o.map(l=>JSON.stringify(l)).join(", ")}`,"types",t),ve(this,{primaryType:o[0]});function c(l,d){A(!d.has(l),`circular type reference to ${JSON.stringify(l)}`,"types",t),d.add(l);for(const u of r.get(l))if(n.has(u)){c(u,d);for(const h of d)s.get(h).add(u)}d.delete(l)}c(this.primaryType,new Set);for(const[l,d]of s){const u=Array.from(d);u.sort(),f(this,Mr).set(l,wd(l,a[l])+u.map(h=>wd(h,a[h])).join(""))}}get types(){return JSON.parse(f(this,Na))}getEncoder(t){let r=f(this,ci).get(t);return r||(r=te(this,No,Qh).call(this,t),f(this,ci).set(t,r)),r}encodeType(t){const r=f(this,Mr).get(t);return A(r,`unknown type: ${JSON.stringify(t)}`,"name",t),r}encodeData(t,r){return this.getEncoder(t)(r)}hashStruct(t,r){return Le(this.encodeData(t,r))}encode(t){return this.encodeData(this.primaryType,t)}hash(t){return this.hashStruct(this.primaryType,t)}_visit(t,r,n){if(rc(t))return n(t,r);const s=Ja(t).array;if(s)return A(s.count===-1||s.count===r.length,`array length mismatch; expected length ${s.count}`,"value",r),r.map(o=>this._visit(s.prefix,o,n));const a=this.types[t];if(a)return a.reduce((o,{name:c,type:l})=>(o[c]=this._visit(l,r[c],n),o),{});A(!1,`unknown type: ${t}`,"type",t)}visit(t,r){return this._visit(this.primaryType,t,r)}static from(t){return new $t(t)}static getPrimaryType(t){return $t.from(t).primaryType}static hashStruct(t,r,n){return $t.from(r).hashStruct(t,n)}static hashDomain(t){const r=[];for(const n in t){if(t[n]==null)continue;const s=bd[n];A(s,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",t),r.push({name:n,type:s})}return r.sort((n,s)=>tc.indexOf(n.name)-tc.indexOf(s.name)),$t.hashStruct("EIP712Domain",{EIP712Domain:r},t)}static encode(t,r,n){return Ye(["0x1901",$t.hashDomain(t),$t.from(r).hash(n)])}static hash(t,r,n){return Le($t.encode(t,r,n))}static async resolveNames(t,r,n,s){t=Object.assign({},t);for(const c in t)t[c]==null&&delete t[c];const a={};t.verifyingContract&&!qe(t.verifyingContract,20)&&(a[t.verifyingContract]="0x");const o=$t.from(r);o.visit(n,(c,l)=>(c==="address"&&!qe(l,20)&&(a[l]="0x"),l));for(const c in a)a[c]=await s(c);return t.verifyingContract&&a[t.verifyingContract]&&(t.verifyingContract=a[t.verifyingContract]),n=o.visit(n,(c,l)=>c==="address"&&a[l]?a[l]:l),{domain:t,value:n}}static getPayload(t,r,n){$t.hashDomain(t);const s={},a=[];tc.forEach(l=>{const d=t[l];d!=null&&(s[l]=$x[l](d),a.push({name:l,type:bd[l]}))});const o=$t.from(r);r=o.types;const c=Object.assign({},r);return A(c.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",r),c.EIP712Domain=a,o.encode(n),{types:c,domain:s,primaryType:o.primaryType,message:o.visit(n,(l,d)=>{if(l.match(/^bytes(\d*)/))return ue(je(d));if(l.match(/^u?int/))return me(d).toString();switch(l){case"address":return d.toLowerCase();case"bool":return!!d;case"string":return A(typeof d=="string","invalid string","value",d),d}A(!1,"unsupported type","type",l)})}}};Na=new WeakMap,Mr=new WeakMap,ci=new WeakMap,No=new WeakSet,Qh=function(t){{const s=rc(t);if(s)return s}const r=Ja(t).array;if(r){const s=r.prefix,a=this.getEncoder(s);return o=>{A(r.count===-1||r.count===o.length,`array length mismatch; expected length ${r.count}`,"value",o);let c=o.map(a);return f(this,Mr).has(s)&&(c=c.map(Le)),Le(Ye(c))}}const n=this.types[t];if(n){const s=fs(f(this,Mr).get(t));return a=>{const o=n.map(({name:c,type:l})=>{const d=this.getEncoder(l)(a[c]);return f(this,Mr).has(l)?Le(d):d});return o.unshift(s),Ye(o)}}A(!1,`unknown type: ${t}`,"type",t)};let fa=$t;function Hy(e,t,r,n){return yh(fa.hash(e,t,r),n)}function vt(e){const t=new Set;return e.forEach(r=>t.add(r)),Object.freeze(t)}const Qx="external public payable override",qx=vt(Qx.split(" ")),qh="constant external internal payable private public pure view override",Jx=vt(qh.split(" ")),Jh="constructor error event fallback function receive struct",Kh=vt(Jh.split(" ")),Ih="calldata memory storage payable indexed",Kx=vt(Ih.split(" ")),Ix="tuple returns",Wx=[Jh,Ih,Ix,qh].join(" "),Yx=vt(Wx.split(" ")),Zx={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Xx=new RegExp("^(\\s*)"),Lx=new RegExp("^([0-9]+)"),Dx=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Wh=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Yh=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var ct,rr,Aa,_c;const Ao=class Ao{constructor(t){B(this,Aa);B(this,ct);B(this,rr);x(this,ct,0),x(this,rr,t.slice())}get offset(){return f(this,ct)}get length(){return f(this,rr).length-f(this,ct)}clone(){return new Ao(f(this,rr))}reset(){x(this,ct,0)}popKeyword(t){const r=this.peek();if(r.type!=="KEYWORD"||!t.has(r.text))throw new Error(`expected keyword ${r.text}`);return this.pop().text}popType(t){if(this.peek().type!==t){const r=this.peek();throw new Error(`expected ${t}; got ${r.type} ${JSON.stringify(r.text)}`)}return this.pop().text}popParen(){const t=this.peek();if(t.type!=="OPEN_PAREN")throw new Error("bad start");const r=te(this,Aa,_c).call(this,f(this,ct)+1,t.match+1);return x(this,ct,t.match+1),r}popParams(){const t=this.peek();if(t.type!=="OPEN_PAREN")throw new Error("bad start");const r=[];for(;f(this,ct)<t.match-1;){const n=this.peek().linkNext;r.push(te(this,Aa,_c).call(this,f(this,ct)+1,n)),x(this,ct,n)}return x(this,ct,t.match+1),r}peek(){if(f(this,ct)>=f(this,rr).length)throw new Error("out-of-bounds");return f(this,rr)[f(this,ct)]}peekKeyword(t){const r=this.peekType("KEYWORD");return r!=null&&t.has(r)?r:null}peekType(t){if(this.length===0)return null;const r=this.peek();return r.type===t?r.text:null}pop(){const t=this.peek();return Ii(this,ct)._++,t}toString(){const t=[];for(let r=f(this,ct);r<f(this,rr).length;r++){const n=f(this,rr)[r];t.push(`${n.type}:${n.text}`)}return`<TokenString ${t.join(" ")}>`}};ct=new WeakMap,rr=new WeakMap,Aa=new WeakSet,_c=function(t=0,r=0){return new Ao(f(this,rr).slice(t,r).map(n=>Object.freeze(Object.assign({},n,{match:n.match-t,linkBack:n.linkBack-t,linkNext:n.linkNext-t}))))};let ar=Ao;function Cn(e){const t=[],r=o=>{const c=a<e.length?JSON.stringify(e[a]):"$EOI";throw new Error(`invalid token ${c} at ${a}: ${o}`)};let n=[],s=[],a=0;for(;a<e.length;){let o=e.substring(a),c=o.match(Xx);c&&(a+=c[1].length,o=e.substring(a));const l={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:a,value:-1};t.push(l);let d=Zx[o[0]]||"";if(d){if(l.type=d,l.text=o[0],a++,d==="OPEN_PAREN")n.push(t.length-1),s.push(t.length-1);else if(d=="CLOSE_PAREN")n.length===0&&r("no matching open bracket"),l.match=n.pop(),t[l.match].match=t.length-1,l.depth--,l.linkBack=s.pop(),t[l.linkBack].linkNext=t.length-1;else if(d==="COMMA")l.linkBack=s.pop(),t[l.linkBack].linkNext=t.length-1,s.push(t.length-1);else if(d==="OPEN_BRACKET")l.type="BRACKET";else if(d==="CLOSE_BRACKET"){let u=t.pop().text;if(t.length>0&&t[t.length-1].type==="NUMBER"){const h=t.pop().text;u=h+u,t[t.length-1].value=Se(h)}if(t.length===0||t[t.length-1].type!=="BRACKET")throw new Error("missing opening bracket");t[t.length-1].text+=u}continue}if(c=o.match(Dx),c){if(l.text=c[1],a+=l.text.length,Yx.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(Yh)){l.type="TYPE";continue}l.type="ID";continue}if(c=o.match(Lx),c){l.text=c[1],l.type="NUMBER",a+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${a}`)}return new ar(t.map(o=>Object.freeze(o)))}function Nd(e,t){let r=[];for(const n in t.keys())e.has(n)&&r.push(n);if(r.length>1)throw new Error(`conflicting types: ${r.join(", ")}`)}function Vo(e,t){if(t.peekKeyword(Kh)){const r=t.pop().text;if(r!==e)throw new Error(`expected ${e}, got ${r}`)}return t.popType("ID")}function Wr(e,t){const r=new Set;for(;;){const n=e.peekType("KEYWORD");if(n==null||t&&!t.has(n))break;if(e.pop(),r.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);r.add(n)}return Object.freeze(r)}function Zh(e){let t=Wr(e,Jx);return Nd(t,vt("constant payable nonpayable".split(" "))),Nd(t,vt("pure view payable nonpayable".split(" "))),t.has("view")?"view":t.has("pure")?"pure":t.has("payable")?"payable":t.has("nonpayable")?"nonpayable":t.has("constant")?"view":"nonpayable"}function Jr(e,t){return e.popParams().map(r=>ut.from(r,t))}function Xh(e){if(e.peekType("AT")){if(e.pop(),e.peekType("NUMBER"))return me(e.pop().text);throw new Error("invalid gas")}return null}function ms(e){if(e.length)throw new Error(`unexpected tokens at offset ${e.offset}: ${e.toString()}`)}const eb=new RegExp(/^(.*)\[([0-9]*)\]$/);function Ad(e){const t=e.match(Yh);if(A(t,"invalid type","type",e),e==="uint")return"uint256";if(e==="int")return"int256";if(t[2]){const r=parseInt(t[2]);A(r!==0&&r<=32,"invalid bytes length","type",e)}else if(t[3]){const r=parseInt(t[3]);A(r!==0&&r<=256&&r%8===0,"invalid numeric width","type",e)}return e}const We={},Pt=Symbol.for("_ethers_internal"),vd="_ParamTypeInternal",Ed="_ErrorInternal",kd="_EventInternal",Cd="_ConstructorInternal",Td="_FallbackInternal",jd="_FunctionInternal",Sd="_StructInternal";var li,La;const Qt=class Qt{constructor(t,r,n,s,a,o,c,l){B(this,li);T(this,"name");T(this,"type");T(this,"baseType");T(this,"indexed");T(this,"components");T(this,"arrayLength");T(this,"arrayChildren");if(Ra(t,We,"ParamType"),Object.defineProperty(this,Pt,{value:vd}),o&&(o=Object.freeze(o.slice())),s==="array"){if(c==null||l==null)throw new Error("")}else if(c!=null||l!=null)throw new Error("");if(s==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");ve(this,{name:r,type:n,baseType:s,indexed:a,components:o,arrayLength:c,arrayChildren:l})}format(t){if(t==null&&(t="sighash"),t==="json"){const n=this.name||"";if(this.isArray()){const a=JSON.parse(this.arrayChildren.format("json"));return a.name=n,a.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(a)}const s={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(s.indexed=this.indexed),this.isTuple()&&(s.components=this.components.map(a=>JSON.parse(a.format(t)))),JSON.stringify(s)}let r="";return this.isArray()?(r+=this.arrayChildren.format(t),r+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?r+="("+this.components.map(n=>n.format(t)).join(t==="full"?", ":",")+")":r+=this.type,t!=="sighash"&&(this.indexed===!0&&(r+=" indexed"),t==="full"&&this.name&&(r+=" "+this.name)),r}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(t,r){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return t.map(s=>n.arrayChildren.walk(s,r))}if(this.isTuple()){if(!Array.isArray(t))throw new Error("invalid tuple value");if(t.length!==this.components.length)throw new Error("array is wrong length");const n=this;return t.map((s,a)=>n.components[a].walk(s,r))}return r(this.type,t)}async walkAsync(t,r){const n=[],s=[t];return te(this,li,La).call(this,n,t,r,a=>{s[0]=a}),n.length&&await Promise.all(n),s[0]}static from(t,r){if(Qt.isParamType(t))return t;if(typeof t=="string")try{return Qt.from(Cn(t),r)}catch{A(!1,"invalid param type","obj",t)}else if(t instanceof ar){let c="",l="",d=null;Wr(t,vt(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(l="tuple",d=t.popParams().map(g=>Qt.from(g)),c=`tuple(${d.map(g=>g.format()).join(",")})`):(c=Ad(t.popType("TYPE")),l=c);let u=null,h=null;for(;t.length&&t.peekType("BRACKET");){const g=t.pop();u=new Qt(We,"",c,l,null,d,h,u),h=g.value,c+=g.text,l="array",d=null}let m=null;if(Wr(t,Kx).has("indexed")){if(!r)throw new Error("");m=!0}const b=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new Qt(We,b,c,l,m,d,h,u)}const n=t.name;A(!n||typeof n=="string"&&n.match(Wh),"invalid name","obj.name",n);let s=t.indexed;s!=null&&(A(r,"parameter cannot be indexed","obj.indexed",t.indexed),s=!!s);let a=t.type,o=a.match(eb);if(o){const c=parseInt(o[2]||"-1"),l=Qt.from({type:o[1],components:t.components});return new Qt(We,n||"",a,"array",s,null,c,l)}if(a==="tuple"||a.startsWith("tuple(")||a.startsWith("(")){const c=t.components!=null?t.components.map(d=>Qt.from(d)):null;return new Qt(We,n||"",a,"tuple",s,c,null,null)}return a=Ad(t.type),new Qt(We,n||"",a,a,s,null,null,null)}static isParamType(t){return t&&t[Pt]===vd}};li=new WeakSet,La=function(t,r,n,s){if(this.isArray()){if(!Array.isArray(r))throw new Error("invalid array value");if(this.arrayLength!==-1&&r.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,c=r.slice();c.forEach((l,d)=>{var u;te(u=o,li,La).call(u,t,l,n,h=>{c[d]=h})}),s(c);return}if(this.isTuple()){const o=this.components;let c;if(Array.isArray(r))c=r.slice();else{if(r==null||typeof r!="object")throw new Error("invalid tuple value");c=o.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in r))throw new Error(`missing value for component ${l.name}`);return r[l.name]})}if(c.length!==this.components.length)throw new Error("array is wrong length");c.forEach((l,d)=>{var u;te(u=o[d],li,La).call(u,t,l,n,h=>{c[d]=h})}),s(c);return}const a=n(this.type,r);a.then?t.push(async function(){s(await a)}()):s(a)};let ut=Qt;class ps{constructor(t,r,n){T(this,"type");T(this,"inputs");Ra(t,We,"Fragment"),n=Object.freeze(n.slice()),ve(this,{type:r,inputs:n})}static from(t){if(typeof t=="string"){try{ps.from(JSON.parse(t))}catch{}return ps.from(Cn(t))}if(t instanceof ar)switch(t.peekKeyword(Kh)){case"constructor":return qr.from(t);case"error":return Ft.from(t);case"event":return yr.from(t);case"fallback":case"receive":return Fr.from(t);case"function":return wr.from(t);case"struct":return us.from(t)}else if(typeof t=="object"){switch(t.type){case"constructor":return qr.from(t);case"error":return Ft.from(t);case"event":return yr.from(t);case"fallback":case"receive":return Fr.from(t);case"function":return wr.from(t);case"struct":return us.from(t)}W(!1,`unsupported type: ${t.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}A(!1,"unsupported frgament object","obj",t)}static isConstructor(t){return qr.isFragment(t)}static isError(t){return Ft.isFragment(t)}static isEvent(t){return yr.isFragment(t)}static isFunction(t){return wr.isFragment(t)}static isStruct(t){return us.isFragment(t)}}class Go extends ps{constructor(r,n,s,a){super(r,n,a);T(this,"name");A(typeof s=="string"&&s.match(Wh),"invalid identifier","name",s),a=Object.freeze(a.slice()),ve(this,{name:s})}}function ma(e,t){return"("+t.map(r=>r.format(e)).join(e==="full"?", ":",")+")"}class Ft extends Go{constructor(t,r,n){super(t,"error",r,n),Object.defineProperty(this,Pt,{value:Ed})}get selector(){return fs(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(t)))});const r=[];return t!=="sighash"&&r.push("error"),r.push(this.name+ma(t,this.inputs)),r.join(" ")}static from(t){if(Ft.isFragment(t))return t;if(typeof t=="string")return Ft.from(Cn(t));if(t instanceof ar){const r=Vo("error",t),n=Jr(t);return ms(t),new Ft(We,r,n)}return new Ft(We,t.name,t.inputs?t.inputs.map(ut.from):[])}static isFragment(t){return t&&t[Pt]===Ed}}class yr extends Go{constructor(r,n,s,a){super(r,"event",n,s);T(this,"anonymous");Object.defineProperty(this,Pt,{value:kd}),ve(this,{anonymous:a})}get topicHash(){return fs(this.format("sighash"))}format(r){if(r==null&&(r="sighash"),r==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(s=>JSON.parse(s.format(r)))});const n=[];return r!=="sighash"&&n.push("event"),n.push(this.name+ma(r,this.inputs)),r!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(r,n){return n=(n||[]).map(a=>ut.from(a)),new yr(We,r,n,!1).topicHash}static from(r){if(yr.isFragment(r))return r;if(typeof r=="string")try{return yr.from(Cn(r))}catch{A(!1,"invalid event fragment","obj",r)}else if(r instanceof ar){const n=Vo("event",r),s=Jr(r,!0),a=!!Wr(r,vt(["anonymous"])).has("anonymous");return ms(r),new yr(We,n,s,a)}return new yr(We,r.name,r.inputs?r.inputs.map(n=>ut.from(n,!0)):[],!!r.anonymous)}static isFragment(r){return r&&r[Pt]===kd}}class qr extends ps{constructor(r,n,s,a,o){super(r,n,s);T(this,"payable");T(this,"gas");Object.defineProperty(this,Pt,{value:Cd}),ve(this,{payable:a,gas:o})}format(r){if(W(r!=null&&r!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),r==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(r)))});const n=[`constructor${ma(r,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(r){if(qr.isFragment(r))return r;if(typeof r=="string")try{return qr.from(Cn(r))}catch{A(!1,"invalid constuctor fragment","obj",r)}else if(r instanceof ar){Wr(r,vt(["constructor"]));const n=Jr(r),s=!!Wr(r,qx).has("payable"),a=Xh(r);return ms(r),new qr(We,"constructor",n,s,a)}return new qr(We,"constructor",r.inputs?r.inputs.map(ut.from):[],!!r.payable,r.gas!=null?r.gas:null)}static isFragment(r){return r&&r[Pt]===Cd}}class Fr extends ps{constructor(r,n,s){super(r,"fallback",n);T(this,"payable");Object.defineProperty(this,Pt,{value:Td}),ve(this,{payable:s})}format(r){const n=this.inputs.length===0?"receive":"fallback";if(r==="json"){const s=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:s})}return`${n}()${this.payable?" payable":""}`}static from(r){if(Fr.isFragment(r))return r;if(typeof r=="string")try{return Fr.from(Cn(r))}catch{A(!1,"invalid fallback fragment","obj",r)}else if(r instanceof ar){const n=r.toString(),s=r.peekKeyword(vt(["fallback","receive"]));if(A(s,"type must be fallback or receive","obj",n),r.popKeyword(vt(["fallback","receive"]))==="receive"){const l=Jr(r);return A(l.length===0,"receive cannot have arguments","obj.inputs",l),Wr(r,vt(["payable"])),ms(r),new Fr(We,[],!0)}let o=Jr(r);o.length?A(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(l=>l.format("minimal")).join(", ")):o=[ut.from("bytes")];const c=Zh(r);if(A(c==="nonpayable"||c==="payable","fallback cannot be constants","obj.stateMutability",c),Wr(r,vt(["returns"])).has("returns")){const l=Jr(r);A(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(d=>d.format("minimal")).join(", "))}return ms(r),new Fr(We,o,c==="payable")}if(r.type==="receive")return new Fr(We,[],!0);if(r.type==="fallback"){const n=[ut.from("bytes")],s=r.stateMutability==="payable";return new Fr(We,n,s)}A(!1,"invalid fallback description","obj",r)}static isFragment(r){return r&&r[Pt]===Td}}class wr extends Go{constructor(r,n,s,a,o,c){super(r,"function",n,a);T(this,"constant");T(this,"outputs");T(this,"stateMutability");T(this,"payable");T(this,"gas");Object.defineProperty(this,Pt,{value:jd}),o=Object.freeze(o.slice()),ve(this,{constant:s==="view"||s==="pure",gas:c,outputs:o,payable:s==="payable",stateMutability:s})}get selector(){return fs(this.format("sighash")).substring(0,10)}format(r){if(r==null&&(r="sighash"),r==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(s=>JSON.parse(s.format(r))),outputs:this.outputs.map(s=>JSON.parse(s.format(r)))});const n=[];return r!=="sighash"&&n.push("function"),n.push(this.name+ma(r,this.inputs)),r!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(ma(r,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(r,n){return n=(n||[]).map(a=>ut.from(a)),new wr(We,r,"view",n,[],null).selector}static from(r){if(wr.isFragment(r))return r;if(typeof r=="string")try{return wr.from(Cn(r))}catch{A(!1,"invalid function fragment","obj",r)}else if(r instanceof ar){const s=Vo("function",r),a=Jr(r),o=Zh(r);let c=[];Wr(r,vt(["returns"])).has("returns")&&(c=Jr(r));const l=Xh(r);return ms(r),new wr(We,s,o,a,c,l)}let n=r.stateMutability;return n==null&&(n="payable",typeof r.constant=="boolean"?(n="view",r.constant||(n="payable",typeof r.payable=="boolean"&&!r.payable&&(n="nonpayable"))):typeof r.payable=="boolean"&&!r.payable&&(n="nonpayable")),new wr(We,r.name,n,r.inputs?r.inputs.map(ut.from):[],r.outputs?r.outputs.map(ut.from):[],r.gas!=null?r.gas:null)}static isFragment(r){return r&&r[Pt]===jd}}class us extends Go{constructor(t,r,n){super(t,"struct",r,n),Object.defineProperty(this,Pt,{value:Sd})}format(){throw new Error("@TODO")}static from(t){if(typeof t=="string")try{return us.from(Cn(t))}catch{A(!1,"invalid struct fragment","obj",t)}else if(t instanceof ar){const r=Vo("struct",t),n=Jr(t);return ms(t),new us(We,r,n)}return new us(We,t.name,t.inputs?t.inputs.map(ut.from):[])}static isFragment(t){return t&&t[Pt]===Sd}}const or=new Map;or.set(0,"GENERIC_PANIC");or.set(1,"ASSERT_FALSE");or.set(17,"OVERFLOW");or.set(18,"DIVIDE_BY_ZERO");or.set(33,"ENUM_RANGE_ERROR");or.set(34,"BAD_STORAGE_DATA");or.set(49,"STACK_UNDERFLOW");or.set(50,"ARRAY_RANGE_ERROR");or.set(65,"OUT_OF_MEMORY");or.set(81,"UNINITIALIZED_FUNCTION_CALL");const tb=new RegExp(/^bytes([0-9]*)$/),rb=new RegExp(/^(u?int)([0-9]*)$/);let nc=null,Fd=1024;function nb(e,t,r,n){let s="missing revert data",a=null;const o=null;let c=null;if(r){s="execution reverted";const d=je(r);if(r=ue(r),d.length===0)s+=" (no data present; likely require(false) occurred",a="require(false)";else if(d.length%32!==4)s+=" (could not decode reason; invalid data length)";else if(ue(d.slice(0,4))==="0x08c379a0")try{a=n.decode(["string"],d.slice(4))[0],c={signature:"Error(string)",name:"Error",args:[a]},s+=`: ${JSON.stringify(a)}`}catch{s+=" (could not decode reason; invalid string data)"}else if(ue(d.slice(0,4))==="0x4e487b71")try{const u=Number(n.decode(["uint256"],d.slice(4))[0]);c={signature:"Panic(uint256)",name:"Panic",args:[u]},a=`Panic due to ${or.get(u)||"UNKNOWN"}(${u})`,s+=`: ${a}`}catch{s+=" (could not decode panic code)"}else s+=" (unknown custom error)"}const l={to:t.to?Ue(t.to):null,data:t.data||"0x"};return t.from&&(l.from=Ue(t.from)),Ke(s,"CALL_EXCEPTION",{action:e,data:r,reason:a,transaction:l,invocation:o,revert:c})}var ln,Ts;const vo=class vo{constructor(){B(this,ln)}getDefaultValue(t){const r=t.map(s=>te(this,ln,Ts).call(this,ut.from(s)));return new qa(r,"_").defaultValue()}encode(t,r){yu(r.length,t.length,"types/values length mismatch");const n=t.map(o=>te(this,ln,Ts).call(this,ut.from(o))),s=new qa(n,"_"),a=new Ac;return s.encode(a,r),a.data}decode(t,r,n){const s=t.map(o=>te(this,ln,Ts).call(this,ut.from(o)));return new qa(s,"_").decode(new vc(r,n,Fd))}static _setDefaultMaxInflation(t){A(typeof t=="number"&&Number.isInteger(t),"invalid defaultMaxInflation factor","value",t),Fd=t}static defaultAbiCoder(){return nc==null&&(nc=new vo),nc}static getBuiltinCallException(t,r,n){return nb(t,r,n,vo.defaultAbiCoder())}};ln=new WeakSet,Ts=function(t){if(t.isArray())return new Ag(te(this,ln,Ts).call(this,t.arrayChildren),t.arrayLength,t.name);if(t.isTuple())return new qa(t.components.map(n=>te(this,ln,Ts).call(this,n)),t.name);switch(t.baseType){case"address":return new wg(t.name);case"bool":return new vg(t.name);case"string":return new Pg(t.name);case"bytes":return new Eg(t.name);case"":return new Tg(t.name)}let r=t.type.match(rb);if(r){let n=parseInt(r[2]||"256");return A(n!==0&&n<=256&&n%8===0,"invalid "+r[1]+" bit length","param",t),new Rg(n/8,r[1]==="int",t.name)}if(r=t.type.match(tb),r){let n=parseInt(r[1]);return A(n!==0&&n<=32,"invalid bytes length","param",t),new kg(n,t.name)}A(!1,"invalid type","type",t.type)};let pa=vo;class sb{constructor(t,r,n){T(this,"fragment");T(this,"name");T(this,"signature");T(this,"topic");T(this,"args");const s=t.name,a=t.format();ve(this,{fragment:t,name:s,signature:a,topic:r,args:n})}}class ib{constructor(t,r,n,s){T(this,"fragment");T(this,"name");T(this,"args");T(this,"signature");T(this,"selector");T(this,"value");const a=t.name,o=t.format();ve(this,{fragment:t,name:a,args:n,signature:o,selector:r,value:s})}}class ab{constructor(t,r,n){T(this,"fragment");T(this,"name");T(this,"args");T(this,"signature");T(this,"selector");const s=t.name,a=t.format();ve(this,{fragment:t,name:s,args:n,signature:a,selector:r})}}class Rd{constructor(t){T(this,"hash");T(this,"_isIndexed");ve(this,{hash:t,_isIndexed:!0})}static isIndexed(t){return!!(t&&t._isIndexed)}}const Pd={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},Bd={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:e=>`reverted with reason string ${JSON.stringify(e)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:e=>{let t="unknown panic code";return e>=0&&e<=255&&Pd[e.toString()]&&(t=Pd[e.toString()]),`reverted with panic code 0x${e.toString(16)} (${t})`}}};var fr,mr,pr,ht,vr,Da,eo;const _n=class _n{constructor(t){B(this,vr);T(this,"fragments");T(this,"deploy");T(this,"fallback");T(this,"receive");B(this,fr);B(this,mr);B(this,pr);B(this,ht);let r=[];typeof t=="string"?r=JSON.parse(t):r=t,x(this,pr,new Map),x(this,fr,new Map),x(this,mr,new Map);const n=[];for(const o of r)try{n.push(ps.from(o))}catch(c){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,c.message)}ve(this,{fragments:Object.freeze(n)});let s=null,a=!1;x(this,ht,this.getAbiCoder()),this.fragments.forEach((o,c)=>{let l;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}ve(this,{deploy:o});return;case"fallback":o.inputs.length===0?a=!0:(A(!s||o.payable!==s.payable,"conflicting fallback fragments",`fragments[${c}]`,o),s=o,a=s.payable);return;case"function":l=f(this,pr);break;case"event":l=f(this,mr);break;case"error":l=f(this,fr);break;default:return}const d=o.format();l.has(d)||l.set(d,o)}),this.deploy||ve(this,{deploy:qr.from("constructor()")}),ve(this,{fallback:s,receive:a})}format(t){const r=t?"minimal":"full";return this.fragments.map(s=>s.format(r))}formatJson(){const t=this.fragments.map(r=>r.format("json"));return JSON.stringify(t.map(r=>JSON.parse(r)))}getAbiCoder(){return pa.defaultAbiCoder()}getFunctionName(t){const r=te(this,vr,Da).call(this,t,null,!1);return A(r,"no matching function","key",t),r.name}hasFunction(t){return!!te(this,vr,Da).call(this,t,null,!1)}getFunction(t,r){return te(this,vr,Da).call(this,t,r||null,!0)}forEachFunction(t){const r=Array.from(f(this,pr).keys());r.sort((n,s)=>n.localeCompare(s));for(let n=0;n<r.length;n++){const s=r[n];t(f(this,pr).get(s),n)}}getEventName(t){const r=te(this,vr,eo).call(this,t,null,!1);return A(r,"no matching event","key",t),r.name}hasEvent(t){return!!te(this,vr,eo).call(this,t,null,!1)}getEvent(t,r){return te(this,vr,eo).call(this,t,r||null,!0)}forEachEvent(t){const r=Array.from(f(this,mr).keys());r.sort((n,s)=>n.localeCompare(s));for(let n=0;n<r.length;n++){const s=r[n];t(f(this,mr).get(s),n)}}getError(t,r){if(qe(t)){const s=t.toLowerCase();if(Bd[s])return Ft.from(Bd[s].signature);for(const a of f(this,fr).values())if(s===a.selector)return a;return null}if(t.indexOf("(")===-1){const s=[];for(const[a,o]of f(this,fr))a.split("(")[0]===t&&s.push(o);if(s.length===0)return t==="Error"?Ft.from("error Error(string)"):t==="Panic"?Ft.from("error Panic(uint256)"):null;if(s.length>1){const a=s.map(o=>JSON.stringify(o.format())).join(", ");A(!1,`ambiguous error description (i.e. ${a})`,"name",t)}return s[0]}if(t=Ft.from(t).format(),t==="Error(string)")return Ft.from("error Error(string)");if(t==="Panic(uint256)")return Ft.from("error Panic(uint256)");const n=f(this,fr).get(t);return n||null}forEachError(t){const r=Array.from(f(this,fr).keys());r.sort((n,s)=>n.localeCompare(s));for(let n=0;n<r.length;n++){const s=r[n];t(f(this,fr).get(s),n)}}_decodeParams(t,r){return f(this,ht).decode(t,r)}_encodeParams(t,r){return f(this,ht).encode(t,r)}encodeDeploy(t){return this._encodeParams(this.deploy.inputs,t||[])}decodeErrorResult(t,r){if(typeof t=="string"){const n=this.getError(t);A(n,"unknown error","fragment",t),t=n}return A(Ie(r,0,4)===t.selector,`data signature does not match error ${t.name}.`,"data",r),this._decodeParams(t.inputs,Ie(r,4))}encodeErrorResult(t,r){if(typeof t=="string"){const n=this.getError(t);A(n,"unknown error","fragment",t),t=n}return Ye([t.selector,this._encodeParams(t.inputs,r||[])])}decodeFunctionData(t,r){if(typeof t=="string"){const n=this.getFunction(t);A(n,"unknown function","fragment",t),t=n}return A(Ie(r,0,4)===t.selector,`data signature does not match function ${t.name}.`,"data",r),this._decodeParams(t.inputs,Ie(r,4))}encodeFunctionData(t,r){if(typeof t=="string"){const n=this.getFunction(t);A(n,"unknown function","fragment",t),t=n}return Ye([t.selector,this._encodeParams(t.inputs,r||[])])}decodeFunctionResult(t,r){if(typeof t=="string"){const a=this.getFunction(t);A(a,"unknown function","fragment",t),t=a}let n="invalid length for result data";const s=wt(r);if(s.length%32===0)try{return f(this,ht).decode(t.outputs,s)}catch{n="could not decode result data"}W(!1,n,"BAD_DATA",{value:ue(s),info:{method:t.name,signature:t.format()}})}makeError(t,r){const n=je(t,"data"),s=pa.getBuiltinCallException("call",r,n);if(s.message.startsWith("execution reverted (unknown custom error)")){const c=ue(n.slice(0,4)),l=this.getError(c);if(l)try{const d=f(this,ht).decode(l.inputs,n.slice(4));s.revert={name:l.name,signature:l.format(),args:d},s.reason=s.revert.signature,s.message=`execution reverted: ${s.reason}`}catch{s.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(r);return o&&(s.invocation={method:o.name,signature:o.signature,args:o.args}),s}encodeFunctionResult(t,r){if(typeof t=="string"){const n=this.getFunction(t);A(n,"unknown function","fragment",t),t=n}return ue(f(this,ht).encode(t.outputs,r||[]))}encodeFilterTopics(t,r){if(typeof t=="string"){const a=this.getEvent(t);A(a,"unknown event","eventFragment",t),t=a}W(r.length<=t.inputs.length,`too many arguments for ${t.format()}`,"UNEXPECTED_ARGUMENT",{count:r.length,expectedCount:t.inputs.length});const n=[];t.anonymous||n.push(t.topicHash);const s=(a,o)=>a.type==="string"?fs(o):a.type==="bytes"?Le(ue(o)):(a.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":a.type.match(/^u?int/)?o=vn(o):a.type.match(/^bytes/)?o=wm(o,32):a.type==="address"&&f(this,ht).encode(["address"],[o]),Kr(ue(o),32));for(r.forEach((a,o)=>{const c=t.inputs[o];if(!c.indexed){A(a==null,"cannot filter non-indexed parameters; must be null","contract."+c.name,a);return}a==null?n.push(null):c.baseType==="array"||c.baseType==="tuple"?A(!1,"filtering with tuples or arrays not supported","contract."+c.name,a):Array.isArray(a)?n.push(a.map(l=>s(c,l))):n.push(s(c,a))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(t,r){if(typeof t=="string"){const o=this.getEvent(t);A(o,"unknown event","eventFragment",t),t=o}const n=[],s=[],a=[];return t.anonymous||n.push(t.topicHash),A(r.length===t.inputs.length,"event arguments/values mismatch","values",r),t.inputs.forEach((o,c)=>{const l=r[c];if(o.indexed)if(o.type==="string")n.push(fs(l));else if(o.type==="bytes")n.push(Le(l));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(f(this,ht).encode([o.type],[l]))}else s.push(o),a.push(l)}),{data:f(this,ht).encode(s,a),topics:n}}decodeEventLog(t,r,n){if(typeof t=="string"){const p=this.getEvent(t);A(p,"unknown event","eventFragment",t),t=p}if(n!=null&&!t.anonymous){const p=t.topicHash;A(qe(n[0],32)&&n[0].toLowerCase()===p,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const s=[],a=[],o=[];t.inputs.forEach((p,b)=>{p.indexed?p.type==="string"||p.type==="bytes"||p.baseType==="tuple"||p.baseType==="array"?(s.push(ut.from({type:"bytes32",name:p.name})),o.push(!0)):(s.push(p),o.push(!1)):(a.push(p),o.push(!1))});const c=n!=null?f(this,ht).decode(s,Ye(n)):null,l=f(this,ht).decode(a,r,!0),d=[],u=[];let h=0,m=0;return t.inputs.forEach((p,b)=>{let g=null;if(p.indexed)if(c==null)g=new Rd(null);else if(o[b])g=new Rd(c[m++]);else try{g=c[m++]}catch(v){g=v}else try{g=l[h++]}catch(v){g=v}d.push(g),u.push(p.name||null)}),Si.fromItems(d,u)}parseTransaction(t){const r=je(t.data,"tx.data"),n=me(t.value!=null?t.value:0,"tx.value"),s=this.getFunction(ue(r.slice(0,4)));if(!s)return null;const a=f(this,ht).decode(s.inputs,r.slice(4));return new ib(s,s.selector,a,n)}parseCallResult(t){throw new Error("@TODO")}parseLog(t){const r=this.getEvent(t.topics[0]);return!r||r.anonymous?null:new sb(r,r.topicHash,this.decodeEventLog(r,t.data,t.topics))}parseError(t){const r=ue(t),n=this.getError(Ie(r,0,4));if(!n)return null;const s=f(this,ht).decode(n.inputs,Ie(r,4));return new ab(n,n.selector,s)}static from(t){return t instanceof _n?t:typeof t=="string"?new _n(JSON.parse(t)):typeof t.formatJson=="function"?new _n(t.formatJson()):typeof t.format=="function"?new _n(t.format("json")):new _n(t)}};fr=new WeakMap,mr=new WeakMap,pr=new WeakMap,ht=new WeakMap,vr=new WeakSet,Da=function(t,r,n){if(qe(t)){const a=t.toLowerCase();for(const o of f(this,pr).values())if(a===o.selector)return o;return null}if(t.indexOf("(")===-1){const a=[];for(const[o,c]of f(this,pr))o.split("(")[0]===t&&a.push(c);if(r){const o=r.length>0?r[r.length-1]:null;let c=r.length,l=!0;pt.isTyped(o)&&o.type==="overrides"&&(l=!1,c--);for(let d=a.length-1;d>=0;d--){const u=a[d].inputs.length;u!==c&&(!l||u!==c-1)&&a.splice(d,1)}for(let d=a.length-1;d>=0;d--){const u=a[d].inputs;for(let h=0;h<r.length;h++)if(pt.isTyped(r[h])){if(h>=u.length){if(r[h].type==="overrides")continue;a.splice(d,1);break}if(r[h].type!==u[h].baseType){a.splice(d,1);break}}}}if(a.length===1&&r&&r.length!==a[0].inputs.length){const o=r[r.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&a.splice(0,1)}if(a.length===0)return null;if(a.length>1&&n){const o=a.map(c=>JSON.stringify(c.format())).join(", ");A(!1,`ambiguous function description (i.e. matches ${o})`,"key",t)}return a[0]}const s=f(this,pr).get(wr.from(t).format());return s||null},eo=function(t,r,n){if(qe(t)){const a=t.toLowerCase();for(const o of f(this,mr).values())if(a===o.topicHash)return o;return null}if(t.indexOf("(")===-1){const a=[];for(const[o,c]of f(this,mr))o.split("(")[0]===t&&a.push(c);if(r){for(let o=a.length-1;o>=0;o--)a[o].inputs.length<r.length&&a.splice(o,1);for(let o=a.length-1;o>=0;o--){const c=a[o].inputs;for(let l=0;l<r.length;l++)if(pt.isTyped(r[l])&&r[l].type!==c[l].baseType){a.splice(o,1);break}}}if(a.length===0)return null;if(a.length>1&&n){const o=a.map(c=>JSON.stringify(c.format())).join(", ");A(!1,`ambiguous event description (i.e. matches ${o})`,"key",t)}return a[0]}const s=f(this,mr).get(yr.from(t).format());return s||null};let Uc=_n;const Lh=BigInt(0);function Vs(e){return e??null}function Ze(e){return e==null?null:e.toString()}class Od{constructor(t,r,n){T(this,"gasPrice");T(this,"maxFeePerGas");T(this,"maxPriorityFeePerGas");ve(this,{gasPrice:Vs(t),maxFeePerGas:Vs(r),maxPriorityFeePerGas:Vs(n)})}toJSON(){const{gasPrice:t,maxFeePerGas:r,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:Ze(t),maxFeePerGas:Ze(r),maxPriorityFeePerGas:Ze(n)}}}function xo(e){const t={};e.to&&(t.to=e.to),e.from&&(t.from=e.from),e.data&&(t.data=ue(e.data));const r="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const s of r)!(s in e)||e[s]==null||(t[s]=me(e[s],`request.${s}`));const n="type,nonce".split(/,/);for(const s of n)!(s in e)||e[s]==null||(t[s]=Se(e[s],`request.${s}`));return e.accessList&&(t.accessList=bs(e.accessList)),e.authorizationList&&(t.authorizationList=e.authorizationList.slice()),"blockTag"in e&&(t.blockTag=e.blockTag),"enableCcipRead"in e&&(t.enableCcipRead=!!e.enableCcipRead),"customData"in e&&(t.customData=e.customData),"blobVersionedHashes"in e&&e.blobVersionedHashes&&(t.blobVersionedHashes=e.blobVersionedHashes.slice()),"kzg"in e&&(t.kzg=e.kzg),"blobs"in e&&e.blobs&&(t.blobs=e.blobs.map(s=>rl(s)?ue(s):Object.assign({},s))),t}var _r;class ob{constructor(t,r){T(this,"provider");T(this,"number");T(this,"hash");T(this,"timestamp");T(this,"parentHash");T(this,"parentBeaconBlockRoot");T(this,"nonce");T(this,"difficulty");T(this,"gasLimit");T(this,"gasUsed");T(this,"stateRoot");T(this,"receiptsRoot");T(this,"blobGasUsed");T(this,"excessBlobGas");T(this,"miner");T(this,"prevRandao");T(this,"extraData");T(this,"baseFeePerGas");B(this,_r);x(this,_r,t.transactions.map(n=>typeof n!="string"?new ga(n,r):n)),ve(this,{provider:r,hash:Vs(t.hash),number:t.number,timestamp:t.timestamp,parentHash:t.parentHash,parentBeaconBlockRoot:t.parentBeaconBlockRoot,nonce:t.nonce,difficulty:t.difficulty,gasLimit:t.gasLimit,gasUsed:t.gasUsed,blobGasUsed:t.blobGasUsed,excessBlobGas:t.excessBlobGas,miner:t.miner,prevRandao:Vs(t.prevRandao),extraData:t.extraData,baseFeePerGas:Vs(t.baseFeePerGas),stateRoot:t.stateRoot,receiptsRoot:t.receiptsRoot})}get transactions(){return f(this,_r).map(t=>typeof t=="string"?t:t.hash)}get prefetchedTransactions(){const t=f(this,_r).slice();return t.length===0?[]:(W(typeof t[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),t)}toJSON(){const{baseFeePerGas:t,difficulty:r,extraData:n,gasLimit:s,gasUsed:a,hash:o,miner:c,prevRandao:l,nonce:d,number:u,parentHash:h,parentBeaconBlockRoot:m,stateRoot:p,receiptsRoot:b,timestamp:g,transactions:v}=this;return{_type:"Block",baseFeePerGas:Ze(t),difficulty:Ze(r),extraData:n,gasLimit:Ze(s),gasUsed:Ze(a),blobGasUsed:Ze(this.blobGasUsed),excessBlobGas:Ze(this.excessBlobGas),hash:o,miner:c,prevRandao:l,nonce:d,number:u,parentHash:h,timestamp:g,parentBeaconBlockRoot:m,stateRoot:p,receiptsRoot:b,transactions:v}}[Symbol.iterator](){let t=0;const r=this.transactions;return{next:()=>t<this.length?{value:r[t++],done:!1}:{value:void 0,done:!0}}}get length(){return f(this,_r).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(t){let r;if(typeof t=="number")r=f(this,_r)[t];else{const n=t.toLowerCase();for(const s of f(this,_r))if(typeof s=="string"){if(s!==n)continue;r=s;break}else{if(s.hash!==n)continue;r=s;break}}if(r==null)throw new Error("no such tx");return typeof r=="string"?await this.provider.getTransaction(r):r}getPrefetchedTransaction(t){const r=this.prefetchedTransactions;if(typeof t=="number")return r[t];t=t.toLowerCase();for(const n of r)if(n.hash===t)return n;A(!1,"no matching transaction","indexOrHash",t)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return cb(this)}}_r=new WeakMap;class Oa{constructor(t,r){T(this,"provider");T(this,"transactionHash");T(this,"blockHash");T(this,"blockNumber");T(this,"removed");T(this,"address");T(this,"data");T(this,"topics");T(this,"index");T(this,"transactionIndex");this.provider=r;const n=Object.freeze(t.topics.slice());ve(this,{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,removed:t.removed,address:t.address,data:t.data,topics:n,index:t.index,transactionIndex:t.transactionIndex})}toJSON(){const{address:t,blockHash:r,blockNumber:n,data:s,index:a,removed:o,topics:c,transactionHash:l,transactionIndex:d}=this;return{_type:"log",address:t,blockHash:r,blockNumber:n,data:s,index:a,removed:o,topics:c,transactionHash:l,transactionIndex:d}}async getBlock(){const t=await this.provider.getBlock(this.blockHash);return W(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransaction(){const t=await this.provider.getTransaction(this.transactionHash);return W(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransactionReceipt(){const t=await this.provider.getTransactionReceipt(this.transactionHash);return W(!!t,"failed to find transaction receipt","UNKNOWN_ERROR",{}),t}removedEvent(){return lb(this)}}var va;class Dh{constructor(t,r){T(this,"provider");T(this,"to");T(this,"from");T(this,"contractAddress");T(this,"hash");T(this,"index");T(this,"blockHash");T(this,"blockNumber");T(this,"logsBloom");T(this,"gasUsed");T(this,"blobGasUsed");T(this,"cumulativeGasUsed");T(this,"gasPrice");T(this,"blobGasPrice");T(this,"type");T(this,"status");T(this,"root");B(this,va);x(this,va,Object.freeze(t.logs.map(s=>new Oa(s,r))));let n=Lh;t.effectiveGasPrice!=null?n=t.effectiveGasPrice:t.gasPrice!=null&&(n=t.gasPrice),ve(this,{provider:r,to:t.to,from:t.from,contractAddress:t.contractAddress,hash:t.hash,index:t.index,blockHash:t.blockHash,blockNumber:t.blockNumber,logsBloom:t.logsBloom,gasUsed:t.gasUsed,cumulativeGasUsed:t.cumulativeGasUsed,blobGasUsed:t.blobGasUsed,gasPrice:n,blobGasPrice:t.blobGasPrice,type:t.type,status:t.status,root:t.root})}get logs(){return f(this,va)}toJSON(){const{to:t,from:r,contractAddress:n,hash:s,index:a,blockHash:o,blockNumber:c,logsBloom:l,logs:d,status:u,root:h}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:c,contractAddress:n,cumulativeGasUsed:Ze(this.cumulativeGasUsed),from:r,gasPrice:Ze(this.gasPrice),blobGasUsed:Ze(this.blobGasUsed),blobGasPrice:Ze(this.blobGasPrice),gasUsed:Ze(this.gasUsed),hash:s,index:a,logs:d,logsBloom:l,root:h,status:u,to:t}}get length(){return this.logs.length}[Symbol.iterator](){let t=0;return{next:()=>t<this.length?{value:this.logs[t++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const t=await this.provider.getBlock(this.blockHash);if(t==null)throw new Error("TODO");return t}async getTransaction(){const t=await this.provider.getTransaction(this.hash);if(t==null)throw new Error("TODO");return t}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return tf(this)}reorderedEvent(t){return W(!t||t.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),ef(this,t)}}va=new WeakMap;var dn;const kl=class kl{constructor(t,r){T(this,"provider");T(this,"blockNumber");T(this,"blockHash");T(this,"index");T(this,"hash");T(this,"type");T(this,"to");T(this,"from");T(this,"nonce");T(this,"gasLimit");T(this,"gasPrice");T(this,"maxPriorityFeePerGas");T(this,"maxFeePerGas");T(this,"maxFeePerBlobGas");T(this,"data");T(this,"value");T(this,"chainId");T(this,"signature");T(this,"accessList");T(this,"blobVersionedHashes");T(this,"authorizationList");B(this,dn);this.provider=r,this.blockNumber=t.blockNumber!=null?t.blockNumber:null,this.blockHash=t.blockHash!=null?t.blockHash:null,this.hash=t.hash,this.index=t.index,this.type=t.type,this.from=t.from,this.to=t.to||null,this.gasLimit=t.gasLimit,this.nonce=t.nonce,this.data=t.data,this.value=t.value,this.gasPrice=t.gasPrice,this.maxPriorityFeePerGas=t.maxPriorityFeePerGas!=null?t.maxPriorityFeePerGas:null,this.maxFeePerGas=t.maxFeePerGas!=null?t.maxFeePerGas:null,this.maxFeePerBlobGas=t.maxFeePerBlobGas!=null?t.maxFeePerBlobGas:null,this.chainId=t.chainId,this.signature=t.signature,this.accessList=t.accessList!=null?t.accessList:null,this.blobVersionedHashes=t.blobVersionedHashes!=null?t.blobVersionedHashes:null,this.authorizationList=t.authorizationList!=null?t.authorizationList:null,x(this,dn,-1)}toJSON(){const{blockNumber:t,blockHash:r,index:n,hash:s,type:a,to:o,from:c,nonce:l,data:d,signature:u,accessList:h,blobVersionedHashes:m}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:t,blockHash:r,blobVersionedHashes:m,chainId:Ze(this.chainId),data:d,from:c,gasLimit:Ze(this.gasLimit),gasPrice:Ze(this.gasPrice),hash:s,maxFeePerGas:Ze(this.maxFeePerGas),maxPriorityFeePerGas:Ze(this.maxPriorityFeePerGas),maxFeePerBlobGas:Ze(this.maxFeePerBlobGas),nonce:l,signature:u,to:o,index:n,type:a,value:Ze(this.value)}}async getBlock(){let t=this.blockNumber;if(t==null){const n=await this.getTransaction();n&&(t=n.blockNumber)}if(t==null)return null;const r=this.provider.getBlock(t);if(r==null)throw new Error("TODO");return r}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:r,blockNumber:n}=await yt({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return r==null||r.blockNumber==null?0:n-r.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(t,r){const n=t??1,s=r??0;let a=f(this,dn),o=-1,c=a===-1;const l=async()=>{if(c)return null;const{blockNumber:m,nonce:p}=await yt({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(p<this.nonce){a=m;return}if(c)return null;const b=await this.getTransaction();if(!(b&&b.blockNumber!=null))for(o===-1&&(o=a-3,o<f(this,dn)&&(o=f(this,dn)));o<=m;){if(c)return null;const g=await this.provider.getBlock(o,!0);if(g==null)return;for(const v of g)if(v===this.hash)return;for(let v=0;v<g.length;v++){const N=await g.getTransaction(v);if(N.from===this.from&&N.nonce===this.nonce){if(c)return null;const V=await this.provider.getTransactionReceipt(N.hash);if(V==null||m-V.blockNumber+1<n)return;let E="replaced";N.data===this.data&&N.to===this.to&&N.value===this.value?E="repriced":N.data==="0x"&&N.from===N.to&&N.value===Lh&&(E="cancelled"),W(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:E==="replaced"||E==="cancelled",reason:E,replacement:N.replaceableTransaction(a),hash:N.hash,receipt:V})}}o++}},d=m=>{if(m==null||m.status!==0)return m;W(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:m.to,from:m.from,data:""},receipt:m})},u=await this.provider.getTransactionReceipt(this.hash);if(n===0)return d(u);if(u){if(n===1||await u.confirmations()>=n)return d(u)}else if(await l(),n===0)return null;return await new Promise((m,p)=>{const b=[],g=()=>{b.forEach(N=>N())};if(b.push(()=>{c=!0}),s>0){const N=setTimeout(()=>{g(),p(Ke("wait for transaction timeout","TIMEOUT"))},s);b.push(()=>{clearTimeout(N)})}const v=async N=>{if(await N.confirmations()>=n){g();try{m(d(N))}catch(V){p(V)}}};if(b.push(()=>{this.provider.off(this.hash,v)}),this.provider.on(this.hash,v),a>=0){const N=async()=>{try{await l()}catch(V){if(dt(V,"TRANSACTION_REPLACED")){g(),p(V);return}}c||this.provider.once("block",N)};b.push(()=>{this.provider.off("block",N)}),this.provider.once("block",N)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return W(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),tf(this)}reorderedEvent(t){return W(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),W(!t||t.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),ef(this,t)}replaceableTransaction(t){A(Number.isInteger(t)&&t>=0,"invalid startBlock","startBlock",t);const r=new kl(this,this.provider);return x(r,dn,t),r}};dn=new WeakMap;let ga=kl;function cb(e){return{orphan:"drop-block",hash:e.hash,number:e.number}}function ef(e,t){return{orphan:"reorder-transaction",tx:e,other:t}}function tf(e){return{orphan:"drop-transaction",tx:e}}function lb(e){return{orphan:"drop-log",log:{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,address:e.address,data:e.data,topics:Object.freeze(e.topics.slice()),index:e.index}}}class bl extends Oa{constructor(r,n,s){super(r,r.provider);T(this,"interface");T(this,"fragment");T(this,"args");const a=n.decodeEventLog(s,r.data,r.topics);ve(this,{args:a,fragment:s,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class rf extends Oa{constructor(r,n){super(r,r.provider);T(this,"error");ve(this,{error:n})}}var di;class db extends Dh{constructor(r,n,s){super(s,n);B(this,di);x(this,di,r)}get logs(){return super.logs.map(r=>{const n=r.topics.length?f(this,di).getEvent(r.topics[0]):null;if(n)try{return new bl(r,f(this,di),n)}catch(s){return new rf(r,s)}return r})}}di=new WeakMap;var Ea;class yl extends ga{constructor(r,n,s){super(s,n);B(this,Ea);x(this,Ea,r)}async wait(r,n){const s=await super.wait(r,n);return s==null?null:new db(f(this,Ea),this.provider,s)}}Ea=new WeakMap;class nf extends vu{constructor(r,n,s,a){super(r,n,s);T(this,"log");ve(this,{log:a})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class ub extends nf{constructor(t,r,n,s,a){super(t,r,n,new bl(a,t.interface,s));const o=t.interface.decodeEventLog(s,this.log.data,this.log.topics);ve(this,{args:o,fragment:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const Md=BigInt(0);function sf(e){return e&&typeof e.call=="function"}function af(e){return e&&typeof e.estimateGas=="function"}function zo(e){return e&&typeof e.resolveName=="function"}function of(e){return e&&typeof e.sendTransaction=="function"}function cf(e){if(e!=null){if(zo(e))return e;if(e.provider)return e.provider}}var ka;class hb{constructor(t,r,n){B(this,ka);T(this,"fragment");if(ve(this,{fragment:r}),r.inputs.length<n.length)throw new Error("too many arguments");const s=gs(t.runner,"resolveName"),a=zo(s)?s:null;x(this,ka,async function(){const o=await Promise.all(r.inputs.map((c,l)=>n[l]==null?null:c.walkAsync(n[l],(u,h)=>u==="address"?Array.isArray(h)?Promise.all(h.map(m=>At(m,a))):At(h,a):h)));return t.interface.encodeFilterTopics(r,o)}())}getTopicFilter(){return f(this,ka)}}ka=new WeakMap;function gs(e,t){return e==null?null:typeof e[t]=="function"?e:e.provider&&typeof e.provider[t]=="function"?e.provider:null}function Hn(e){return e==null?null:e.provider||null}async function lf(e,t){const r=pt.dereference(e,"overrides");A(typeof r=="object","invalid overrides parameter","overrides",e);const n=xo(r);return A(n.to==null||(t||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),A(n.data==null||(t||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function fb(e,t,r){const n=gs(e,"resolveName"),s=zo(n)?n:null;return await Promise.all(t.map((a,o)=>a.walkAsync(r[o],(c,l)=>(l=pt.dereference(l,c),c==="address"?At(l,s):l))))}function mb(e){const t=async function(o){const c=await lf(o,["data"]);c.to=await e.getAddress(),c.from&&(c.from=await At(c.from,cf(e.runner)));const l=e.interface,d=me(c.value||Md,"overrides.value")===Md,u=(c.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!u&&!d&&A(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),A(l.fallback||u,"cannot send data to receive-only contract","overrides.data",c.data);const h=l.receive||l.fallback&&l.fallback.payable;return A(h||d,"cannot send value to non-payable fallback","overrides.value",c.value),A(l.fallback||u,"cannot send data to receive-only contract","overrides.data",c.data),c},r=async function(o){const c=gs(e.runner,"call");W(sf(c),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await t(o);try{return await c.call(l)}catch(d){throw tl(d)&&d.data?e.interface.makeError(d.data,l):d}},n=async function(o){const c=e.runner;W(of(c),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await c.sendTransaction(await t(o)),d=Hn(e.runner);return new yl(e.interface,d,l)},s=async function(o){const c=gs(e.runner,"estimateGas");return W(af(c),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await c.estimateGas(await t(o))},a=async o=>await n(o);return ve(a,{_contract:e,estimateGas:s,populateTransaction:t,send:n,staticCall:r}),a}function pb(e,t){const r=function(...d){const u=e.interface.getFunction(t,d);return W(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t,args:d}}),u},n=async function(...d){const u=r(...d);let h={};if(u.inputs.length+1===d.length&&(h=await lf(d.pop()),h.from&&(h.from=await At(h.from,cf(e.runner)))),u.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const m=await fb(e.runner,u.inputs,d);return Object.assign({},h,await yt({to:e.getAddress(),data:e.interface.encodeFunctionData(u,m)}))},s=async function(...d){const u=await c(...d);return u.length===1?u[0]:u},a=async function(...d){const u=e.runner;W(of(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const h=await u.sendTransaction(await n(...d)),m=Hn(e.runner);return new yl(e.interface,m,h)},o=async function(...d){const u=gs(e.runner,"estimateGas");return W(af(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await n(...d))},c=async function(...d){const u=gs(e.runner,"call");W(sf(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const h=await n(...d);let m="0x";try{m=await u.call(h)}catch(b){throw tl(b)&&b.data?e.interface.makeError(b.data,h):b}const p=r(...d);return e.interface.decodeFunctionResult(p,m)},l=async(...d)=>r(...d).constant?await s(...d):await a(...d);return ve(l,{name:e.interface.getFunctionName(t),_contract:e,_key:t,getFragment:r,estimateGas:o,populateTransaction:n,send:a,staticCall:s,staticCallResult:c}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=e.interface.getFunction(t);return W(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t}}),d}}),l}function gb(e,t){const r=function(...s){const a=e.interface.getEvent(t,s);return W(a,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t,args:s}}),a},n=function(...s){return new hb(e,r(...s),s)};return ve(n,{name:e.interface.getEventName(t),_contract:e,_key:t,getFragment:r}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const s=e.interface.getEvent(t);return W(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:t}}),s}}),n}const bo=Symbol.for("_ethersInternal_contract"),df=new WeakMap;function xb(e,t){df.set(e[bo],t)}function Mt(e){return df.get(e[bo])}function bb(e){return e&&typeof e=="object"&&"getTopicFilter"in e&&typeof e.getTopicFilter=="function"&&e.fragment}async function wl(e,t){let r,n=null;if(Array.isArray(t)){const a=function(o){if(qe(o,32))return o;const c=e.interface.getEvent(o);return A(c,"unknown fragment","name",o),c.topicHash};r=t.map(o=>o==null?null:Array.isArray(o)?o.map(a):a(o))}else t==="*"?r=[null]:typeof t=="string"?qe(t,32)?r=[t]:(n=e.interface.getEvent(t),A(n,"unknown fragment","event",t),r=[n.topicHash]):bb(t)?r=await t.getTopicFilter():"fragment"in t?(n=t.fragment,r=[n.topicHash]):A(!1,"unknown event name","event",t);r=r.map(a=>{if(a==null)return null;if(Array.isArray(a)){const o=Array.from(new Set(a.map(c=>c.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return a.toLowerCase()});const s=r.map(a=>a==null?"null":Array.isArray(a)?a.join("|"):a).join("&");return{fragment:n,tag:s,topics:r}}async function ea(e,t){const{subs:r}=Mt(e);return r.get((await wl(e,t)).tag)||null}async function _d(e,t,r){const n=Hn(e.runner);W(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:t});const{fragment:s,tag:a,topics:o}=await wl(e,r),{addr:c,subs:l}=Mt(e);let d=l.get(a);if(!d){const h={address:c||e,topics:o},m=v=>{let N=s;if(N==null)try{N=e.interface.getEvent(v.topics[0])}catch{}if(N){const V=N,E=s?e.interface.decodeEventLog(s,v.data,v.topics):[];Gc(e,r,E,Y=>new ub(e,Y,r,V,v))}else Gc(e,r,[],V=>new nf(e,V,r,v))};let p=[];d={tag:a,listeners:[],start:()=>{p.length||p.push(n.on(h,m))},stop:async()=>{if(p.length==0)return;let v=p;p=[],await Promise.all(v),n.off(h,m)}},l.set(a,d)}return d}let Vc=Promise.resolve();async function yb(e,t,r,n){await Vc;const s=await ea(e,t);if(!s)return!1;const a=s.listeners.length;return s.listeners=s.listeners.filter(({listener:o,once:c})=>{const l=Array.from(r);n&&l.push(n(c?null:o));try{o.call(e,...l)}catch{}return!c}),s.listeners.length===0&&(s.stop(),Mt(e).subs.delete(s.tag)),a>0}async function Gc(e,t,r,n){try{await Vc}catch{}const s=yb(e,t,r,n);return Vc=s,await s}const Ka=["then"];var Zd;Zd=bo;const sa=class sa{constructor(t,r,n,s){T(this,"target");T(this,"interface");T(this,"runner");T(this,"filters");T(this,Zd);T(this,"fallback");A(typeof t=="string"||mh(t),"invalid value for Contract target","target",t),n==null&&(n=null);const a=Uc.from(r);ve(this,{target:t,runner:n,interface:a}),Object.defineProperty(this,bo,{value:{}});let o,c=null,l=null;if(s){const h=Hn(n);l=new yl(this.interface,h,s)}let d=new Map;if(typeof t=="string")if(qe(t))c=t,o=Promise.resolve(t);else{const h=gs(n,"resolveName");if(!zo(h))throw Ke("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=h.resolveName(t).then(m=>{if(m==null)throw Ke("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:t});return Mt(this).addr=m,m})}else o=t.getAddress().then(h=>{if(h==null)throw new Error("TODO");return Mt(this).addr=h,h});xb(this,{addrPromise:o,addr:c,deployTx:l,subs:d});const u=new Proxy({},{get:(h,m,p)=>{if(typeof m=="symbol"||Ka.indexOf(m)>=0)return Reflect.get(h,m,p);try{return this.getEvent(m)}catch(b){if(!dt(b,"INVALID_ARGUMENT")||b.argument!=="key")throw b}},has:(h,m)=>Ka.indexOf(m)>=0?Reflect.has(h,m):Reflect.has(h,m)||this.interface.hasEvent(String(m))});return ve(this,{filters:u}),ve(this,{fallback:a.receive||a.fallback?mb(this):null}),new Proxy(this,{get:(h,m,p)=>{if(typeof m=="symbol"||m in h||Ka.indexOf(m)>=0)return Reflect.get(h,m,p);try{return h.getFunction(m)}catch(b){if(!dt(b,"INVALID_ARGUMENT")||b.argument!=="key")throw b}},has:(h,m)=>typeof m=="symbol"||m in h||Ka.indexOf(m)>=0?Reflect.has(h,m):h.interface.hasFunction(m)})}connect(t){return new sa(this.target,this.interface,t)}attach(t){return new sa(t,this.interface,this.runner)}async getAddress(){return await Mt(this).addrPromise}async getDeployedCode(){const t=Hn(this.runner);W(t,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const r=await t.getCode(await this.getAddress());return r==="0x"?null:r}async waitForDeployment(){const t=this.deploymentTransaction();if(t)return await t.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=Hn(this.runner);return W(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((s,a)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return s(this);n.once("block",o)}catch(c){a(c)}};o()})}deploymentTransaction(){return Mt(this).deployTx}getFunction(t){return typeof t!="string"&&(t=t.format()),pb(this,t)}getEvent(t){return typeof t!="string"&&(t=t.format()),gb(this,t)}async queryTransaction(t){throw new Error("@TODO")}async queryFilter(t,r,n){r==null&&(r=0),n==null&&(n="latest");const{addr:s,addrPromise:a}=Mt(this),o=s||await a,{fragment:c,topics:l}=await wl(this,t),d={address:o,topics:l,fromBlock:r,toBlock:n},u=Hn(this.runner);return W(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(d)).map(h=>{let m=c;if(m==null)try{m=this.interface.getEvent(h.topics[0])}catch{}if(m)try{return new bl(h,this.interface,m)}catch(p){return new rf(h,p)}return new Oa(h,u)})}async on(t,r){const n=await _d(this,"on",t);return n.listeners.push({listener:r,once:!1}),n.start(),this}async once(t,r){const n=await _d(this,"once",t);return n.listeners.push({listener:r,once:!0}),n.start(),this}async emit(t,...r){return await Gc(this,t,r,null)}async listenerCount(t){if(t){const s=await ea(this,t);return s?s.listeners.length:0}const{subs:r}=Mt(this);let n=0;for(const{listeners:s}of r.values())n+=s.length;return n}async listeners(t){if(t){const s=await ea(this,t);return s?s.listeners.map(({listener:a})=>a):[]}const{subs:r}=Mt(this);let n=[];for(const{listeners:s}of r.values())n=n.concat(s.map(({listener:a})=>a));return n}async off(t,r){const n=await ea(this,t);if(!n)return this;if(r){const s=n.listeners.map(({listener:a})=>a).indexOf(r);s>=0&&n.listeners.splice(s,1)}return(r==null||n.listeners.length===0)&&(n.stop(),Mt(this).subs.delete(n.tag)),this}async removeAllListeners(t){if(t){const r=await ea(this,t);if(!r)return this;r.stop(),Mt(this).subs.delete(r.tag)}else{const{subs:r}=Mt(this);for(const{tag:n,stop:s}of r.values())s(),r.delete(n)}return this}async addListener(t,r){return await this.on(t,r)}async removeListener(t,r){return await this.off(t,r)}static buildClass(t){class r extends sa{constructor(s,a=null){super(s,t,a)}}return r}static from(t,r,n){return n==null&&(n=null),new this(t,r,n)}};let zc=sa;function wb(){return zc}class hs extends wb(){}function sc(e){return e.match(/^ipfs:\/\/ipfs\//i)?e=e.substring(12):e.match(/^ipfs:\/\//i)?e=e.substring(7):A(!1,"unsupported IPFS format","link",e),`https://gateway.ipfs.io/ipfs/${e}`}class Nb{constructor(t){T(this,"name");ve(this,{name:t})}connect(t){return this}supportsCoinType(t){return!1}async encodeAddress(t,r){throw new Error("unsupported coin")}async decodeAddress(t,r){throw new Error("unsupported coin")}}const uf=new RegExp("^(ipfs)://(.*)$","i"),Ud=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),uf,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var un,es,hn,js,Eo,hf;const Bs=class Bs{constructor(t,r,n){B(this,hn);T(this,"provider");T(this,"address");T(this,"name");B(this,un);B(this,es);ve(this,{provider:t,address:r,name:n}),x(this,un,null),x(this,es,new hs(r,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],t))}async supportsWildcard(){return f(this,un)==null&&x(this,un,(async()=>{try{return await f(this,es).supportsInterface("0x9061b923")}catch(t){if(dt(t,"CALL_EXCEPTION"))return!1;throw x(this,un,null),t}})()),await f(this,un)}async getAddress(t){if(t==null&&(t=60),t===60)try{const a=await te(this,hn,js).call(this,"addr(bytes32)");return a==null||a===oa?null:a}catch(a){if(dt(a,"CALL_EXCEPTION"))return null;throw a}if(t>=0&&t<2147483648){let a=t+2147483648;const o=await te(this,hn,js).call(this,"addr(bytes32,uint)",[a]);if(qe(o,20))return Ue(o)}let r=null;for(const a of this.provider.plugins)if(a instanceof Nb&&a.supportsCoinType(t)){r=a;break}if(r==null)return null;const n=await te(this,hn,js).call(this,"addr(bytes32,uint)",[t]);if(n==null||n==="0x")return null;const s=await r.decodeAddress(t,n);if(s!=null)return s;W(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${t})`,info:{coinType:t,data:n}})}async getText(t){const r=await te(this,hn,js).call(this,"text(bytes32,string)",[t]);return r==null||r==="0x"?null:r}async getContentHash(){const t=await te(this,hn,js).call(this,"contenthash(bytes32)");if(t==null||t==="0x")return null;const r=t.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(r){const s=r[1]==="e3010170"?"ipfs":"ipns",a=parseInt(r[4],16);if(r[5].length===a*2)return`${s}://${Em("0x"+r[2])}`}const n=t.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;W(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:t}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const t=[{type:"name",value:this.name}];try{const r=await this.getText("avatar");if(r==null)return t.push({type:"!avatar",value:""}),{url:null,linkage:t};t.push({type:"avatar",value:r});for(let n=0;n<Ud.length;n++){const s=r.match(Ud[n]);if(s==null)continue;const a=s[1].toLowerCase();switch(a){case"https":case"data":return t.push({type:"url",value:r}),{linkage:t,url:r};case"ipfs":{const o=sc(r);return t.push({type:"ipfs",value:r}),t.push({type:"url",value:o}),{linkage:t,url:o}}case"erc721":case"erc1155":{const o=a==="erc721"?"tokenURI(uint256)":"uri(uint256)";t.push({type:a,value:r});const c=await this.getAddress();if(c==null)return t.push({type:"!owner",value:""}),{url:null,linkage:t};const l=(s[2]||"").split("/");if(l.length!==2)return t.push({type:`!${a}caip`,value:s[2]||""}),{url:null,linkage:t};const d=l[1],u=new hs(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(a==="erc721"){const g=await u.ownerOf(d);if(c!==g)return t.push({type:"!owner",value:g}),{url:null,linkage:t};t.push({type:"owner",value:g})}else if(a==="erc1155"){const g=await u.balanceOf(c,d);if(!g)return t.push({type:"!balance",value:"0"}),{url:null,linkage:t};t.push({type:"balance",value:g.toString()})}let h=await u[o](d);if(h==null||h==="0x")return t.push({type:"!metadata-url",value:""}),{url:null,linkage:t};t.push({type:"metadata-url-base",value:h}),a==="erc1155"&&(h=h.replace("{id}",vn(d,32).substring(2)),t.push({type:"metadata-url-expanded",value:h})),h.match(/^ipfs:/i)&&(h=sc(h)),t.push({type:"metadata-url",value:h});let m={};const p=await new Ir(h).send();p.assertOk();try{m=p.bodyJson}catch{try{t.push({type:"!metadata",value:p.bodyText})}catch{const N=p.body;return N&&t.push({type:"!metadata",value:ue(N)}),{url:null,linkage:t}}return{url:null,linkage:t}}if(!m)return t.push({type:"!metadata",value:""}),{url:null,linkage:t};t.push({type:"metadata",value:JSON.stringify(m)});let b=m.image;if(typeof b!="string")return t.push({type:"!imageUrl",value:""}),{url:null,linkage:t};if(!b.match(/^(https:\/\/|data:)/i)){if(b.match(uf)==null)return t.push({type:"!imageUrl-ipfs",value:b}),{url:null,linkage:t};t.push({type:"imageUrl-ipfs",value:b}),b=sc(b)}return t.push({type:"url",value:b}),{linkage:t,url:b}}}}}catch{}return{linkage:t,url:null}}static async getEnsAddress(t){const r=await t.getNetwork(),n=r.getPlugin("org.ethers.plugins.network.Ens");return W(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:r}}),n.address}static async fromName(t,r){var s;let n=r;for(;;){if(n===""||n==="."||r!=="eth"&&n==="eth")return null;const a=await te(s=Bs,Eo,hf).call(s,t,n);if(a!=null){const o=new Bs(t,a,r);return n!==r&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};un=new WeakMap,es=new WeakMap,hn=new WeakSet,js=async function(t,r){r=(r||[]).slice();const n=f(this,es).interface;r.unshift(Mc(this.name));let s=null;await this.supportsWildcard()&&(s=n.getFunction(t),W(s,"missing fragment","UNKNOWN_ERROR",{info:{funcName:t}}),r=[_x(this.name,255),n.encodeFunctionData(s,r)],t="resolve(bytes,bytes)"),r.push({enableCcipRead:!0});try{const a=await f(this,es)[t](...r);return s?n.decodeFunctionResult(s,a)[0]:a}catch(a){if(!dt(a,"CALL_EXCEPTION"))throw a}return null},Eo=new WeakSet,hf=async function(t,r){const n=await Bs.getEnsAddress(t);try{const a=await new hs(n,["function resolver(bytes32) view returns (address)"],t).resolver(Mc(r),{enableCcipRead:!0});return a===oa?null:a}catch(s){throw s}return null},B(Bs,Eo);let yo=Bs;const Vd=BigInt(0);function Oe(e,t){return function(r){return r==null?t:e(r)}}function xa(e,t){return r=>{if(t&&r==null)return null;if(!Array.isArray(r))throw new Error("not an array");return r.map(n=>e(n))}}function Ma(e,t){return r=>{const n={};for(const s in e){let a=s;if(t&&s in t&&!(a in r)){for(const o of t[s])if(o in r){a=o;break}}try{const o=e[s](r[a]);o!==void 0&&(n[s]=o)}catch(o){const c=o instanceof Error?o.message:"not-an-error";W(!1,`invalid value for value.${s} (${c})`,"BAD_DATA",{value:r})}}return n}}function Ab(e){switch(e){case!0:case"true":return!0;case!1:case"false":return!1}A(!1,`invalid boolean; ${JSON.stringify(e)}`,"value",e)}function Ui(e){return A(qe(e,!0),"invalid data","value",e),e}function lt(e){return A(qe(e,32),"invalid hash","value",e),e}const vb=Ma({address:Ue,blockHash:lt,blockNumber:Se,data:Ui,index:Se,removed:Oe(Ab,!1),topics:xa(lt),transactionHash:lt,transactionIndex:Se},{index:["logIndex"]});function Eb(e){return vb(e)}const kb=Ma({hash:Oe(lt),parentHash:lt,parentBeaconBlockRoot:Oe(lt,null),number:Se,timestamp:Se,nonce:Oe(Ui),difficulty:me,gasLimit:me,gasUsed:me,stateRoot:Oe(lt,null),receiptsRoot:Oe(lt,null),blobGasUsed:Oe(me,null),excessBlobGas:Oe(me,null),miner:Oe(Ue),prevRandao:Oe(lt,null),extraData:Ui,baseFeePerGas:Oe(me)},{prevRandao:["mixHash"]});function Cb(e){const t=kb(e);return t.transactions=e.transactions.map(r=>typeof r=="string"?r:ff(r)),t}const Tb=Ma({transactionIndex:Se,blockNumber:Se,transactionHash:lt,address:Ue,topics:xa(lt),data:Ui,index:Se,blockHash:lt},{index:["logIndex"]});function jb(e){return Tb(e)}const Sb=Ma({to:Oe(Ue,null),from:Oe(Ue,null),contractAddress:Oe(Ue,null),index:Se,root:Oe(ue),gasUsed:me,blobGasUsed:Oe(me,null),logsBloom:Oe(Ui),blockHash:lt,hash:lt,logs:xa(jb),blockNumber:Se,cumulativeGasUsed:me,effectiveGasPrice:Oe(me),blobGasPrice:Oe(me,null),status:Oe(Se),type:Oe(Se,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function Fb(e){return Sb(e)}function ff(e){e.to&&me(e.to)===Vd&&(e.to="0x0000000000000000000000000000000000000000");const t=Ma({hash:lt,index:Oe(Se,void 0),type:r=>r==="0x"||r==null?0:Se(r),accessList:Oe(bs,null),blobVersionedHashes:Oe(xa(lt,!0),null),authorizationList:Oe(xa(r=>{let n;if(r.signature)n=r.signature;else{let s=r.yParity;s==="0x1b"?s=0:s==="0x1c"&&(s=1),n=Object.assign({},r,{yParity:s})}return{address:Ue(r.address),chainId:me(r.chainId),nonce:me(r.nonce),signature:Rt.from(n)}},!1),null),blockHash:Oe(lt,null),blockNumber:Oe(Se,null),transactionIndex:Oe(Se,null),from:Ue,gasPrice:Oe(me),maxPriorityFeePerGas:Oe(me),maxFeePerGas:Oe(me),maxFeePerBlobGas:Oe(me,null),gasLimit:me,to:Oe(Ue,null),value:me,nonce:Se,data:Ui,creates:Oe(Ue,null),chainId:Oe(me,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(e);if(t.to==null&&t.creates==null&&(t.creates=yg(t)),(e.type===1||e.type===2)&&e.accessList==null&&(t.accessList=[]),e.signature?t.signature=Rt.from(e.signature):t.signature=Rt.from(e),t.chainId==null){const r=t.signature.legacyChainId;r!=null&&(t.chainId=r)}return t.blockHash&&me(t.blockHash)===Vd&&(t.blockHash=null),t}const Rb="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class qi{constructor(t){T(this,"name");ve(this,{name:t})}clone(){return new qi(this.name)}}class Ho extends qi{constructor(r,n){r==null&&(r=0);super(`org.ethers.network.plugins.GasCost#${r||0}`);T(this,"effectiveBlock");T(this,"txBase");T(this,"txCreate");T(this,"txDataZero");T(this,"txDataNonzero");T(this,"txAccessListStorageKey");T(this,"txAccessListAddress");const s={effectiveBlock:r};function a(o,c){let l=(n||{})[o];l==null&&(l=c),A(typeof l=="number",`invalud value for ${o}`,"costs",n),s[o]=l}a("txBase",21e3),a("txCreate",32e3),a("txDataZero",4),a("txDataNonzero",16),a("txAccessListStorageKey",1900),a("txAccessListAddress",2400),ve(this,s)}clone(){return new Ho(this.effectiveBlock,this)}}class $o extends qi{constructor(r,n){super("org.ethers.plugins.network.Ens");T(this,"address");T(this,"targetNetwork");ve(this,{address:r||Rb,targetNetwork:n??1})}clone(){return new $o(this.address,this.targetNetwork)}}var ts;const Cl=class Cl extends qi{constructor(r){super("org.ethers.plugins.network.FeeData");B(this,ts);x(this,ts,r)}get feeDataFunc(){return f(this,ts)}async getFeeData(r){return await f(this,ts).call(this,r)}clone(){return new Cl(f(this,ts))}};ts=new WeakMap;let Gd=Cl;var Ca,Ta;class Pb extends qi{constructor(r,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");B(this,Ca);B(this,Ta);x(this,Ca,r),x(this,Ta,n)}get url(){return f(this,Ca)}get processFunc(){return f(this,Ta)}clone(){return this}}Ca=new WeakMap,Ta=new WeakMap;const ic=new Map;var ui,hi,fn;const Os=class Os{constructor(t,r){B(this,ui);B(this,hi);B(this,fn);x(this,ui,t),x(this,hi,me(r)),x(this,fn,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return f(this,ui)}set name(t){x(this,ui,t)}get chainId(){return f(this,hi)}set chainId(t){x(this,hi,me(t,"chainId"))}matches(t){if(t==null)return!1;if(typeof t=="string"){try{return this.chainId===me(t)}catch{}return this.name===t}if(typeof t=="number"||typeof t=="bigint"){try{return this.chainId===me(t)}catch{}return!1}if(typeof t=="object"){if(t.chainId!=null){try{return this.chainId===me(t.chainId)}catch{}return!1}return t.name!=null?this.name===t.name:!1}return!1}get plugins(){return Array.from(f(this,fn).values())}attachPlugin(t){if(f(this,fn).get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return f(this,fn).set(t.name,t.clone()),this}getPlugin(t){return f(this,fn).get(t)||null}getPlugins(t){return this.plugins.filter(r=>r.name.split("#")[0]===t)}clone(){const t=new Os(this.name,this.chainId);return this.plugins.forEach(r=>{t.attachPlugin(r.clone())}),t}computeIntrinsicGas(t){const r=this.getPlugin("org.ethers.plugins.network.GasCost")||new Ho;let n=r.txBase;if(t.to==null&&(n+=r.txCreate),t.data)for(let s=2;s<t.data.length;s+=2)t.data.substring(s,s+2)==="00"?n+=r.txDataZero:n+=r.txDataNonzero;if(t.accessList){const s=bs(t.accessList);for(const a in s)n+=r.txAccessListAddress+r.txAccessListStorageKey*s[a].storageKeys.length}return n}static from(t){if(Bb(),t==null)return Os.from("mainnet");if(typeof t=="number"&&(t=BigInt(t)),typeof t=="string"||typeof t=="bigint"){const r=ic.get(t);if(r)return r();if(typeof t=="bigint")return new Os("unknown",t);A(!1,"unknown network","network",t)}if(typeof t.clone=="function")return t.clone();if(typeof t=="object"){A(typeof t.name=="string"&&typeof t.chainId=="number","invalid network object name or chainId","network",t);const r=new Os(t.name,t.chainId);return(t.ensAddress||t.ensNetwork!=null)&&r.attachPlugin(new $o(t.ensAddress,t.ensNetwork)),r}A(!1,"invalid network","network",t)}static register(t,r){typeof t=="number"&&(t=BigInt(t));const n=ic.get(t);n&&A(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",t),ic.set(t,r)}};ui=new WeakMap,hi=new WeakMap,fn=new WeakMap;let Nr=Os;function zd(e,t){const r=String(e);if(!r.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${e}`);const n=r.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${e}`);for(;n[1].length<t;)n[1]+="0";if(n[1].length>9){let s=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||s++,n[1]=s.toString()}return BigInt(n[0]+n[1])}function Hd(e){return new Pb(e,async(t,r,n)=>{n.setHeader("User-Agent","ethers");let s;try{const[a,o]=await Promise.all([n.send(),t()]);s=a;const c=s.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:zd(c.maxFee,9),maxPriorityFeePerGas:zd(c.maxPriorityFee,9)}}catch(a){W(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:s,error:a})}})}let $d=!1;function Bb(){if($d)return;$d=!0;function e(t,r,n){const s=function(){const a=new Nr(t,r);return n.ensNetwork!=null&&a.attachPlugin(new $o(null,n.ensNetwork)),a.attachPlugin(new Ho),(n.plugins||[]).forEach(o=>{a.attachPlugin(o)}),a};Nr.register(t,s),Nr.register(r,s),n.altNames&&n.altNames.forEach(a=>{Nr.register(a,s)})}e("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),e("ropsten",3,{ensNetwork:3}),e("rinkeby",4,{ensNetwork:4}),e("goerli",5,{ensNetwork:5}),e("kovan",42,{ensNetwork:42}),e("sepolia",11155111,{ensNetwork:11155111}),e("holesky",17e3,{ensNetwork:17e3}),e("classic",61,{}),e("classicKotti",6,{}),e("arbitrum",42161,{ensNetwork:1}),e("arbitrum-goerli",421613,{}),e("arbitrum-sepolia",421614,{}),e("base",8453,{ensNetwork:1}),e("base-goerli",84531,{}),e("base-sepolia",84532,{}),e("bnb",56,{ensNetwork:1}),e("bnbt",97,{}),e("linea",59144,{ensNetwork:1}),e("linea-goerli",59140,{}),e("linea-sepolia",59141,{}),e("matic",137,{ensNetwork:1,plugins:[Hd("https://gasstation.polygon.technology/v2")]}),e("matic-amoy",80002,{}),e("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[Hd("https://gasstation-testnet.polygon.technology/v2")]}),e("optimism",10,{ensNetwork:1,plugins:[]}),e("optimism-goerli",420,{}),e("optimism-sepolia",11155420,{}),e("xdai",100,{ensNetwork:1})}function Hc(e){return JSON.parse(JSON.stringify(e))}var Ur,qt,mn,gr,fi,to;class Ob{constructor(t){B(this,fi);B(this,Ur);B(this,qt);B(this,mn);B(this,gr);x(this,Ur,t),x(this,qt,null),x(this,mn,4e3),x(this,gr,-2)}get pollingInterval(){return f(this,mn)}set pollingInterval(t){x(this,mn,t)}start(){f(this,qt)||(x(this,qt,f(this,Ur)._setTimeout(te(this,fi,to).bind(this),f(this,mn))),te(this,fi,to).call(this))}stop(){f(this,qt)&&(f(this,Ur)._clearTimeout(f(this,qt)),x(this,qt,null))}pause(t){this.stop(),t&&x(this,gr,-2)}resume(){this.start()}}Ur=new WeakMap,qt=new WeakMap,mn=new WeakMap,gr=new WeakMap,fi=new WeakSet,to=async function(){try{const t=await f(this,Ur).getBlockNumber();if(f(this,gr)===-2){x(this,gr,t);return}if(t!==f(this,gr)){for(let r=f(this,gr)+1;r<=t;r++){if(f(this,qt)==null)return;await f(this,Ur).emit("block",r)}x(this,gr,t)}}catch{}f(this,qt)!=null&&x(this,qt,f(this,Ur)._setTimeout(te(this,fi,to).bind(this),f(this,mn)))};var rs,ns,pn;class Nl{constructor(t){B(this,rs);B(this,ns);B(this,pn);x(this,rs,t),x(this,pn,!1),x(this,ns,r=>{this._poll(r,f(this,rs))})}async _poll(t,r){throw new Error("sub-classes must override this")}start(){f(this,pn)||(x(this,pn,!0),f(this,ns).call(this,-2),f(this,rs).on("block",f(this,ns)))}stop(){f(this,pn)&&(x(this,pn,!1),f(this,rs).off("block",f(this,ns)))}pause(t){this.stop()}resume(){this.start()}}rs=new WeakMap,ns=new WeakMap,pn=new WeakMap;var mi,Vr;class Mb extends Nl{constructor(r,n){super(r);B(this,mi);B(this,Vr);x(this,mi,n),x(this,Vr,-2)}pause(r){r&&x(this,Vr,-2),super.pause(r)}async _poll(r,n){const s=await n.getBlock(f(this,mi));s!=null&&(f(this,Vr)===-2?x(this,Vr,s.number):s.number>f(this,Vr)&&(n.emit(f(this,mi),s.number),x(this,Vr,s.number)))}}mi=new WeakMap,Vr=new WeakMap;var ko;class _b extends Nl{constructor(r,n){super(r);B(this,ko);x(this,ko,Hc(n))}async _poll(r,n){throw new Error("@TODO")}}ko=new WeakMap;var pi;class Ub extends Nl{constructor(r,n){super(r);B(this,pi);x(this,pi,n)}async _poll(r,n){const s=await n.getTransactionReceipt(f(this,pi));s&&n.emit(f(this,pi),s)}}pi=new WeakMap;var Gr,gi,xi,gn,Jt,Co,mf;class Al{constructor(t,r){B(this,Co);B(this,Gr);B(this,gi);B(this,xi);B(this,gn);B(this,Jt);x(this,Gr,t),x(this,gi,Hc(r)),x(this,xi,te(this,Co,mf).bind(this)),x(this,gn,!1),x(this,Jt,-2)}start(){f(this,gn)||(x(this,gn,!0),f(this,Jt)===-2&&f(this,Gr).getBlockNumber().then(t=>{x(this,Jt,t)}),f(this,Gr).on("block",f(this,xi)))}stop(){f(this,gn)&&(x(this,gn,!1),f(this,Gr).off("block",f(this,xi)))}pause(t){this.stop(),t&&x(this,Jt,-2)}resume(){this.start()}}Gr=new WeakMap,gi=new WeakMap,xi=new WeakMap,gn=new WeakMap,Jt=new WeakMap,Co=new WeakSet,mf=async function(t){if(f(this,Jt)===-2)return;const r=Hc(f(this,gi));r.fromBlock=f(this,Jt)+1,r.toBlock=t;const n=await f(this,Gr).getLogs(r);if(n.length===0){f(this,Jt)<t-60&&x(this,Jt,t-60);return}for(const s of n)f(this,Gr).emit(f(this,gi),s),x(this,Jt,s.blockNumber)};const Vb=BigInt(2),Gb=10;function Ia(e){return e&&typeof e.then=="function"}function ro(e,t){return e+":"+JSON.stringify(t,(r,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n);return s.sort(),s.reduce((a,o)=>(a[o]=n[o],a),{})}return n})}class pf{constructor(t){T(this,"name");ve(this,{name:t})}start(){}stop(){}pause(t){}resume(){}}function zb(e){return JSON.parse(JSON.stringify(e))}function $c(e){return e=Array.from(new Set(e).values()),e.sort(),e}async function ac(e,t){if(e==null)throw new Error("invalid event");if(Array.isArray(e)&&(e={topics:e}),typeof e=="string")switch(e){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:e,tag:e}}if(qe(e,32)){const r=e.toLowerCase();return{type:"transaction",tag:ro("tx",{hash:r}),hash:r}}if(e.orphan){const r=e;return{type:"orphan",tag:ro("orphan",r),filter:zb(r)}}if(e.address||e.topics){const r=e,n={topics:(r.topics||[]).map(s=>s==null?null:Array.isArray(s)?$c(s.map(a=>a.toLowerCase())):s.toLowerCase())};if(r.address){const s=[],a=[],o=c=>{qe(c)?s.push(c):a.push((async()=>{s.push(await At(c,t))})())};Array.isArray(r.address)?r.address.forEach(o):o(r.address),a.length&&await Promise.all(a),n.address=$c(s.map(c=>c.toLowerCase()))}return{filter:n,tag:ro("event",n),type:"event"}}A(!1,"unknown ProviderEvent","event",e)}function oc(){return new Date().getTime()}const Hb={cacheTimeout:250,pollingInterval:4e3};var ft,xn,mt,bi,Gt,ss,bn,zr,ja,Kt,yi,wi,Be,Ot,Qc,qc,ta,Jc,ra,no;class $b{constructor(t,r){B(this,Be);B(this,ft);B(this,xn);B(this,mt);B(this,bi);B(this,Gt);B(this,ss);B(this,bn);B(this,zr);B(this,ja);B(this,Kt);B(this,yi);B(this,wi);if(x(this,wi,Object.assign({},Hb,r||{})),t==="any")x(this,ss,!0),x(this,Gt,null);else if(t){const n=Nr.from(t);x(this,ss,!1),x(this,Gt,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else x(this,ss,!1),x(this,Gt,null);x(this,zr,-1),x(this,bn,new Map),x(this,ft,new Map),x(this,xn,new Map),x(this,mt,null),x(this,bi,!1),x(this,ja,1),x(this,Kt,new Map),x(this,yi,!1)}get pollingInterval(){return f(this,wi).pollingInterval}get provider(){return this}get plugins(){return Array.from(f(this,xn).values())}attachPlugin(t){if(f(this,xn).get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return f(this,xn).set(t.name,t.connect(this)),this}getPlugin(t){return f(this,xn).get(t)||null}get disableCcipRead(){return f(this,yi)}set disableCcipRead(t){x(this,yi,!!t)}async ccipReadFetch(t,r,n){if(this.disableCcipRead||n.length===0||t.to==null)return null;const s=t.to.toLowerCase(),a=r.toLowerCase(),o=[];for(let c=0;c<n.length;c++){const l=n[c],d=l.replace("{sender}",s).replace("{data}",a),u=new Ir(d);l.indexOf("{data}")===-1&&(u.body={data:a,sender:s}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:c,urls:n});let h="unknown error",m;try{m=await u.send()}catch(p){o.push(p.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:p}});continue}try{const p=m.bodyJson;if(p.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:p}),p.data;p.message&&(h=p.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:p})}catch{}W(m.statusCode<400||m.statusCode>=500,`response not found during CCIP fetch: ${h}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:t,info:{url:l,errorMessage:h}}),o.push(h)}W(!1,`error encountered during CCIP fetch: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:t,info:{urls:n,errorMessages:o}})}_wrapBlock(t,r){return new ob(Cb(t),this)}_wrapLog(t,r){return new Oa(Eb(t),this)}_wrapTransactionReceipt(t,r){return new Dh(Fb(t),this)}_wrapTransactionResponse(t,r){return new ga(ff(t),this)}_detectNetwork(){W(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(t){W(!1,`unsupported method: ${t.method}`,"UNSUPPORTED_OPERATION",{operation:t.method,info:t})}async getBlockNumber(){const t=Se(await te(this,Be,Ot).call(this,{method:"getBlockNumber"}),"%response");return f(this,zr)>=0&&x(this,zr,t),t}_getAddress(t){return At(t,this)}_getBlockTag(t){if(t==null)return"latest";switch(t){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return t}if(qe(t))return qe(t,32)?t:sr(t);if(typeof t=="bigint"&&(t=Se(t,"blockTag")),typeof t=="number")return t>=0?sr(t):f(this,zr)>=0?sr(f(this,zr)+t):this.getBlockNumber().then(r=>sr(r+t));A(!1,"invalid blockTag","blockTag",t)}_getFilter(t){const r=(t.topics||[]).map(l=>l==null?null:Array.isArray(l)?$c(l.map(d=>d.toLowerCase())):l.toLowerCase()),n="blockHash"in t?t.blockHash:void 0,s=(l,d,u)=>{let h;switch(l.length){case 0:break;case 1:h=l[0];break;default:l.sort(),h=l}if(n&&(d!=null||u!=null))throw new Error("invalid filter");const m={};return h&&(m.address=h),r.length&&(m.topics=r),d&&(m.fromBlock=d),u&&(m.toBlock=u),n&&(m.blockHash=n),m};let a=[];if(t.address)if(Array.isArray(t.address))for(const l of t.address)a.push(this._getAddress(l));else a.push(this._getAddress(t.address));let o;"fromBlock"in t&&(o=this._getBlockTag(t.fromBlock));let c;return"toBlock"in t&&(c=this._getBlockTag(t.toBlock)),a.filter(l=>typeof l!="string").length||o!=null&&typeof o!="string"||c!=null&&typeof c!="string"?Promise.all([Promise.all(a),o,c]).then(l=>s(l[0],l[1],l[2])):s(a,o,c)}_getTransactionRequest(t){const r=xo(t),n=[];if(["to","from"].forEach(s=>{if(r[s]==null)return;const a=At(r[s],this);Ia(a)?n.push(async function(){r[s]=await a}()):r[s]=a}),r.blockTag!=null){const s=this._getBlockTag(r.blockTag);Ia(s)?n.push(async function(){r.blockTag=await s}()):r.blockTag=s}return n.length?async function(){return await Promise.all(n),r}():r}async getNetwork(){if(f(this,Gt)==null){const s=(async()=>{try{const a=await this._detectNetwork();return this.emit("network",a,null),a}catch(a){throw f(this,Gt)===s&&x(this,Gt,null),a}})();return x(this,Gt,s),(await s).clone()}const t=f(this,Gt),[r,n]=await Promise.all([t,this._detectNetwork()]);return r.chainId!==n.chainId&&(f(this,ss)?(this.emit("network",n,r),f(this,Gt)===t&&x(this,Gt,Promise.resolve(n))):W(!1,`network changed: ${r.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),r.clone()}async getFeeData(){const t=await this.getNetwork(),r=async()=>{const{_block:s,gasPrice:a,priorityFee:o}=await yt({_block:te(this,Be,Jc).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await te(this,Be,Ot).call(this,{method:"getGasPrice"});return me(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await te(this,Be,Ot).call(this,{method:"getPriorityFee"});return me(u,"%response")}catch{}return null})()});let c=null,l=null;const d=this._wrapBlock(s,t);return d&&d.baseFeePerGas&&(l=o??BigInt("1000000000"),c=d.baseFeePerGas*Vb+l),new Od(a,c,l)},n=t.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const s=new Ir(n.url),a=await n.processFunc(r,this,s);return new Od(a.gasPrice,a.maxFeePerGas,a.maxPriorityFeePerGas)}return await r()}async estimateGas(t){let r=this._getTransactionRequest(t);return Ia(r)&&(r=await r),me(await te(this,Be,Ot).call(this,{method:"estimateGas",transaction:r}),"%response")}async call(t){const{tx:r,blockTag:n}=await yt({tx:this._getTransactionRequest(t),blockTag:this._getBlockTag(t.blockTag)});return await te(this,Be,qc).call(this,te(this,Be,Qc).call(this,r,n,t.enableCcipRead?0:-1))}async getBalance(t,r){return me(await te(this,Be,ta).call(this,{method:"getBalance"},t,r),"%response")}async getTransactionCount(t,r){return Se(await te(this,Be,ta).call(this,{method:"getTransactionCount"},t,r),"%response")}async getCode(t,r){return ue(await te(this,Be,ta).call(this,{method:"getCode"},t,r))}async getStorage(t,r,n){const s=me(r,"position");return ue(await te(this,Be,ta).call(this,{method:"getStorage",position:s},t,n))}async broadcastTransaction(t){const{blockNumber:r,hash:n,network:s}=await yt({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:t}),network:this.getNetwork()}),a=uo.from(t);if(a.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(a,s).replaceableTransaction(r)}async getBlock(t,r){const{network:n,params:s}=await yt({network:this.getNetwork(),params:te(this,Be,Jc).call(this,t,!!r)});return s==null?null:this._wrapBlock(s,n)}async getTransaction(t){const{network:r,params:n}=await yt({network:this.getNetwork(),params:te(this,Be,Ot).call(this,{method:"getTransaction",hash:t})});return n==null?null:this._wrapTransactionResponse(n,r)}async getTransactionReceipt(t){const{network:r,params:n}=await yt({network:this.getNetwork(),params:te(this,Be,Ot).call(this,{method:"getTransactionReceipt",hash:t})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const s=await te(this,Be,Ot).call(this,{method:"getTransaction",hash:t});if(s==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=s.gasPrice}return this._wrapTransactionReceipt(n,r)}async getTransactionResult(t){const{result:r}=await yt({network:this.getNetwork(),result:te(this,Be,Ot).call(this,{method:"getTransactionResult",hash:t})});return r==null?null:ue(r)}async getLogs(t){let r=this._getFilter(t);Ia(r)&&(r=await r);const{network:n,params:s}=await yt({network:this.getNetwork(),params:te(this,Be,Ot).call(this,{method:"getLogs",filter:r})});return s.map(a=>this._wrapLog(a,n))}_getProvider(t){W(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(t){return await yo.fromName(this,t)}async getAvatar(t){const r=await this.getResolver(t);return r?await r.getAvatar():null}async resolveName(t){const r=await this.getResolver(t);return r?await r.getAddress():null}async lookupAddress(t){t=Ue(t);const r=Mc(t.substring(2).toLowerCase()+".addr.reverse");try{const n=await yo.getEnsAddress(this),a=await new hs(n,["function resolver(bytes32) view returns (address)"],this).resolver(r);if(a==null||a===oa)return null;const c=await new hs(a,["function name(bytes32) view returns (string)"],this).name(r);return await this.resolveName(c)!==t?null:c}catch(n){if(dt(n,"BAD_DATA")&&n.value==="0x"||dt(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(t,r,n){const s=r??1;return s===0?this.getTransactionReceipt(t):new Promise(async(a,o)=>{let c=null;const l=async d=>{try{const u=await this.getTransactionReceipt(t);if(u!=null&&d-u.blockNumber+1>=s){a(u),c&&(clearTimeout(c),c=null);return}}catch(u){console.log("EEE",u)}this.once("block",l)};n!=null&&(c=setTimeout(()=>{c!=null&&(c=null,this.off("block",l),o(Ke("timeout","TIMEOUT",{reason:"timeout"})))},n)),l(await this.getBlockNumber())})}async waitForBlock(t){W(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(t){const r=f(this,Kt).get(t);r&&(r.timer&&clearTimeout(r.timer),f(this,Kt).delete(t))}_setTimeout(t,r){r==null&&(r=0);const n=Ii(this,ja)._++,s=()=>{f(this,Kt).delete(n),t()};if(this.paused)f(this,Kt).set(n,{timer:null,func:s,time:r});else{const a=setTimeout(s,r);f(this,Kt).set(n,{timer:a,func:s,time:oc()})}return n}_forEachSubscriber(t){for(const r of f(this,ft).values())t(r.subscriber)}_getSubscriber(t){switch(t.type){case"debug":case"error":case"network":return new pf(t.type);case"block":{const r=new Ob(this);return r.pollingInterval=this.pollingInterval,r}case"safe":case"finalized":return new Mb(this,t.type);case"event":return new Al(this,t.filter);case"transaction":return new Ub(this,t.hash);case"orphan":return new _b(this,t.filter)}throw new Error(`unsupported event: ${t.type}`)}_recoverSubscriber(t,r){for(const n of f(this,ft).values())if(n.subscriber===t){n.started&&n.subscriber.stop(),n.subscriber=r,n.started&&r.start(),f(this,mt)!=null&&r.pause(f(this,mt));break}}async on(t,r){const n=await te(this,Be,no).call(this,t);return n.listeners.push({listener:r,once:!1}),n.started||(n.subscriber.start(),n.started=!0,f(this,mt)!=null&&n.subscriber.pause(f(this,mt))),this}async once(t,r){const n=await te(this,Be,no).call(this,t);return n.listeners.push({listener:r,once:!0}),n.started||(n.subscriber.start(),n.started=!0,f(this,mt)!=null&&n.subscriber.pause(f(this,mt))),this}async emit(t,...r){const n=await te(this,Be,ra).call(this,t,r);if(!n||n.listeners.length===0)return!1;const s=n.listeners.length;return n.listeners=n.listeners.filter(({listener:a,once:o})=>{const c=new vu(this,o?null:a,t);try{a.call(this,...r,c)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),f(this,ft).delete(n.tag)),s>0}async listenerCount(t){if(t){const n=await te(this,Be,ra).call(this,t);return n?n.listeners.length:0}let r=0;for(const{listeners:n}of f(this,ft).values())r+=n.length;return r}async listeners(t){if(t){const n=await te(this,Be,ra).call(this,t);return n?n.listeners.map(({listener:s})=>s):[]}let r=[];for(const{listeners:n}of f(this,ft).values())r=r.concat(n.map(({listener:s})=>s));return r}async off(t,r){const n=await te(this,Be,ra).call(this,t);if(!n)return this;if(r){const s=n.listeners.map(({listener:a})=>a).indexOf(r);s>=0&&n.listeners.splice(s,1)}return(!r||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),f(this,ft).delete(n.tag)),this}async removeAllListeners(t){if(t){const{tag:r,started:n,subscriber:s}=await te(this,Be,no).call(this,t);n&&s.stop(),f(this,ft).delete(r)}else for(const[r,{started:n,subscriber:s}]of f(this,ft))n&&s.stop(),f(this,ft).delete(r);return this}async addListener(t,r){return await this.on(t,r)}async removeListener(t,r){return this.off(t,r)}get destroyed(){return f(this,bi)}destroy(){this.removeAllListeners();for(const t of f(this,Kt).keys())this._clearTimeout(t);x(this,bi,!0)}get paused(){return f(this,mt)!=null}set paused(t){!!t!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(t){if(x(this,zr,-1),f(this,mt)!=null){if(f(this,mt)==!!t)return;W(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(r=>r.pause(t)),x(this,mt,!!t);for(const r of f(this,Kt).values())r.timer&&clearTimeout(r.timer),r.time=oc()-r.time}resume(){if(f(this,mt)!=null){this._forEachSubscriber(t=>t.resume()),x(this,mt,null);for(const t of f(this,Kt).values()){let r=t.time;r<0&&(r=0),t.time=oc(),setTimeout(t.func,r)}}}}ft=new WeakMap,xn=new WeakMap,mt=new WeakMap,bi=new WeakMap,Gt=new WeakMap,ss=new WeakMap,bn=new WeakMap,zr=new WeakMap,ja=new WeakMap,Kt=new WeakMap,yi=new WeakMap,wi=new WeakMap,Be=new WeakSet,Ot=async function(t){const r=f(this,wi).cacheTimeout;if(r<0)return await this._perform(t);const n=ro(t.method,t);let s=f(this,bn).get(n);return s||(s=this._perform(t),f(this,bn).set(n,s),setTimeout(()=>{f(this,bn).get(n)===s&&f(this,bn).delete(n)},r)),await s},Qc=async function(t,r,n){W(n<Gb,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},t,{blockTag:r,enableCcipRead:!0})});const s=xo(t);try{return ue(await this._perform({method:"call",transaction:s,blockTag:r}))}catch(a){if(!this.disableCcipRead&&tl(a)&&a.data&&n>=0&&r==="latest"&&s.to!=null&&Ie(a.data,0,4)==="0x556f1830"){const o=a.data,c=await At(s.to,this);let l;try{l=Ib(Ie(a.data,4))}catch(h){W(!1,h.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:s,info:{data:o}})}W(l.sender.toLowerCase()===c.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:s,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const d=await this.ccipReadFetch(s,l.calldata,l.urls);W(d!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:s,info:{data:a.data,errorArgs:l.errorArgs}});const u={to:c,data:Ye([l.selector,Kb([d,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const h=await te(this,Be,Qc).call(this,u,r,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:h}),h}catch(h){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:h}),h}}throw a}},qc=async function(t){const{value:r}=await yt({network:this.getNetwork(),value:t});return r},ta=async function(t,r,n){let s=this._getAddress(r),a=this._getBlockTag(n);return(typeof s!="string"||typeof a!="string")&&([s,a]=await Promise.all([s,a])),await te(this,Be,qc).call(this,te(this,Be,Ot).call(this,Object.assign(t,{address:s,blockTag:a})))},Jc=async function(t,r){if(qe(t,32))return await te(this,Be,Ot).call(this,{method:"getBlock",blockHash:t,includeTransactions:r});let n=this._getBlockTag(t);return typeof n!="string"&&(n=await n),await te(this,Be,Ot).call(this,{method:"getBlock",blockTag:n,includeTransactions:r})},ra=async function(t,r){let n=await ac(t,this);return n.type==="event"&&r&&r.length>0&&r[0].removed===!0&&(n=await ac({orphan:"drop-log",log:r[0]},this)),f(this,ft).get(n.tag)||null},no=async function(t){const r=await ac(t,this),n=r.tag;let s=f(this,ft).get(n);return s||(s={subscriber:this._getSubscriber(r),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},f(this,ft).set(n,s)),s};function Qb(e,t){try{const r=Kc(e,t);if(r)return co(r)}catch{}return null}function Kc(e,t){if(e==="0x")return null;try{const r=Se(Ie(e,t,t+32)),n=Se(Ie(e,r,r+32));return Ie(e,r+32,r+32+n)}catch{}return null}function Qd(e){const t=tt(e);if(t.length>32)throw new Error("internal; should not happen");const r=new Uint8Array(32);return r.set(t,32-t.length),r}function qb(e){if(e.length%32===0)return e;const t=new Uint8Array(Math.ceil(e.length/32)*32);return t.set(e),t}const Jb=new Uint8Array([]);function Kb(e){const t=[];let r=0;for(let n=0;n<e.length;n++)t.push(Jb),r+=32;for(let n=0;n<e.length;n++){const s=je(e[n]);t[n]=Qd(r),t.push(Qd(s.length)),t.push(qb(s)),r+=32+Math.ceil(s.length/32)*32}return Ye(t)}const qd="0x0000000000000000000000000000000000000000000000000000000000000000";function Ib(e){const t={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};W(Ms(e)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const r=Ie(e,0,32);W(Ie(r,0,12)===Ie(qd,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),t.sender=Ie(r,12);try{const n=[],s=Se(Ie(e,32,64)),a=Se(Ie(e,s,s+32)),o=Ie(e,s+32);for(let c=0;c<a;c++){const l=Qb(o,c*32);if(l==null)throw new Error("abort");n.push(l)}t.urls=n}catch{W(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=Kc(e,64);if(n==null)throw new Error("abort");t.calldata=n}catch{W(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}W(Ie(e,100,128)===Ie(qd,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),t.selector=Ie(e,96,100);try{const n=Kc(e,128);if(n==null)throw new Error("abort");t.extraData=n}catch{W(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return t.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>t[n]),t}function Fn(e,t){if(e.provider)return e.provider;W(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:t})}async function Jd(e,t){let r=xo(t);if(r.to!=null&&(r.to=At(r.to,e)),r.from!=null){const n=r.from;r.from=Promise.all([e.getAddress(),At(n,e)]).then(([s,a])=>(A(s.toLowerCase()===a.toLowerCase(),"transaction from mismatch","tx.from",a),s))}else r.from=e.getAddress();return await yt(r)}class gf{constructor(t){T(this,"provider");ve(this,{provider:t||null})}async getNonce(t){return Fn(this,"getTransactionCount").getTransactionCount(await this.getAddress(),t)}async populateCall(t){return await Jd(this,t)}async populateTransaction(t){const r=Fn(this,"populateTransaction"),n=await Jd(this,t);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const s=await this.provider.getNetwork();if(n.chainId!=null){const o=me(n.chainId);A(o===s.chainId,"transaction chainId mismatch","tx.chainId",t.chainId)}else n.chainId=s.chainId;const a=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||a)?A(!1,"eip-1559 transaction do not support gasPrice","tx",t):(n.type===0||n.type===1)&&a&&A(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",t),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await r.getFeeData();W(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await r.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,n.gasPrice!=null){const c=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=c,n.maxPriorityFeePerGas=c}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(W(!a,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):W(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3||n.type===4)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await yt(n)}async populateAuthorization(t){const r=Object.assign({},t);return r.chainId==null&&(r.chainId=(await Fn(this,"getNetwork").getNetwork()).chainId),r.nonce==null&&(r.nonce=await this.getNonce()),r}async estimateGas(t){return Fn(this,"estimateGas").estimateGas(await this.populateCall(t))}async call(t){return Fn(this,"call").call(await this.populateCall(t))}async resolveName(t){return await Fn(this,"resolveName").resolveName(t)}async sendTransaction(t){const r=Fn(this,"sendTransaction"),n=await this.populateTransaction(t);delete n.from;const s=uo.from(n);return await r.broadcastTransaction(await this.signTransaction(s))}authorize(t){W(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}var Ni,so;const Tl=class Tl extends gf{constructor(r,n){super(n);B(this,Ni);T(this,"address");ve(this,{address:r})}async getAddress(){return this.address}connect(r){return new Tl(this.address,r)}async signTransaction(r){te(this,Ni,so).call(this,"transactions","signTransaction")}async signMessage(r){te(this,Ni,so).call(this,"messages","signMessage")}async signTypedData(r,n,s){te(this,Ni,so).call(this,"typed-data","signTypedData")}};Ni=new WeakSet,so=function(r,n){W(!1,`VoidSigner cannot sign ${r}`,"UNSUPPORTED_OPERATION",{operation:n})};let Kd=Tl;function Wb(e){return JSON.parse(JSON.stringify(e))}var bt,xr,is,yn,as,Ai,kn,Ic,Wc;class xf{constructor(t){B(this,kn);B(this,bt);B(this,xr);B(this,is);B(this,yn);B(this,as);B(this,Ai);x(this,bt,t),x(this,xr,null),x(this,is,te(this,kn,Ic).bind(this)),x(this,yn,!1),x(this,as,null),x(this,Ai,!1)}_subscribe(t){throw new Error("subclasses must override this")}_emitResults(t,r){throw new Error("subclasses must override this")}_recover(t){throw new Error("subclasses must override this")}start(){f(this,yn)||(x(this,yn,!0),te(this,kn,Ic).call(this,-2))}stop(){f(this,yn)&&(x(this,yn,!1),x(this,Ai,!0),te(this,kn,Wc).call(this),f(this,bt).off("block",f(this,is)))}pause(t){t&&te(this,kn,Wc).call(this),f(this,bt).off("block",f(this,is))}resume(){this.start()}}bt=new WeakMap,xr=new WeakMap,is=new WeakMap,yn=new WeakMap,as=new WeakMap,Ai=new WeakMap,kn=new WeakSet,Ic=async function(t){try{f(this,xr)==null&&x(this,xr,this._subscribe(f(this,bt)));let r=null;try{r=await f(this,xr)}catch(a){if(!dt(a,"UNSUPPORTED_OPERATION")||a.operation!=="eth_newFilter")throw a}if(r==null){x(this,xr,null),f(this,bt)._recoverSubscriber(this,this._recover(f(this,bt)));return}const n=await f(this,bt).getNetwork();if(f(this,as)||x(this,as,n),f(this,as).chainId!==n.chainId)throw new Error("chaid changed");if(f(this,Ai))return;const s=await f(this,bt).send("eth_getFilterChanges",[r]);await this._emitResults(f(this,bt),s)}catch(r){console.log("@TODO",r)}f(this,bt).once("block",f(this,is))},Wc=function(){const t=f(this,xr);t&&(x(this,xr,null),t.then(r=>{f(this,bt).destroyed||f(this,bt).send("eth_uninstallFilter",[r])}))};var os;class Yb extends xf{constructor(r,n){super(r);B(this,os);x(this,os,Wb(n))}_recover(r){return new Al(r,f(this,os))}async _subscribe(r){return await r.send("eth_newFilter",[f(this,os)])}async _emitResults(r,n){for(const s of n)r.emit(f(this,os),r._wrapLog(s,r._network))}}os=new WeakMap;class Zb extends xf{async _subscribe(t){return await t.send("eth_newPendingTransactionFilter",[])}async _emitResults(t,r){for(const n of r)t.emit("pending",n)}}const Xb="bigint,boolean,function,number,string,symbol".split(/,/g);function io(e){if(e==null||Xb.indexOf(typeof e)>=0||typeof e.getAddress=="function")return e;if(Array.isArray(e))return e.map(io);if(typeof e=="object")return Object.keys(e).reduce((t,r)=>(t[r]=e[r],t),{});throw new Error(`should not happen: ${e} (${typeof e})`)}function Lb(e){return new Promise(t=>{setTimeout(t,e)})}function ks(e){return e&&e.toLowerCase()}function Id(e){return e&&typeof e.pollingInterval=="number"}const bf={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class cc extends gf{constructor(r,n){super(r);T(this,"address");n=Ue(n),ve(this,{address:n})}connect(r){W(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(r){return await this.populateCall(r)}async sendUncheckedTransaction(r){const n=io(r),s=[];if(n.from){const o=n.from;s.push((async()=>{const c=await At(o,this.provider);A(c!=null&&c.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",r),n.from=c})())}else n.from=this.address;if(n.gasLimit==null&&s.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;s.push((async()=>{n.to=await At(o,this.provider)})())}s.length&&await Promise.all(s);const a=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[a])}async sendTransaction(r){const n=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(r);return await new Promise((a,o)=>{const c=[1e3,100];let l=0;const d=async()=>{try{const u=await this.provider.getTransaction(s);if(u!=null){a(u.replaceableTransaction(n));return}}catch(u){if(dt(u,"CANCELLED")||dt(u,"BAD_DATA")||dt(u,"NETWORK_ERROR")||dt(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=s,o(u);return}if(dt(u,"INVALID_ARGUMENT")&&(l++,u.info==null&&(u.info={}),u.info.sendTransactionHash=s,l>10)){o(u);return}this.provider.emit("error",Ke("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{d()},c.pop()||4e3)};d()})}async signTransaction(r){const n=io(r);if(n.from){const a=await At(n.from,this.provider);A(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",r),n.from=a}else n.from=this.address;const s=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[s])}async signMessage(r){const n=typeof r=="string"?Ar(r):r;return await this.provider.send("personal_sign",[ue(n),this.address.toLowerCase()])}async signTypedData(r,n,s){const a=io(s),o=await fa.resolveNames(r,n,a,async c=>{const l=await At(c);return A(l!=null,"TypedData does not support null address","value",c),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(fa.getPayload(o.domain,n,o.value))])}async unlock(r){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),r,null])}async _legacySignMessage(r){const n=typeof r=="string"?Ar(r):r;return await this.provider.send("eth_sign",[this.address.toLowerCase(),ue(n)])}}var cs,vi,Hr,br,nr,It,Ct,Sa,Yc;class Db extends $b{constructor(r,n){super(r,n);B(this,Sa);B(this,cs);B(this,vi);B(this,Hr);B(this,br);B(this,nr);B(this,It);B(this,Ct);x(this,vi,1),x(this,cs,Object.assign({},bf,n||{})),x(this,Hr,[]),x(this,br,null),x(this,It,null),x(this,Ct,null);{let a=null;const o=new Promise(c=>{a=c});x(this,nr,{promise:o,resolve:a})}const s=this._getOption("staticNetwork");typeof s=="boolean"?(A(!s||r!=="any","staticNetwork cannot be used on special network 'any'","options",n),s&&r!=null&&x(this,It,Nr.from(r))):s&&(A(r==null||s.matches(r),"staticNetwork MUST match network object","options",n),x(this,It,s))}_getOption(r){return f(this,cs)[r]}get _network(){return W(f(this,It),"network is not available yet","NETWORK_ERROR"),f(this,It)}async _perform(r){if(r.method==="call"||r.method==="estimateGas"){let s=r.transaction;if(s&&s.type!=null&&me(s.type)&&s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null){const a=await this.getFeeData();a.maxFeePerGas==null&&a.maxPriorityFeePerGas==null&&(r=Object.assign({},r,{transaction:Object.assign({},s,{type:void 0})}))}}const n=this.getRpcRequest(r);return n!=null?await this.send(n.method,n.args):super._perform(r)}async _detectNetwork(){const r=this._getOption("staticNetwork");if(r)if(r===!0){if(f(this,It))return f(this,It)}else return r;return f(this,Ct)?await f(this,Ct):this.ready?(x(this,Ct,(async()=>{try{const n=Nr.from(me(await this.send("eth_chainId",[])));return x(this,Ct,null),n}catch(n){throw x(this,Ct,null),n}})()),await f(this,Ct)):(x(this,Ct,(async()=>{const n={id:Ii(this,vi)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let s;try{s=(await this._send(n))[0],x(this,Ct,null)}catch(a){throw x(this,Ct,null),this.emit("debug",{action:"receiveRpcError",error:a}),a}if(this.emit("debug",{action:"receiveRpcResult",result:s}),"result"in s)return Nr.from(me(s.result));throw this.getRpcError(n,s)})()),await f(this,Ct))}_start(){f(this,nr)==null||f(this,nr).resolve==null||(f(this,nr).resolve(),x(this,nr,null),(async()=>{for(;f(this,It)==null&&!this.destroyed;)try{x(this,It,await this._detectNetwork())}catch(r){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Ke("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:r}})),await Lb(1e3)}te(this,Sa,Yc).call(this)})())}async _waitUntilReady(){if(f(this,nr)!=null)return await f(this,nr).promise}_getSubscriber(r){return r.type==="pending"?new Zb(this):r.type==="event"?this._getOption("polling")?new Al(this,r.filter):new Yb(this,r.filter):r.type==="orphan"&&r.filter.orphan==="drop-log"?new pf("orphan"):super._getSubscriber(r)}get ready(){return f(this,nr)==null}getRpcTransaction(r){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(s=>{if(r[s]==null)return;let a=s;s==="gasLimit"&&(a="gas"),n[a]=sr(me(r[s],`tx.${s}`))}),["from","to","data"].forEach(s=>{r[s]!=null&&(n[s]=ue(r[s]))}),r.accessList&&(n.accessList=bs(r.accessList)),r.blobVersionedHashes&&(n.blobVersionedHashes=r.blobVersionedHashes.map(s=>s.toLowerCase())),r.authorizationList&&(n.authorizationList=r.authorizationList.map(s=>{const a=bh(s);return{address:a.address,nonce:sr(a.nonce),chainId:sr(a.chainId),yParity:sr(a.signature.yParity),r:sr(a.signature.r),s:sr(a.signature.s)}})),n}getRpcRequest(r){switch(r.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[ks(r.address),r.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[ks(r.address),r.blockTag]};case"getCode":return{method:"eth_getCode",args:[ks(r.address),r.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[ks(r.address),"0x"+r.position.toString(16),r.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[r.signedTransaction]};case"getBlock":if("blockTag"in r)return{method:"eth_getBlockByNumber",args:[r.blockTag,!!r.includeTransactions]};if("blockHash"in r)return{method:"eth_getBlockByHash",args:[r.blockHash,!!r.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[r.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[r.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(r.transaction),r.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(r.transaction)]};case"getLogs":return r.filter&&r.filter.address!=null&&(Array.isArray(r.filter.address)?r.filter.address=r.filter.address.map(ks):r.filter.address=ks(r.filter.address)),{method:"eth_getLogs",args:[r.filter]}}return null}getRpcError(r,n){const{method:s}=r,{error:a}=n;if(s==="eth_estimateGas"&&a.message){const l=a.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return Ke("insufficient funds","INSUFFICIENT_FUNDS",{transaction:r.params[0],info:{payload:r,error:a}});if(l.match(/nonce/i)&&l.match(/too low/i))return Ke("nonce has already been used","NONCE_EXPIRED",{transaction:r.params[0],info:{payload:r,error:a}})}if(s==="eth_call"||s==="eth_estimateGas"){const l=Zc(a),d=pa.getBuiltinCallException(s==="eth_call"?"call":"estimateGas",r.params[0],l?l.data:null);return d.info={error:a,payload:r},d}const o=JSON.stringify(ey(a));if(typeof a.message=="string"&&a.message.match(/user denied|ethers-user-denied/i))return Ke("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[s]||"unknown",reason:"rejected",info:{payload:r,error:a}});if(s==="eth_sendRawTransaction"||s==="eth_sendTransaction"){const l=r.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Ke("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:a}});if(o.match(/nonce/i)&&o.match(/too low/i))return Ke("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:a}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Ke("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:a}});if(o.match(/only replay-protected/i))return Ke("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:l,info:{error:a}}})}let c=!!o.match(/the method .* does not exist/i);return c||a&&a.details&&a.details.startsWith("Unauthorized method:")&&(c=!0),c?Ke("unsupported operation","UNSUPPORTED_OPERATION",{operation:r.method,info:{error:a,payload:r}}):Ke("could not coalesce error","UNKNOWN_ERROR",{error:a,payload:r})}send(r,n){if(this.destroyed)return Promise.reject(Ke("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:r}));const s=Ii(this,vi)._++,a=new Promise((o,c)=>{f(this,Hr).push({resolve:o,reject:c,payload:{method:r,params:n,id:s,jsonrpc:"2.0"}})});return te(this,Sa,Yc).call(this),a}async getSigner(r){r==null&&(r=0);const n=this.send("eth_accounts",[]);if(typeof r=="number"){const a=await n;if(r>=a.length)throw new Error("no such account");return new cc(this,a[r])}const{accounts:s}=await yt({network:this.getNetwork(),accounts:n});r=Ue(r);for(const a of s)if(Ue(a)===r)return new cc(this,r);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new cc(this,n))}destroy(){f(this,br)&&(clearTimeout(f(this,br)),x(this,br,null));for(const{payload:r,reject:n}of f(this,Hr))n(Ke("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:r.method}));x(this,Hr,[]),super.destroy()}}cs=new WeakMap,vi=new WeakMap,Hr=new WeakMap,br=new WeakMap,nr=new WeakMap,It=new WeakMap,Ct=new WeakMap,Sa=new WeakSet,Yc=function(){if(f(this,br))return;const r=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");x(this,br,setTimeout(()=>{x(this,br,null);const n=f(this,Hr);for(x(this,Hr,[]);n.length;){const s=[n.shift()];for(;n.length&&s.length!==f(this,cs).batchMaxCount;)if(s.push(n.shift()),JSON.stringify(s.map(o=>o.payload)).length>f(this,cs).batchMaxSize){n.unshift(s.pop());break}(async()=>{const a=s.length===1?s[0].payload:s.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:a});try{const o=await this._send(a);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:c,reject:l,payload:d}of s){if(this.destroyed){l(Ke("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:d.method}));continue}const u=o.filter(h=>h.id===d.id)[0];if(u==null){const h=Ke("missing response for request","BAD_DATA",{value:o,info:{payload:d}});this.emit("error",h),l(h);continue}if("error"in u){l(this.getRpcError(d,u));continue}c(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:c}of s)c(o)}})()}},r))};var wn;class yf extends Db{constructor(r,n){super(r,n);B(this,wn);let s=this._getOption("pollingInterval");s==null&&(s=bf.pollingInterval),x(this,wn,s)}_getSubscriber(r){const n=super._getSubscriber(r);return Id(n)&&(n.pollingInterval=f(this,wn)),n}get pollingInterval(){return f(this,wn)}set pollingInterval(r){if(!Number.isInteger(r)||r<0)throw new Error("invalid interval");x(this,wn,r),this._forEachSubscriber(n=>{Id(n)&&(n.pollingInterval=f(this,wn))})}}wn=new WeakMap;var Ei;class $y extends yf{constructor(r,n,s){r==null&&(r="http://localhost:8545");super(n,s);B(this,Ei);typeof r=="string"?x(this,Ei,new Ir(r)):x(this,Ei,r.clone())}_getConnection(){return f(this,Ei).clone()}async send(r,n){return await this._start(),await super.send(r,n)}async _send(r){const n=this._getConnection();n.body=JSON.stringify(r),n.setHeader("content-type","application/json");const s=await n.send();s.assertOk();let a=s.bodyJson;return Array.isArray(a)||(a=[a]),a}}Ei=new WeakMap;function Zc(e){if(e==null)return null;if(typeof e.message=="string"&&e.message.match(/revert/i)&&qe(e.data))return{message:e.message,data:e.data};if(typeof e=="object"){for(const t in e){const r=Zc(e[t]);if(r)return r}return null}if(typeof e=="string")try{return Zc(JSON.parse(e))}catch{}return null}function Xc(e,t){if(e!=null){if(typeof e.message=="string"&&t.push(e.message),typeof e=="object")for(const r in e)Xc(e[r],t);if(typeof e=="string")try{return Xc(JSON.parse(e),t)}catch{}}}function ey(e){const t=[];return Xc(e,t),t}var ki,Ci;const Un=class Un extends yf{constructor(r,n,s){const a=Object.assign({},s??{},{batchMaxCount:1});A(r&&r.request,"invalid EIP-1193 provider","ethereum",r);super(n,a);B(this,ki);B(this,Ci);x(this,Ci,null),s&&s.providerInfo&&x(this,Ci,s.providerInfo),x(this,ki,async(o,c)=>{const l={method:o,params:c};this.emit("debug",{action:"sendEip1193Request",payload:l});try{const d=await r.request(l);return this.emit("debug",{action:"receiveEip1193Result",result:d}),d}catch(d){const u=new Error(d.message);throw u.code=d.code,u.data=d.data,u.payload=l,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return f(this,Ci)}async send(r,n){return await this._start(),await super.send(r,n)}async _send(r){A(!Array.isArray(r),"EIP-1193 does not support batch request","payload",r);try{const n=await f(this,ki).call(this,r.method,r.params||[]);return[{id:r.id,result:n}]}catch(n){return[{id:r.id,error:{code:n.code,data:n.data,message:n.message}}]}}getRpcError(r,n){switch(n=JSON.parse(JSON.stringify(n)),n.error.code||-1){case 4001:n.error.message=`ethers-user-denied: ${n.error.message}`;break;case 4200:n.error.message=`ethers-unsupported: ${n.error.message}`;break}return super.getRpcError(r,n)}async hasSigner(r){r==null&&(r=0);const n=await this.send("eth_accounts",[]);return typeof r=="number"?n.length>r:(r=r.toLowerCase(),n.filter(s=>s.toLowerCase()===r).length!==0)}async getSigner(r){if(r==null&&(r=0),!await this.hasSigner(r))try{await f(this,ki).call(this,"eth_requestAccounts",[])}catch(n){const s=n.payload;throw this.getRpcError(s,{id:s.id,error:n})}return await super.getSigner(r)}static async discover(r){if(r==null&&(r={}),r.provider)return new Un(r.provider);const n=r.window?r.window:typeof window<"u"?window:null;if(n==null)return null;const s=r.anyProvider;if(s&&n.ethereum)return new Un(n.ethereum);if(!("addEventListener"in n&&"dispatchEvent"in n&&"removeEventListener"in n))return null;const a=r.timeout?r.timeout:300;return a===0?null:await new Promise((o,c)=>{let l=[];const d=m=>{l.push(m.detail),s&&u()},u=()=>{if(clearTimeout(h),l.length)if(r&&r.filter){const m=r.filter(l.map(p=>Object.assign({},p.info)));if(m==null)o(null);else if(m instanceof Un)o(m);else{let p=null;if(m.uuid&&(p=l.filter(g=>m.uuid===g.info.uuid)[0]),p){const{provider:b,info:g}=p;o(new Un(b,void 0,{providerInfo:g}))}else c(Ke("filter returned unknown info","UNSUPPORTED_OPERATION",{value:m}))}}else{const{provider:m,info:p}=l[0];o(new Un(m,void 0,{providerInfo:p}))}else o(null);n.removeEventListener("eip6963:announceProvider",d)},h=setTimeout(()=>{u()},a);n.addEventListener("eip6963:announceProvider",d),n.dispatchEvent(new Event("eip6963:requestProvider"))})}};ki=new WeakMap,Ci=new WeakMap;let Nn=Un;function Ji(){const[e,t]=_.useState(!1),[r,n]=_.useState(!1),[s,a]=_.useState(null),[o,c]=_.useState(null);return _.useEffect(()=>{window.ethereum&&(t(!0),window.ethereum.request({method:"eth_accounts"}).then(u=>{n(u.length>0),a(u[0]||null)}),window.ethereum.request({method:"eth_chainId"}).then(u=>{c(parseInt(u,16))}),window.ethereum.on("accountsChanged",u=>{n(u.length>0),a(u[0]||null)}),window.ethereum.on("chainChanged",u=>{c(parseInt(u,16))}))},[]),{isDetected:e,isUnlocked:r,activeAddress:s,chainId:o,connectWallet:async()=>{if(!window.ethereum)throw new Error("MetaMask not detected");const u=await window.ethereum.request({method:"eth_requestAccounts"});return a(u[0]),n(!0),u[0]},switchChain:async u=>{if(!window.ethereum)throw new Error("MetaMask not detected");const h="0x"+u.toString(16);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:h}]})}catch(m){throw m.code===4902?new Error(`Chain ${u} not added to MetaMask`):m}}}}function wf({isConnected:e,account:t,supportedNetworks:r,currentNetwork:n,onConnect:s,onSwitchNetwork:a,selectedTargetNetwork:o,onTargetNetworkChange:c}){const[l,d]=_.useState(!1),u=[{id:"ethereum",name:"Ethereum",chainId:1,icon:"ðŸ”·",blockExplorer:"https://etherscan.io",nativeCurrency:"ETH"},{id:"polygon",name:"Polygon",chainId:137,icon:"ðŸŸ£",blockExplorer:"https://polygonscan.com",nativeCurrency:"MATIC"},{id:"bsc",name:"BNB Smart Chain",chainId:56,icon:"ðŸŸ¡",blockExplorer:"https://bscscan.com",nativeCurrency:"BNB"},{id:"hardhat",name:"Hardhat Local",chainId:31337,icon:"âš¡",blockExplorer:"http://localhost:8545",nativeCurrency:"ETH"},{id:"hardhat-2",name:"Hardhat Local 2",chainId:1338,icon:"âš¡",blockExplorer:"http://localhost:9545",nativeCurrency:"ETH"},{id:"arbitrum",name:"Arbitrum",chainId:42161,icon:"ðŸ”µ",blockExplorer:"https://arbiscan.io",nativeCurrency:"ETH"},{id:"optimism",name:"Optimism",chainId:10,icon:"ðŸ”´",blockExplorer:"https://optimistic.etherscan.io",nativeCurrency:"ETH"},{id:"base",name:"Base",chainId:8453,icon:"ðŸ”µ",blockExplorer:"https://basescan.org",nativeCurrency:"ETH"}].filter(b=>r.includes(b.id)),h=async()=>{d(!0);try{await s()}finally{d(!1)}},m=async b=>{c&&c(b),e&&n!==b&&await a(b)},p=u.find(b=>b.id===o);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connect Your EVM Wallet"}),i.jsx("p",{className:"text-gray-600",children:"Connect your MetaMask or compatible wallet, then select your target network."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Step 1: Connect Wallet"}),i.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Connect your MetaMask or other Web3 wallet to continue."})]}),e?i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-800",children:"âœ… Wallet Connected"}),i.jsx("p",{className:"text-sm text-green-600 font-mono",children:t})]})]})}):i.jsx("div",{className:"flex flex-col items-center space-y-4",children:i.jsxs("div",{className:"p-6 border-2 border-dashed border-gray-300 rounded-lg text-center",children:[i.jsx("div",{className:"text-4xl mb-2",children:"ðŸ¦Š"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"No wallet connected"}),i.jsx("button",{onClick:h,disabled:l,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"Connecting...":"Connect Wallet"})]})})]}),e&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Step 2: Select Target Network"}),i.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Choose the blockchain network where you want to export your NFTs."})]}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:u.map(b=>i.jsxs("button",{onClick:()=>m(b.id),className:_e("p-4 border-2 rounded-lg text-left transition-all hover:shadow-md",o===b.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[i.jsxs("div",{className:"flex items-center mb-2",children:[i.jsx("span",{className:"text-2xl mr-3",children:b.icon}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:b.name}),i.jsxs("p",{className:"text-sm text-gray-500",children:["Chain ID: ",b.chainId]})]})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsxs("p",{children:["Currency: ",b.nativeCurrency]}),i.jsxs("a",{href:b.blockExplorer,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center mt-1",onClick:g=>g.stopPropagation(),children:["Explorer ",i.jsx(tu,{className:"w-3 h-3 ml-1"})]})]})]},b.id))}),o&&i.jsx("div",{className:"space-y-3",children:n===o?i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-green-800",children:"âœ… Network Connected"}),i.jsxs("p",{className:"text-sm text-green-600",children:[p==null?void 0:p.name," Network (Chain ID: ",p==null?void 0:p.chainId,")"]})]})]})}):i.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-amber-800",children:"âš ï¸ Network Switch Required"}),i.jsxs("p",{className:"text-sm text-amber-600",children:["Please switch to ",p==null?void 0:p.name," network (Chain ID: ",p==null?void 0:p.chainId,")"]}),n&&i.jsxs("p",{className:"text-xs text-amber-500",children:["Currently on: ",n]})]}),i.jsx("button",{onClick:()=>a(o),className:"px-4 py-2 text-sm bg-amber-100 text-amber-800 rounded-md hover:bg-amber-200 transition-colors",children:"Switch Network"})]})})})]})]})}function ty({account:e,network:t,selectedNFTs:r,onSelectionChange:n,nftDiscoveryService:s}){const[a,o]=_.useState([]),[c,l]=_.useState(null),[d,u]=_.useState([]),[h,m]=_.useState(""),[p,b]=_.useState(!1),[g,v]=_.useState(!1),[N,V]=_.useState(null),{chainId:E}=Ji(),{user:Y}=Er(),O=Hi("uzt4z-lp777-77774-qaabq-cai"),[Z,q]=_.useState(new Map),[R,K]=_.useState(new Map);_.useEffect(()=>{s&&e&&t&&(v(!0),V(null),s.getCollections(t,e).then(o).catch(y=>{console.error("Failed to load NFT collections:",y),V("Failed to load your NFT collections. You can still enter contract addresses manually.")}).finally(()=>v(!1)))},[s,e,t]),_.useEffect(()=>{c&&s&&e&&t&&(v(!0),s.getNFTsInCollection(c.contractAddress,e,t).then(u).catch(y=>{console.error("Failed to load NFTs from collection:",y),V("Failed to load NFTs from this collection.")}).finally(()=>v(!1)))},[c,s,e,t]);const ne=async()=>{if(!h.trim())return;if(!/^0x[a-fA-F0-9]{40}$/.test(h.trim())){V("Please enter a valid contract address (0x...)");return}const y=h.trim();v(!0),V(null);try{let M=[];if(s&&e&&t)M=await s.getNFTsInCollection(y,e,t);else if(e&&window.ethereum)M=await S(y,e,E||1);else throw new Error("No wallet connected or NFT discovery service available");u(M),l({contractAddress:y,name:`Contract ${y.slice(0,6)}...${y.slice(-4)}`,symbol:"UNKNOWN"}),b(!1),m("")}catch(M){console.error("Failed to load NFTs from manual contract:",M),V(`Failed to load NFTs from this contract: ${M instanceof Error?M.message:"Unknown error"}`)}finally{v(!1)}},z=async(y,M)=>{if(!window.ethereum||!e){V("Wallet not connected");return}v(!0),console.log(`ðŸ” Manual recovery: checking token ${M} in contract ${y}`);try{const P=new Nn(window.ethereum),Q=["function name() view returns (string)","function ownerOf(uint256 tokenId) view returns (address)","function tokenURI(uint256 tokenId) view returns (string)"],L=new hs(y,Q,P),se=await L.name().catch(()=>"Unknown Collection"),F=await L.ownerOf(M);if(console.log(`ðŸ” Token ${M} current owner: ${F}`),F.toLowerCase()===e.toLowerCase()){console.log(`âœ… Token ${M} is owned by user - already should be found`),V(`Token ${M} is owned by you and should already appear in the list`);return}const I=await w(L,y,se,M,F,"ready-to-mint",void 0,E??1);I?d.some(D=>D.contractAddress===I.contractAddress&&D.tokenId===I.tokenId)?V(`Token ${M} is already in the list`):(u(D=>[...D,I]),console.log(`âœ… Added recovered token ${M} to available NFTs`),c||l({contractAddress:y,name:se||`Contract ${y.slice(0,6)}...${y.slice(-4)}`,symbol:"UNKNOWN"})):V(`Could not retrieve metadata for token ${M}`)}catch(P){console.error("Manual recovery failed:",P),P instanceof Error&&P.message.includes("owner query for nonexistent token")?V(`Token ${M} does not exist in this contract`):V(`Failed to recover token ${M}: ${P instanceof Error?P.message:"Unknown error"}`)}finally{v(!1)}},k=async(y,M,P)=>{try{const Q=`${y}-${P}`,L=`${Q}-${M}`,se=Z.get(L);if(se!==void 0)return se==="not-minted"?null:se;let F=Z.get(Q);if(F){if(F==="none")return null}else{console.log(`ðŸ” Looking up ICRC-7 canister for contract ${y} on network ${P}...`);const I=P===1?{Ethereum:[BigInt(1)]}:P===137?{Ethereum:[BigInt(137)]}:P===56?{Ethereum:[BigInt(56)]}:P===31337?{Ethereum:[BigInt(31337)]}:P===42161?{Ethereum:[BigInt(42161)]}:P===10?{Ethereum:[BigInt(10)]}:P===8453?{Ethereum:[BigInt(8453)]}:{Ethereum:[BigInt(1)]},ee={contract:y,network:I};try{const re=(await O.getCkNFTCanister.mutateAsync([ee]))[0];if(F=re?re.toString():void 0,F)q(oe=>new Map(oe).set(Q,F)),console.log(`âœ… Cached ICRC-7 canister ID: ${F} for contract ${y}`);else return console.log(`âŒ No ICRC-7 canister found for contract ${y}`),q(oe=>new Map(oe).set(Q,"none")),null}catch(D){return console.warn(`Failed to get ICRC-7 canister for contract ${y}:`,D),null}}if(!F||F==="none")return null;console.log(`ðŸ” Checking ICRC-7 ownership for token ${M} in canister ${F}`);try{const{Actor:I,HttpAgent:ee}=await jt(async()=>{const{Actor:ae,HttpAgent:Ae}=await import("./index-CQEhYxiE.js").then(Re=>Re.a);return{Actor:ae,HttpAgent:Ae}},__vite__mapDeps([0,1,2])),{Principal:D}=await jt(async()=>{const{Principal:ae}=await import("./index-5sOdJcVt.js").then(Ae=>Ae.aD);return{Principal:ae}},__vite__mapDeps([1,2])),re=new ee({host:"http://localhost:8080"});await re.fetchRootKey().catch(ae=>console.warn("Failed to fetch root key:",ae));const oe=({IDL:ae})=>{const Ae=ae.Record({owner:ae.Principal,subaccount:ae.Opt(ae.Vec(ae.Nat8))});return ae.Service({icrc7_owner_of:ae.Func([ae.Vec(ae.Nat)],[ae.Vec(ae.Opt(Ae))],["query"])})},pe=I.createActor(oe,{agent:re,canisterId:D.fromText(F)}),Ne=BigInt(M),Te=await pe.icrc7_owner_of([Ne]);if(Te&&Te.length>0&&Te[0]&&Te[0].length>0){const Ae=Te[0][0].owner.toString();return console.log(`âœ… Token ${M} is minted on ICRC-7, owned by ${Ae}`),q(Re=>new Map(Re).set(L,Ae)),Ae}else return console.log(`ðŸ“‹ Token ${M} not minted on ICRC-7 yet`),q(ae=>new Map(ae).set(L,"not-minted")),null}catch(I){console.warn(`Failed to check ICRC-7 ownership for token ${M}:`,I);const ee=String(I).toLowerCase();return(ee.includes("not found")||ee.includes("does not exist")||ee.includes("unknown"))&&q(D=>new Map(D).set(L,"not-minted")),null}}catch(Q){return console.error("Error checking ICRC-7 ownership:",Q),null}},S=async(y,M,P)=>{if(!window.ethereum)throw new Error("MetaMask not available");const Q=new Nn(window.ethereum),L=["function name() view returns (string)","function symbol() view returns (string)","function ownerOf(uint256 tokenId) view returns (address)","function tokenURI(uint256 tokenId) view returns (string)","function balanceOf(address owner) view returns (uint256)","function tokenOfOwnerByIndex(address owner, uint256 index) view returns (uint256)","function totalSupply() view returns (uint256)","event Transfer(address indexed from, address indexed to, uint256 indexed tokenId)"],se=new hs(y,L,Q);try{const F=[];console.log(`ðŸ” Verifying contract interface for: ${y}`);let I;try{I=await se.name(),console.log(`âœ… Contract name: ${I}`)}catch{console.warn("âŒ Contract does not support name() function, using fallback"),I="Unknown Collection"}try{await se.balanceOf(M)}catch(ee){throw console.error("âŒ Contract does not support balanceOf - not a valid ERC-721:",ee),new Error("Contract does not appear to be a valid ERC-721 NFT contract")}console.log(`ðŸ” Starting comprehensive NFT scan for contract: ${y}`),console.log(`ðŸ” User address: ${M}`),console.log("ðŸ” Step 1: Finding owned NFTs...");try{const ee=await U(se,M,y,I,P);console.log(`âœ… Found ${ee.length} owned NFTs`),F.push(...ee)}catch(ee){console.error("âŒ Error finding owned NFTs:",ee)}console.log("ðŸ” Step 2: Finding bridged NFTs...");try{const ee=await C(se,M,y,I,P);console.log(`âœ… Found ${ee.length} bridged NFTs`),F.push(...ee)}catch(ee){console.error("âŒ Error finding bridged NFTs:",ee)}console.log("ðŸ” Step 3: Finding recently transferred NFTs (fallback)...");try{const ee=await ce(se,M,y,I,P);console.log(`âœ… Found ${ee.length} recently transferred NFTs`);for(const D of ee)F.some(oe=>oe.contractAddress===D.contractAddress&&oe.tokenId===D.tokenId)||F.push(D)}catch(ee){console.error("âŒ Error finding recently transferred NFTs:",ee)}return console.log(`ðŸŽ¯ Total NFTs found: ${F.length}`),F}catch(F){throw console.error("Contract interaction error:",F),new Error("Failed to interact with contract. Please verify it's a valid ERC-721 contract.")}},ce=async(y,M,P,Q,L)=>{var I,ee,D;const se=(I=y.runner)==null?void 0:I.provider;if(!se)return[];const F=[];try{const re=await se.getBlockNumber(),oe=Math.max(0,re-1e5);console.log(`ðŸ” Fallback scan: blocks ${oe} to ${re}`);const pe=y.filters.Transfer(M,null,null),Ne=await y.queryFilter(pe,oe,"latest");console.log(`ðŸ” Found ${Ne.length} total transfers from user`);const Te=new Map;for(const ae of Ne)if("args"in ae&&ae.args){const Ae=(ee=ae.args.tokenId)==null?void 0:ee.toString(),Re=(D=ae.args.to)==null?void 0:D.toString().toLowerCase(),de=ae.blockNumber;if(Ae&&Re){const G=Te.get(Ae);(!G||de>G.blockNumber)&&Te.set(Ae,{tokenId:Ae,toAddress:Re,blockNumber:de,txHash:ae.transactionHash})}}console.log(`ðŸ” Processing ${Te.size} unique tokens transferred from user`);for(const[ae,Ae]of Te)try{const Re=await y.ownerOf(ae),de=Re.toLowerCase();if(de!==M.toLowerCase()){console.log(`ðŸ” Token ${ae}: transferred to ${Ae.toAddress}, now owned by ${Re}`);const G=await k(P,ae,L);let $="bridged",X;G?($="already-minted",X=ae,console.log(`ðŸŽ¯ Token ${ae} has already been minted on ICRC-7, owned by ${G} - skipping bridge checks`)):(console.log(`ðŸ“‹ Token ${ae} not minted on ICRC-7 yet, checking bridge status...`),de===Ae.toAddress&&($="ready-to-mint",console.log(`âœ… Token ${ae} appears to be ready for minting`)));const le=await H(y,P,Q,ae,Re,$,Ae.txHash,X);le&&F.push(le)}}catch(Re){console.log(`âŒ Token ${ae} no longer exists or error checking owner:`,Re)}}catch(re){console.error("âŒ Error in fallback scan:",re)}return F},U=async(y,M,P,Q,L)=>{var se,F,I;try{console.log(`ðŸ” Checking balance for user ${M}...`);const ee=await y.balanceOf(M),D=Number(ee);if(console.log(`ðŸ” User balance: ${D} NFTs`),D===0)return[];let re=[];try{console.log(`ðŸ” Attempting to use ERC-721 Enumerable for ${D} tokens...`);for(let pe=0;pe<D;pe++)try{const Ne=await y.tokenOfOwnerByIndex(M,pe);re.push(Ne.toString())}catch(Ne){throw console.log(`âŒ Failed on token index ${pe}, falling back to event scanning...`),re=[],Ne}console.log(`âœ… Successfully retrieved ${re.length} tokens via Enumerable`)}catch{console.log("Contract does not support ERC-721 Enumerable, falling back to event scanning..."),re=[];const Ne=(se=y.runner)==null?void 0:se.provider;if(!Ne)throw new Error("No provider available");try{const Te=await Ne.getBlockNumber(),ae=Math.max(0,Te-5e3);console.log(`ðŸ” Event scanning from block ${ae} to ${Te}`);const Ae=y.filters.Transfer(null,M,null),Re=await y.queryFilter(Ae,ae,"latest"),de=y.filters.Transfer(M,null,null),G=await y.queryFilter(de,ae,"latest");console.log(`ðŸ” Found ${Re.length} transfers TO user, ${G.length} transfers FROM user`);const $=new Set,X=new Set;for(const be of Re)if("args"in be&&be.args){const he=(F=be.args.tokenId)==null?void 0:F.toString();he&&$.add(he)}for(const be of G)if("args"in be&&be.args){const he=(I=be.args.tokenId)==null?void 0:I.toString();he&&X.add(he)}const le=Array.from($).filter(be=>!X.has(be));console.log(`ðŸ” Potential owned tokens from events: ${le.length}`);for(const be of le)try{(await y.ownerOf(be)).toLowerCase()===M.toLowerCase()&&re.push(be)}catch{console.log(`Token ${be} does not exist or is burned`)}}catch(Te){throw console.error("âŒ Event scanning also failed:",Te),new Error(`Unable to determine NFT ownership: ${Te instanceof Error?Te.message:"Unknown error"}`)}}const oe=[];for(const pe of re){const Ne=await w(y,P,Q,pe,M,"owned",void 0,L);Ne&&oe.push(Ne)}return oe}catch(ee){return console.error("âŒ Error finding user owned NFTs:",ee),[]}},C=async(y,M,P,Q,L)=>{var I,ee,D;const se=(I=y.runner)==null?void 0:I.provider;if(!se)return[];const F=[];try{const re=await se.getBlockNumber(),oe=Math.max(0,re-5e4);console.log(`ðŸ” Scanning blocks ${oe} to ${re} for transfers from ${M}`);const pe=y.filters.Transfer(M,null,null),Ne=await y.queryFilter(pe,oe,"latest");if(console.log(`ðŸ” Found ${Ne.length} transfers from user address`),Ne.length===0)return console.log("âš ï¸ No transfers from user found - skipping bridge address lookup"),[];for(const Te of Ne)if("args"in Te&&Te.args){const ae=(ee=Te.args.tokenId)==null?void 0:ee.toString(),Ae=(D=Te.args.to)==null?void 0:D.toString().toLowerCase(),Re=Te.transactionHash;if(console.log(`ðŸ” Transfer event: token ${ae} to ${Ae}, tx: ${Re}`),ae&&Ae){console.log(`ðŸ” Checking ICRC-7 ownership for token ${ae} before bridge checks...`);const de=await k(P,ae,L);if(de){console.log(`ðŸŽ¯ Token ${ae} already minted on ICRC-7, owned by ${de} - adding as already-minted`);try{const $=await y.ownerOf(ae),X=await H(y,P,Q,ae,$,"already-minted",Re,ae);X&&F.push(X)}catch($){console.log(`âŒ Token ${ae} no longer exists:`,$)}continue}if(console.log(`ðŸ“‹ Token ${ae} not minted on ICRC-7, checking if ${Ae} is a bridge address...`),(await j(P)).includes(Ae)){console.log(`âœ… Found transfer to bridge address: token ${ae}`);try{const $=await y.ownerOf(ae);if(console.log(`ðŸ” Current owner of token ${ae}: ${$}`),$.toLowerCase()===Ae){console.log(`ðŸŽ¯ Token ${ae} is ready to mint!`);const X=await H(y,P,Q,ae,$,"ready-to-mint",Re);X&&F.push(X)}else console.log(`âŒ Token ${ae} no longer owned by bridge (owner: ${$})`)}catch($){console.log(`âŒ Token ${ae} no longer exists:`,$)}}else console.log(`âšª Transfer to non-bridge address: ${Ae}`)}}}catch(re){console.error("Error scanning for bridged NFTs:",re)}return F},j=async y=>{const M=R.get(y);if(M)return console.log("âœ… Using cached bridge addresses for contract:",y),M;const P=[];if(console.log("ðŸ” Getting bridge approval addresses for contract:",y),!O.getApprovalAddress||!(Y!=null&&Y.principal))return console.log("âš ï¸ No approval address mutation or user principal available"),K(Q=>new Map(Q).set(y,P)),P;try{const Q=E??1,L=Q===1?{Ethereum:[BigInt(1)]}:Q===137?{Ethereum:[BigInt(137)]}:Q===56?{Ethereum:[BigInt(56)]}:Q===31337?{Ethereum:[BigInt(31337)]}:Q===42161?{Ethereum:[BigInt(42161)]}:Q===10?{Ethereum:[BigInt(10)]}:Q===8453?{Ethereum:[BigInt(8453)]}:{Ethereum:[BigInt(1)]},se={remoteNFTPointer:{tokenId:BigInt(0),contract:y,network:L},account:{owner:Y.principal,subaccount:[]}};console.log("ðŸ” Requesting approval address with:",se);const F=await O.getApprovalAddress.mutateAsync({request:se,spender:{owner:Y.principal,subaccount:[]}});return F?(P.push(F.toLowerCase()),console.log("âœ… Found approval address:",F)):console.log("âŒ No approval address returned"),K(I=>new Map(I).set(y,P)),console.log("ðŸ” Final bridge addresses list:",P),P}catch(Q){return console.error("âŒ Failed to get bridge approval addresses:",Q),K(L=>new Map(L).set(y,P)),P}},w=async(y,M,P,Q,L,se,F,I)=>{try{if(se==="owned"||se==="bridged"){const D=await k(M,Q,I??E??1);let re,oe;return D?(re="already-minted",oe=Q,console.log(`âœ… Token ${Q} already minted on ICRC-7, owned by: ${D}`)):re=se,await H(y,M,P,Q,L,re,F,oe)}else return await H(y,M,P,Q,L,se,F)}catch(ee){return console.error(`Error in ownership check for token ${Q}:`,ee),await H(y,M,P,Q,L,se,F)}},H=async(y,M,P,Q,L,se,F,I)=>{try{let ee=`${P} #${Q}`,D,re;try{const oe=await y.tokenURI(Q);if(oe)if(oe.includes("example.com")||oe.includes("placeholder")||oe.includes("localhost")&&!oe.includes(window.location.host))console.log(`Skipping placeholder URL for token ${Q}: ${oe}`),ee=`Mock NFT #${Q}`,re=`This is a mock NFT with token ID ${Q} from contract ${M}`,D=`https://picsum.photos/400/400?random=${Q}`;else{let Ne=oe;oe.startsWith("ipfs://")&&(Ne=`https://ipfs.io/ipfs/${oe.slice(7)}`);const Te=new AbortController,ae=setTimeout(()=>Te.abort(),5e3);try{const Ae=await fetch(Ne,{signal:Te.signal,headers:{Accept:"application/json"}});if(clearTimeout(ae),Ae.ok){const Re=await Ae.json();ee=Re.name||ee,re=Re.description,Re.image&&(D=Re.image,D&&D.startsWith("ipfs://")&&(D=`https://ipfs.io/ipfs/${D.slice(7)}`))}}catch(Ae){clearTimeout(ae),console.log(`Failed to fetch metadata for token ${Q}:`,Ae)}}}catch(oe){console.log(`Failed to get tokenURI for token ${Q}:`,oe)}return{contractAddress:M,tokenId:Q,name:ee,image:D,description:re,ownershipStatus:se,currentOwner:L.toLowerCase(),bridgeTransferHash:F,icrcTokenId:I}}catch(ee){return console.log(`Error processing token ${Q}:`,ee),null}},J=y=>{if(y.ownershipStatus==="already-minted")return;const M=r.some(P=>P.contractAddress===y.contractAddress&&P.tokenId===y.tokenId);n(M?r.filter(P=>!(P.contractAddress===y.contractAddress&&P.tokenId===y.tokenId)):[...r,y])};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select NFTs to Import"}),i.jsx("p",{className:"text-gray-600",children:"Choose which NFTs you'd like to bridge to the Internet Computer."}),i.jsxs("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[i.jsxs("p",{className:"text-blue-800",children:[i.jsx("strong",{children:"ðŸ’¡ Smart Recovery:"})," This scanner will find both NFTs you own and NFTs you previously transferred to the bridge that failed to mint due to insufficient cycles. Ready-to-mint NFTs can be processed faster since they skip the transfer step!"]}),i.jsxs("details",{className:"mt-2 group",children:[i.jsx("summary",{className:"cursor-pointer text-blue-700 hover:text-blue-800 text-xs",children:"ðŸ” Debug: What we're looking for..."}),i.jsxs("div",{className:"mt-2 text-xs text-blue-600 space-y-1",children:[i.jsxs("p",{children:["â€¢ ",i.jsx("strong",{children:"Owned NFTs:"})," Currently in your wallet"]}),i.jsxs("p",{children:["â€¢ ",i.jsx("strong",{children:"Bridge NFTs:"})," Transferred to known bridge addresses"]}),i.jsxs("p",{children:["â€¢ ",i.jsx("strong",{children:"Stranded NFTs:"})," Transferred but not in expected bridge addresses"]}),i.jsxs("p",{children:["â€¢ ",i.jsx("strong",{children:"Scan Range:"})," Last 50,000-100,000 blocks (adjust if needed)"]})]})]})]})]}),N&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsx("p",{className:"text-sm text-red-800",children:N})}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"1. Select NFT Collection"}),i.jsx("button",{onClick:()=>b(!p),className:"text-sm text-blue-600 hover:text-blue-700",children:p?"Browse Collections":"Enter Contract Manually"})]}),p?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex gap-3",children:[i.jsx("input",{type:"text",value:h,onChange:y=>m(y.target.value),placeholder:"Enter contract address (0x...)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),i.jsx("button",{onClick:ne,disabled:!h.trim()||g,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Load NFTs"})]}),i.jsx("p",{className:"text-xs text-gray-500",children:"Enter the contract address of an NFT collection to see your NFTs"}),i.jsx("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-md",children:i.jsxs("details",{className:"group",children:[i.jsx("summary",{className:"cursor-pointer text-sm font-medium text-amber-800 mb-2",children:"ðŸ” Advanced: Recover Specific Token ID"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-xs text-amber-700",children:"If you know a specific token ID that you transferred but don't see in the list, you can manually check it here:"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",placeholder:"Token ID (e.g., 1234)",className:"flex-1 px-2 py-1 text-sm border border-amber-300 rounded focus:outline-none focus:ring-1 focus:ring-amber-500",onKeyPress:async y=>{if(y.key==="Enter"&&h.trim()){const M=y.target.value.trim();M&&(console.log(`ðŸ” Manual recovery check for token ${M} in contract ${h}`),await z(h,M))}}}),i.jsx("button",{onClick:()=>{const y=document.querySelector('input[placeholder="Token ID (e.g., 1234)"]'),M=y==null?void 0:y.value.trim();M&&h.trim()&&z(h,M)},className:"px-2 py-1 text-xs bg-amber-600 text-white rounded hover:bg-amber-700",children:"Check"})]})]})]})})]}):i.jsx("div",{children:g&&a.length===0?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-blue-600 border-t-transparent rounded-full mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Loading your NFT collections..."})]}):a.length>0?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.map(y=>i.jsx("button",{onClick:()=>l(y),className:_e("p-4 border rounded-lg text-left transition-colors",(c==null?void 0:c.contractAddress)===y.contractAddress?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:i.jsxs("div",{className:"flex items-start space-x-3",children:[y.imageUrl&&i.jsx("img",{src:y.imageUrl,alt:y.name,className:"w-12 h-12 rounded-lg object-cover"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-gray-900 truncate",children:y.name}),i.jsxs("p",{className:"text-sm text-gray-600 truncate",children:[y.contractAddress.slice(0,6),"...",y.contractAddress.slice(-4)]}),y.totalSupply&&i.jsxs("p",{className:"text-xs text-gray-500",children:["Supply: ",y.totalSupply]})]}),y.verified&&i.jsx("div",{className:"text-blue-500",children:"âœ“"})]})},y.contractAddress))}):!g&&s?i.jsxs("div",{className:"p-6 text-center border-2 border-dashed border-gray-300 rounded-lg",children:[i.jsx("p",{className:"text-gray-500",children:"No NFT collections found for this account"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try entering a contract address manually"})]}):i.jsxs("div",{className:"p-6 text-center border-2 border-dashed border-gray-300 rounded-lg",children:[i.jsx("p",{className:"text-gray-500",children:"NFT discovery service not configured"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Enter contract addresses manually to continue"})]})})]}),c&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("h4",{className:"font-medium text-gray-900",children:["2. Select NFTs from ",c.name]}),g&&d.length===0?i.jsxs("div",{className:"p-6 text-center",children:[i.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-blue-600 border-t-transparent rounded-full mx-auto mb-2"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Loading NFTs from collection..."})]}):d.length>0?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:d.map(y=>{const M=r.some(L=>L.contractAddress===y.contractAddress&&L.tokenId===y.tokenId),Q=(()=>{switch(y.ownershipStatus){case"ready-to-mint":return{border:"border-amber-500 bg-amber-50",ring:M?"ring-2 ring-amber-200":"",badge:"bg-amber-100 text-amber-800"};case"bridged":return{border:"border-purple-500 bg-purple-50",ring:M?"ring-2 ring-purple-200":"",badge:"bg-purple-100 text-purple-800"};case"already-minted":return{border:"border-green-500 bg-green-50 opacity-60",ring:"",badge:"bg-green-100 text-green-800"};case"owned":default:return{border:M?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300",ring:M?"ring-2 ring-blue-200":"",badge:"bg-green-100 text-green-800"}}})();return i.jsx("div",{className:"relative",children:i.jsxs("button",{onClick:()=>J(y),disabled:y.ownershipStatus==="already-minted",className:_e("w-full p-3 border rounded-lg text-left transition-all",Q.border,Q.ring,y.ownershipStatus==="already-minted"?"cursor-not-allowed":"cursor-pointer"),children:[i.jsx("div",{className:"absolute top-2 right-2 z-10",children:i.jsxs("span",{className:_e("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",Q.badge),children:[y.ownershipStatus==="ready-to-mint"&&"â³ Ready to Mint",y.ownershipStatus==="bridged"&&"ðŸŒ‰ Bridged",y.ownershipStatus==="already-minted"&&"âœ… Already Minted",(y.ownershipStatus==="owned"||!y.ownershipStatus)&&"âœ“ Owned"]})}),y.image&&i.jsx("img",{src:y.image,alt:y.name,className:"w-full h-32 object-cover rounded-md mb-2"}),i.jsx("p",{className:"font-medium text-sm truncate pr-16",children:y.name}),i.jsxs("p",{className:"text-xs text-gray-600",children:["#",y.tokenId]}),y.ownershipStatus==="ready-to-mint"&&i.jsxs("div",{className:"mt-2 p-2 bg-amber-100 rounded text-xs",children:[i.jsx("p",{className:"font-medium text-amber-800",children:"Ready to mint!"}),i.jsx("p",{className:"text-amber-700",children:"This NFT was transferred to the bridge and is ready to be minted on IC without additional transfer fees."}),y.bridgeTransferHash&&i.jsxs("p",{className:"text-amber-600 mt-1 truncate",children:["Transfer: ",y.bridgeTransferHash.slice(0,10),"..."]})]}),y.ownershipStatus==="bridged"&&i.jsxs("div",{className:"mt-2 p-2 bg-purple-100 rounded text-xs",children:[i.jsx("p",{className:"font-medium text-purple-800",children:"In bridge"}),i.jsx("p",{className:"text-purple-700",children:"This NFT is currently held by the bridge."}),y.currentOwner&&i.jsxs("p",{className:"text-purple-600 mt-1 truncate",children:["Owner: ",y.currentOwner.slice(0,10),"..."]})]}),y.ownershipStatus==="already-minted"&&i.jsxs("div",{className:"mt-2 p-2 bg-green-100 rounded text-xs",children:[i.jsx("p",{className:"font-medium text-green-800",children:"Already minted on IC!"}),i.jsx("p",{className:"text-green-700",children:"This NFT has already been successfully minted on the Internet Computer."}),y.icrcTokenId&&i.jsxs("p",{className:"text-green-600 mt-1",children:["ICRC-7 Token ID: ",y.icrcTokenId]})]}),M&&i.jsx("div",{className:"mt-2 text-xs font-medium text-blue-600",children:"âœ“ Selected for bridge"})]})},`${y.contractAddress}-${y.tokenId}`)})}):i.jsxs("div",{className:"p-6 text-center border-2 border-dashed border-gray-300 rounded-lg",children:[i.jsx("p",{className:"text-gray-500",children:"No NFTs found in this collection"}),i.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"You don't own any NFTs from this contract"})]})]}),r.length>0&&i.jsxs("div",{className:"space-y-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:[i.jsxs("h4",{className:"font-medium text-green-900",children:["Selected NFTs (",r.length,")"]}),i.jsx("div",{className:"space-y-2",children:r.map(y=>{const P=(()=>{switch(y.ownershipStatus){case"ready-to-mint":return{badge:"bg-amber-100 text-amber-800",text:"â³ Ready to mint - will skip transfer steps",description:"This NFT is already in the bridge and can be minted directly on IC."};case"bridged":return{badge:"bg-purple-100 text-purple-800",text:"ðŸŒ‰ In bridge - pending mint approval",description:"This NFT is held by the bridge but may need additional approvals."};case"owned":default:return{badge:"bg-blue-100 text-blue-800",text:"ðŸ”„ Will transfer then mint",description:"This NFT will be transferred to the bridge then minted on IC."}}})();return i.jsx("div",{className:"p-2 bg-white rounded-md border",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium text-sm",children:y.name}),i.jsxs("p",{className:"text-xs text-gray-600 mb-1",children:["Token ID: ",y.tokenId]}),i.jsx("div",{className:"flex items-center space-x-2 mb-1",children:i.jsx("span",{className:_e("inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",P.badge),children:P.text})}),i.jsx("p",{className:"text-xs text-gray-500",children:P.description}),y.bridgeTransferHash&&i.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Previous transfer: ",y.bridgeTransferHash.slice(0,16),"..."]})]}),i.jsx("button",{onClick:()=>J(y),className:"text-red-600 hover:text-red-700 text-sm ml-2",children:"Remove"})]})},`${y.contractAddress}-${y.tokenId}`)})}),i.jsxs("div",{className:"pt-3 border-t border-green-200",children:[i.jsx("h5",{className:"text-sm font-medium text-green-900 mb-2",children:"Bridge Process Summary:"}),i.jsxs("div",{className:"text-xs text-green-800 space-y-1",children:[r.filter(y=>y.ownershipStatus==="ready-to-mint").length>0&&i.jsxs("p",{children:["â€¢ ",r.filter(y=>y.ownershipStatus==="ready-to-mint").length," NFT(s) ready to mint directly (faster process)"]}),r.filter(y=>!y.ownershipStatus||y.ownershipStatus==="owned").length>0&&i.jsxs("p",{children:["â€¢ ",r.filter(y=>!y.ownershipStatus||y.ownershipStatus==="owned").length," NFT(s) will be transferred then minted"]}),r.filter(y=>y.ownershipStatus==="bridged").length>0&&i.jsxs("p",{children:["â€¢ ",r.filter(y=>y.ownershipStatus==="bridged").length," NFT(s) may need additional approvals"]}),d.filter(y=>y.ownershipStatus==="already-minted").length>0&&i.jsxs("p",{className:"text-green-600",children:["â„¹ï¸ Found ",d.filter(y=>y.ownershipStatus==="already-minted").length," NFT(s) already minted on IC (not selectable)"]})]})]})]}),!s&&!c&&i.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("p",{className:"text-sm text-blue-800 mb-2",children:i.jsx("strong",{children:"Direct Blockchain Scanning Enabled"})}),i.jsx("p",{className:"text-xs text-blue-700 mb-3",children:"No NFT discovery service configured, but you can still enter contract addresses manually. The app will scan the blockchain directly using your wallet to find your NFTs."}),i.jsx("button",{onClick:()=>n([{contractAddress:"0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D",tokenId:"1234",name:"Demo Bored Ape #1234",image:"https://ipfs.io/ipfs/QmRRPWG96cmgTn2qSzjwr2qvfNEuhunv6FNeMFGa9bx6mQ"}]),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Select Demo NFT (for testing)"})]})]})}var ry={};function ny({selectedNFTs:e,costs:t,onCostsCalculated:r,compact:n=!1}){var se;const{chainId:s}=Ji(),{user:a}=Er(),o=ry.CYCLES_LEDGER_CANISTER_ID||"um5iw-rqaaa-aaaaq-qaaba-cai",c=Vi(o),{useBalance:l,useApprove:d}=c,u=l(a!=null&&a.principal?{owner:a.principal,subaccount:[]}:void 0),h=d(),m=u.data,p=u.isLoading,b=u.error,g=h.isPending,v=h.error,N=F=>{const ee=BigInt(1e12),D=F/ee,oe=(F%ee).toString().padStart(12,"0").slice(0,3);return`${D.toLocaleString()}.${oe} TC`},V=F=>m?m>=F:!1,E=Hi("uzt4z-lp777-77774-qaabq-cai"),Y=_.useMemo(()=>{if(e.length===0)return null;const F=s??1,I=F===1?{Ethereum:[BigInt(1)]}:F===137?{Ethereum:[BigInt(137)]}:F===56?{Ethereum:[BigInt(56)]}:F===31337?{Ethereum:[BigInt(31337)]}:F===42161?{Ethereum:[BigInt(42161)]}:F===10?{Ethereum:[BigInt(10)]}:F===8453?{Ethereum:[BigInt(8453)]}:{Ethereum:[BigInt(1)]};return{contract:e[0].contractAddress,network:I}},[e.length>0?(se=e[0])==null?void 0:se.contractAddress:null,s??1]),{data:O,isLoading:Z,error:q}=fm(Y,e.length>0),{data:R,isLoading:K,error:ne}=mm(Y,e.length>0),{data:z,isLoading:k}=el(O||void 0);_.useEffect(()=>{O&&t===null&&r(O)},[O,t,r]);const S=t||O,ce=Z||K||e.length>0&&!S,U=q||b||ne,C=Array.isArray(R)?R.length>0:R!=null,j=_.useMemo(()=>{if(!R)return null;if(Array.isArray(R)){if(R.length===0)return null;const F=R[0];return F&&typeof F=="object"&&"toString"in F?F.toString():String(F)}return typeof R=="object"&&"toString"in R?R.toString():String(R)},[R]),{data:w,isLoading:H,error:J}=pm(j,C&&!!j),y=()=>{if(!R)return"N/A";try{if(Array.isArray(R)){if(R.length===0)return"No canister found";const F=R[0];return F&&typeof F=="object"&&"toString"in F?F.toString():String(F)}return R&&typeof R=="object"&&"toString"in R?R.toString():typeof R=="string"?R:String(R)}catch(F){return console.error("Error converting canister ID to string:",F,R),"Error displaying ID"}},M=_.useCallback(async()=>{if(!Y||!S){console.error("CanisterCostStep: Missing required data for canister creation");return}try{const F=(z==null?void 0:z.isSufficient)&&!(z!=null&&z.isExpired);console.log(F?"CanisterCostStep: Sufficient allowance exists, skipping auto-approval":"CanisterCostStep: Will auto-approve cycles during creation");const I=await E.createCanister.mutateAsync({pointer:Y,defaults:{name:`ckNFT for ${Y.contract}`,symbol:"ckNFT",description:`Cross-chain NFT canister for ${Y.contract}`},spender:a!=null&&a.principal?{owner:a.principal,subaccount:[]}:void 0,requiredCycles:S,skipApproval:F});console.log("CanisterCostStep: Canister creation result",I),"Ok"in I?console.log("CanisterCostStep: Canister created successfully",I.Ok.toString()):console.error("CanisterCostStep: Unexpected result format",I)}catch(F){console.error("CanisterCostStep: Error creating canister",F)}},[Y,S,z,E.createCanister,a==null?void 0:a.principal]),P=!ce&&S&&m!==void 0&&V(S)&&!C&&!E.createCanister.isPending,Q=F=>N(F),L=F=>(Number(F)/1e12).toFixed(6);return n?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Canister Status"}),i.jsx("p",{className:"text-gray-600",children:"Current status of your NFT canister on the Internet Computer."})]}),U&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-red-800",children:["Error: ",(()=>{try{return q instanceof Error?q.message:b instanceof Error?b.message:ne instanceof Error?ne.message:q?String(q):b?String(b):ne?String(ne):"Unknown error occurred"}catch(F){return console.error("Error formatting error message:",F,{costError:q,balanceError:b,existingError:ne}),"Error formatting error message"}})()]})}),E.createCanister.error&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-red-800",children:["Canister creation failed: ",E.createCanister.error instanceof Error?E.createCanister.error.message:String(E.createCanister.error)]})}),ce?i.jsxs("div",{className:"text-center py-6",children:[i.jsx("div",{className:"animate-spin w-6 h-6 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-2"}),i.jsx("p",{className:"text-gray-600 text-sm",children:"Loading canister information..."})]}):C?i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-green-800",children:"âœ… ckNFT Canister Ready"}),i.jsx("p",{className:"text-xs text-green-600 font-mono mt-1",children:y()})]})]})}):S?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-gray-700",children:"Canister Creation"}),i.jsxs("div",{className:"text-right",children:[i.jsx("span",{className:"text-sm font-medium",children:Q(S)}),i.jsxs("p",{className:"text-xs text-gray-500",children:["â‰ˆ ",L(S)," ICP"]})]})]}),i.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t",children:[i.jsx("span",{className:"text-sm text-gray-700",children:"Your Balance"}),i.jsx("div",{className:"text-right",children:p?i.jsx("span",{className:"text-sm text-gray-500",children:"Loading..."}):m!==void 0?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:_e("text-sm font-medium",V(S)?"text-green-600":"text-red-600"),children:Q(m)}),i.jsxs("p",{className:"text-xs text-gray-500",children:["â‰ˆ ",L(m)," ICP"]})]}):i.jsx("span",{className:"text-sm text-red-600",children:"Unable to load"})})]})]}),P&&i.jsx("button",{onClick:M,disabled:!P||E.createCanister.isPending,className:_e("w-full px-4 py-2 rounded-lg text-sm font-medium transition-colors",P&&!E.createCanister.isPending?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:E.createCanister.isPending?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Creating..."]}):`Create Canister (${Q(S)})`})]}):i.jsx("div",{className:"p-4 text-center border-2 border-dashed border-gray-300 rounded-lg",children:i.jsx("p",{className:"text-sm text-gray-500",children:"Select NFTs to see canister costs"})})]}):(console.log("collectionMetadata",w),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Canister Costs"}),i.jsx("p",{className:"text-gray-600",children:"Review the costs for creating your NFT canisters on the Internet Computer."})]}),U&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-red-800",children:["Error loading information: ",(()=>{try{return q instanceof Error?q.message:b instanceof Error?b.message:ne instanceof Error?ne.message:q?String(q):b?String(b):ne?String(ne):"Unknown error occurred"}catch(F){return console.error("Error formatting error message:",F,{costError:q,balanceError:b,existingError:ne}),"Error formatting error message"}})()]})}),E.createCanister.error&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-red-800",children:["Canister creation failed: ",E.createCanister.error instanceof Error?E.createCanister.error.message:String(E.createCanister.error)]})}),E.createCanister.isSuccess&&!C&&i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsx("p",{className:"text-sm text-green-800",children:"âœ… Canister created successfully! Refreshing canister information..."})}),ce?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading canister information and your balance..."})]}):C?i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500 mt-0.5 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-green-800 mb-1",children:"ckNFT Canister Already Exists"}),i.jsx("p",{className:"text-sm text-green-700 mb-2",children:"A canister for this contract already exists on the Internet Computer."}),i.jsxs("p",{className:"text-xs text-green-600 font-mono mb-3",children:["Canister ID: ",y()]}),H?i.jsx("div",{className:"mt-2 p-2 bg-green-100 rounded text-xs",children:i.jsx("div",{className:"animate-pulse text-green-700",children:"Loading collection metadata..."})}):J?i.jsx("div",{className:"mt-2 p-2 bg-yellow-100 border border-yellow-200 rounded text-xs",children:i.jsx("div",{className:"text-yellow-700",children:"Unable to load collection metadata"})}):w?i.jsxs("div",{className:"mt-2 p-3 bg-green-100 border border-green-200 rounded text-sm",children:[w.name||w.symbol||w.description||w.totalSupply!==null||w.supplyCap!==null||w.royalties?i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[w.name&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-800",children:"Name:"}),i.jsx("span",{className:"ml-1 text-green-700",children:w.name})]}),w.symbol&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-800",children:"Symbol:"}),i.jsx("span",{className:"ml-1 text-green-700",children:w.symbol})]}),w.description&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("span",{className:"font-medium text-green-800",children:"Description:"}),i.jsx("p",{className:"ml-1 text-green-700 text-xs mt-1",children:w.description})]}),w.totalSupply!==null&&w.totalSupply!==void 0&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-800",children:"Total Supply:"}),i.jsx("span",{className:"ml-1 text-green-700",children:String(w.totalSupply)})]}),w.supplyCap!==null&&w.supplyCap!==void 0&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-800",children:"Supply Cap:"}),i.jsx("span",{className:"ml-1 text-green-700",children:String(w.supplyCap)})]}),w.royalties&&i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-800",children:"Royalties:"}),i.jsxs("span",{className:"ml-1 text-green-700",children:[(Number(w.royalties)/100).toFixed(2),"%"]})]})]}):i.jsxs("div",{className:"text-sm text-amber-700 mb-2",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i.jsx("span",{className:"font-medium",children:"Canister Metadata Not Yet Initialized"})]}),i.jsx("p",{className:"text-xs text-amber-600 mt-1 ml-6",children:"This canister exists but its collection metadata hasn't been set up yet. The metadata will be populated during the first NFT bridging operation."})]}),w.raw&&i.jsxs("details",{className:"mt-3 p-2 bg-gray-100 rounded",children:[i.jsx("summary",{className:"text-xs text-gray-600 cursor-pointer hover:text-gray-800",children:"ðŸ” Debug: Raw Metadata (Click to expand)"}),i.jsx("pre",{className:"mt-2 text-xs text-gray-700 overflow-x-auto",children:JSON.stringify(w.raw,(F,I)=>typeof I=="bigint"?`BigInt(${I.toString()})`:I,2)})]})]}):i.jsx("div",{className:"mt-2 p-2 bg-gray-100 rounded text-xs",children:i.jsx("div",{className:"text-gray-600",children:"No collection metadata available"})})]})]})}),i.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("strong",{children:"No additional costs required!"})," Since the canister already exists, you can proceed directly to bridge your NFTs without paying canister creation fees."]})})]}):S?i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 border border-gray-200 rounded-lg",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-700",children:"Canister Creation Cost"}),i.jsxs("div",{className:"text-right",children:[i.jsxs("span",{className:"font-medium",children:[Q(S)," Cycles"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:["â‰ˆ ",L(S)," ICP"]})]})]}),i.jsxs("div",{className:"flex justify-between items-center border-t pt-3",children:[i.jsx("span",{className:"text-gray-700",children:"Your Cycles Balance"}),i.jsx("div",{className:"text-right",children:p?i.jsx("span",{className:"text-gray-500",children:"Loading..."}):m!==void 0?i.jsxs(i.Fragment,{children:[i.jsxs("span",{className:_e("font-medium",V(S)?"text-green-600":"text-red-600"),children:[Q(m)," Cycles"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:["â‰ˆ ",L(m)," ICP"]})]}):i.jsx("span",{className:"text-red-600",children:"Unable to load"})})]}),m!==void 0&&S&&i.jsx("div",{className:"border-t pt-3",children:V(S)?i.jsxs("div",{className:"flex items-center text-green-700",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:"Sufficient balance available"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center text-red-700",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i.jsxs("span",{className:"text-sm font-medium",children:["Insufficient balance (need ",Q(S-m)," more cycles)"]})]}),i.jsx("p",{className:"text-xs text-red-600",children:"You need to top up your cycles balance before proceeding."})]})})]})}),S&&i.jsx("div",{className:"p-4 border border-gray-200 rounded-lg",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-700",children:"Existing Approval"}),i.jsx("div",{className:"text-right",children:k?i.jsx("span",{className:"text-gray-500",children:"Checking..."}):z?z.isSufficient&&!z.isExpired?i.jsxs("div",{className:"flex items-center text-green-600",children:[i.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:"Approved"})]}):i.jsxs("div",{className:"flex items-center text-amber-600",children:[i.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:z.isExpired?"Expired":"Insufficient"})]}):i.jsxs("div",{className:"flex items-center text-red-600",children:[i.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:"None"})]})})]}),z&&i.jsxs("div",{className:"text-xs text-gray-600 border-t pt-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Current Allowance:"}),i.jsxs("span",{className:"font-mono",children:[N(z.allowance)," Cycles"]})]}),z.expires_at&&i.jsxs("div",{className:"flex justify-between mt-1",children:[i.jsx("span",{children:"Expires:"}),i.jsx("span",{className:"font-mono",children:new Date(Number(z.expires_at)/1e6).toLocaleString()})]})]}),S&&(!(z!=null&&z.isSufficient)||(z==null?void 0:z.isExpired))&&i.jsxs("div",{className:"border-t pt-3",children:[i.jsx("button",{onClick:async()=>{if(S)try{const F=it.fromText("uzt4z-lp777-77774-qaabq-cai"),I=S*BigInt(110)/BigInt(100),ee=BigInt(Date.now()*1e6)+BigInt(24*60*60*1e9);await h.mutateAsync({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:I,expected_allowance:[],expires_at:[ee],spender:{owner:F,subaccount:[]}})}catch(F){console.error("Manual approval failed:",F)}},disabled:g,className:_e("w-full px-3 py-2 text-sm rounded-md font-medium transition-colors",g?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-amber-600 text-white hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2"),children:g?"Approving...":"Pre-approve Cycles"}),v&&i.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Approval failed: ",v instanceof Error?v.message:String(v)]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will approve 110% of the required amount for future canister creations."})]})]})}),P&&i.jsx("button",{onClick:M,disabled:!P||E.createCanister.isPending,className:_e("w-full px-4 py-3 rounded-lg font-medium transition-colors",P&&!E.createCanister.isPending?"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:E.createCanister.isPending?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Creating Canister..."]}):`Create ckNFT Canister (${Q(S)} Cycles)`}),i.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("strong",{children:"What are cycles?"})," Cycles are the unit of payment for computation and storage on the Internet Computer. This cost covers creating your NFT canister where your bridged NFTs will be securely stored and managed on-chain."]})}),m!==void 0&&S&&!V(S)&&i.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-amber-800 mb-2",children:[i.jsx("strong",{children:"Need more cycles?"})," You can top up your cycles balance by:"]}),i.jsxs("ul",{className:"text-xs text-amber-700 space-y-1 ml-4",children:[i.jsx("li",{children:"â€¢ Converting ICP to cycles through the NNS"}),i.jsx("li",{children:"â€¢ Using a cycles wallet or faucet"}),i.jsx("li",{children:"â€¢ Having someone transfer cycles to your account"})]})]})]}):i.jsx("div",{className:"p-6 text-center border-2 border-dashed border-gray-300 rounded-lg",children:i.jsx("p",{className:"text-gray-500",children:"Select NFTs to see canister creation costs"})})]}))}var sy={};function iy({selectedNFTs:e,mintCosts:t,onMintCostsCalculated:r}){const{chainId:n}=Ji(),{user:s}=Er(),a=sy.CYCLES_LEDGER_CANISTER_ID||"um5iw-rqaaa-aaaaq-qaaba-cai",o=Vi(a),{useBalance:c,useApprove:l}=o,d=c(s!=null&&s.principal?{owner:s.principal,subaccount:[]}:void 0),u=l(),h=d.data,m=d.isLoading,p=d.error,b=u.isPending,g=u.error,v=C=>{const w=BigInt(1e12),H=C/w,y=(C%w).toString().padStart(12,"0").slice(0,3);return`${H.toLocaleString()}.${y} TC`},N=C=>h?h>=C:!1,V=Hi("uzt4z-lp777-77774-qaabq-cai"),E=_.useMemo(()=>{if(e.length===0||!(s!=null&&s.principal))return[];const C=n??1,j=C===1?{Ethereum:[BigInt(1)]}:C===137?{Ethereum:[BigInt(137)]}:C===56?{Ethereum:[BigInt(56)]}:C===31337?{Ethereum:[BigInt(31337)]}:C===42161?{Ethereum:[BigInt(42161)]}:C===10?{Ethereum:[BigInt(10)]}:C===8453?{Ethereum:[BigInt(8453)]}:{Ethereum:[BigInt(1)]};return e.map(w=>({nft:{tokenId:BigInt(w.tokenId),contract:w.contractAddress,network:j},resume:[],mintToAccount:{owner:s.principal,subaccount:[]},spender:[]}))},[e,n,s==null?void 0:s.principal]),[Y,O]=_.useState(!1),[Z,q]=_.useState(null),[R,K]=_.useState(null);_.useEffect(()=>{E.length>0&&!R&&!Y&&(O(!0),q(null),V.getMintCost.mutateAsync(E).then(C=>{let j=BigInt(0);for(const w of C)w!==null&&(j+=w);K(j),r(j)}).catch(C=>{console.error("Failed to get mint costs:",C),q(C instanceof Error?C.message:String(C))}).finally(()=>{O(!1)}))},[E,R,Y,V.getMintCost,r]);const ne=t||R,z=Y||m,k=Z||p,{data:S,isLoading:ce}=el(ne||void 0);console.log("Allowance info:",S);const U=C=>(Number(C)/1e12).toFixed(6);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"NFT Mint Costs"}),i.jsx("p",{className:"text-gray-600",children:"Review the cycles needed to mint your selected NFTs on the Internet Computer."})]}),k&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-red-800",children:["Error loading mint costs: ",k instanceof Error?k.message:String(k)]})}),z?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),i.jsxs("p",{className:"text-gray-600",children:["Calculating mint costs for ",e.length," NFT",e.length!==1?"s":"","..."]})]}):ne?i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 border border-gray-200 rounded-lg",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{className:"text-gray-700",children:["Total Mint Cost (",e.length," NFT",e.length!==1?"s":"",")"]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("span",{className:"font-medium",children:[v(ne)," Cycles"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:["â‰ˆ ",U(ne)," ICP"]})]})]}),e.length>1&&i.jsx("div",{className:"text-xs text-gray-600 border-t pt-2",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Per NFT Cost:"}),i.jsxs("span",{className:"font-mono",children:["â‰ˆ ",v(ne/BigInt(e.length))," Cycles"]})]})}),i.jsxs("div",{className:"flex justify-between items-center border-t pt-3",children:[i.jsx("span",{className:"text-gray-700",children:"Your Cycles Balance"}),i.jsx("div",{className:"text-right",children:m?i.jsx("span",{className:"text-gray-500",children:"Loading..."}):h!==void 0?i.jsxs(i.Fragment,{children:[i.jsxs("span",{className:_e("font-medium",N(ne)?"text-green-600":"text-red-600"),children:[v(h)," Cycles"]}),i.jsxs("p",{className:"text-xs text-gray-500",children:["â‰ˆ ",U(h)," ICP"]})]}):i.jsx("span",{className:"text-red-600",children:"Unable to load"})})]}),h!==void 0&&ne&&i.jsx("div",{className:"border-t pt-3",children:N(ne)?i.jsxs("div",{className:"flex items-center text-green-700",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:"Sufficient balance available"})]}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center text-red-700",children:[i.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i.jsxs("span",{className:"text-sm font-medium",children:["Insufficient balance (need ",v(ne-h)," more cycles)"]})]}),i.jsx("p",{className:"text-xs text-red-600",children:"You need to top up your cycles balance before proceeding."})]})})]})}),i.jsx("div",{className:"p-4 border border-gray-200 rounded-lg",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-700",children:"Mint Approval Status"}),i.jsx("div",{className:"text-right",children:ce?i.jsx("span",{className:"text-gray-500",children:"Checking..."}):S?S.isSufficient&&!S.isExpired?i.jsxs("div",{className:"flex items-center text-green-600",children:[i.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:"Approved"})]}):i.jsxs("div",{className:"flex items-center text-amber-600",children:[i.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:S.isExpired?"Expired":"Insufficient"})]}):i.jsxs("div",{className:"flex items-center text-red-600",children:[i.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm font-medium",children:"Not Approved"})]})})]}),S&&i.jsxs("div",{className:"text-xs text-gray-600 border-t pt-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{children:"Current Allowance:"}),i.jsxs("span",{className:"font-mono",children:[v(S.allowance)," Cycles"]})]}),S.expires_at&&i.jsxs("div",{className:"flex justify-between mt-1",children:[i.jsx("span",{children:"Expires:"}),i.jsx("span",{className:"font-mono",children:new Date(Number(S.expires_at)/1e6).toLocaleDateString()})]})]}),ne&&(!(S!=null&&S.isSufficient)||(S==null?void 0:S.isExpired))&&i.jsxs("div",{className:"border-t pt-3",children:[i.jsx("button",{onClick:async()=>{if(ne)try{const C=it.fromText("uzt4z-lp777-77774-qaabq-cai"),j=ne*BigInt(110)/BigInt(100),w=BigInt(Date.now()*1e6)+BigInt(24*60*60*1e9);await u.mutateAsync({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:j,expected_allowance:[],expires_at:[w],spender:{owner:C,subaccount:[]}})}catch(C){console.error("Mint approval failed:",C)}},disabled:b,className:_e("w-full px-3 py-2 text-sm rounded-md font-medium transition-colors",b?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"),children:b?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin w-3 h-3 border-2 border-white border-t-transparent rounded-full mr-2"}),"Approving..."]}):`Approve Cycles for Minting (${v(ne*BigInt(110)/BigInt(100))} Cycles)`}),g&&i.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Approval failed: ",g instanceof Error?g.message:String(g)]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This will approve 110% of the required amount for minting operations."})]})]})}),i.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("strong",{children:"About NFT minting costs:"})," Each NFT requires cycles to mint on the Internet Computer. This covers the computational cost of creating the NFT, storing metadata, and updating the canister state."]})}),h!==void 0&&ne&&!N(ne)&&i.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-amber-800 mb-2",children:[i.jsx("strong",{children:"Need more cycles?"})," You can top up your cycles balance by:"]}),i.jsxs("ul",{className:"text-xs text-amber-700 space-y-1 ml-4",children:[i.jsx("li",{children:"â€¢ Converting ICP to cycles through the NNS"}),i.jsx("li",{children:"â€¢ Using a cycles wallet or faucet"}),i.jsx("li",{children:"â€¢ Having someone transfer cycles to your account"})]})]})]}):i.jsx("div",{className:"p-6 text-center border-2 border-dashed border-gray-300 rounded-lg",children:i.jsx("p",{className:"text-gray-500",children:"Select NFTs to see minting costs"})})]})}function Wd({canisterId:e,supportedNetworks:t=["ethereum","polygon"],nftDiscoveryService:r,onComplete:n,onCancel:s,className:a,modal:o=!1,initialStep:c,mockSelectedNFTs:l,mockWalletConnected:d,mockCanisterCosts:u,mockMintCosts:h,mockImportResult:m}){var Ae,Re;const p={ethereum:1,polygon:137,bsc:56,hardhat:31337,"hardhat-2":1338,arbitrum:42161,optimism:10,base:8453},b=Object.fromEntries(Object.entries(p).map(([de,G])=>[G,de])),[g,v]=_.useState(c||"connect"),[N,V]=_.useState(l||[]),[E,Y]=_.useState(null),[O,Z]=_.useState(u?BigInt(u):null),[q,R]=_.useState(h?BigInt(h):null),[K,ne]=_.useState(m||null),[z,k]=_.useState(null),{activeAddress:S,isUnlocked:ce,connectWallet:U,switchChain:C,chainId:j}=Ji(),{user:w}=Er(),H=Hi("uzt4z-lp777-77774-qaabq-cai"),J=_.useMemo(()=>{if(N.length===0)return null;const de=N[0].contractAddress;N.every(X=>X.contractAddress===de)||console.warn("âš ï¸ Selected NFTs are from different contracts. Only NFTs from the first contract will be bridged:",de);let $;if(E)$=E;else if(j)$=j===1?{Ethereum:[BigInt(1)]}:j===137?{Ethereum:[BigInt(137)]}:j===56?{Ethereum:[BigInt(56)]}:j===31337?{Ethereum:[BigInt(31337)]}:j===1338?{Ethereum:[BigInt(1338)]}:j===42161?{Ethereum:[BigInt(42161)]}:j===10?{Ethereum:[BigInt(10)]}:j===8453?{Ethereum:[BigInt(8453)]}:{Ethereum:[BigInt(1)]};else return null;return{contract:de,network:$}},[N,E,j]);_.useEffect(()=>{console.log("ðŸ” Import wizard contract pointer updated:",{contractPointer:J,targetNetwork:E,chainId:j,hasSelectedNFTs:N.length>0})},[J,E,j,N.length]);const y=d!==void 0?d:ce,M=d?"0x742d35Cc6635C0532925a3b8D11e432f1b7C4b7b":S,P=_.useCallback(de=>{try{let G=de.replace(/\x00/g,"").replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"");const $=new TextEncoder,X=new TextDecoder("utf-8",{fatal:!1}),le=$.encode(G);return G=X.decode(le),G=G.replace(/\uFFFD/g,""),G.trim()}catch(G){return console.warn("Error sanitizing text:",G,"Original:",de),de.replace(/[^\x20-\x7E\n]/g,"").trim()}},[]),Q=_.useCallback(de=>{const G=iu(de);return k(G),G},[]),L=_.useCallback((de,G,$,X)=>{if(!z)return;const le=au(z,de,{status:G,...$&&{error:$},...X&&{txHash:X}});k(le)},[z]),se=_.useCallback(de=>{if(!z)return;const G=ou(z,de);k(G)},[z]);_.useEffect(()=>{Q("evm-to-ic")},[Q]);const F=[{id:"connect",title:"Connect Wallet",description:"Connect your EVM wallet"},{id:"select",title:"Select NFTs",description:"Choose NFTs to import"},{id:"costs",title:"Canister Costs",description:"Review and pay canister fees"},{id:"gas",title:"NFT Mint Costs",description:"Review and approve cycles for NFT minting"},{id:"bridge",title:"Bridge Progress",description:"Monitor the bridging process"},{id:"complete",title:"Complete",description:"Import summary"}],I=F.findIndex(de=>de.id===g),ee=_.useCallback(()=>{switch(g){case"connect":return ce&&S&&E!==null;case"select":return N.length>0;case"costs":return O!==null;case"gas":return q!==null;case"bridge":return(K==null?void 0:K.success)===!0;default:return!1}},[g,ce,S,E,N,O,q,K]),D=_.useMemo(()=>{if(z!=null&&z.steps&&z.steps.some(G=>G.status==="failed"))return console.log("ðŸš¨ Bridge error detected in progress steps:",z.steps.filter(G=>G.status==="failed")),!0;if(g==="costs"){const de=!!H.createCanister.error;return de&&console.log("ðŸš¨ Canister creation error detected:",H.createCanister.error),de}if(g==="gas"){const de=!!H.mintFromEVM.error;return de&&console.log("ðŸš¨ Mint estimation error detected:",H.mintFromEVM.error),de}if(g==="bridge"){const de=!!(H.mintFromEVM.error||H.getApprovalAddress.error);return de&&console.log("ðŸš¨ Bridge mutation error detected:",{mintError:H.mintFromEVM.error,approvalError:H.getApprovalAddress.error}),de}return K&&!K.success?(console.log("ðŸš¨ Import result shows failure:",K.error),!0):!1},[z,g,H.createCanister.error,H.mintFromEVM.error,H.getApprovalAddress.error,K]),re=I>0&&(g!=="bridge"&&g!=="complete"||D);_.useEffect(()=>{var de;console.log("ðŸ”™ Back button state:",{currentStepIndex:I,currentStep:g,hasError:D,canGoPrev:re,progressSteps:(de=z==null?void 0:z.steps)==null?void 0:de.map(G=>({id:G.id,status:G.status}))})},[I,g,D,re,z==null?void 0:z.steps]);const oe=_.useCallback(()=>{if(!ee())return;const de=I+1;de<F.length&&v(F[de].id)},[I,ee,F]),pe=_.useCallback(()=>{if(!re)return;const de=I-1;de>=0&&v(F[de].id)},[I,re,F]),Ne=_.useCallback(async()=>{if(!(!N.length||!S||!J||!(w!=null&&w.principal))){v("bridge"),Q("evm-to-ic");try{L("connect-evm-wallet","loading"),L("connect-evm-wallet","completed"),console.log(`ðŸš€ Starting bridge process for ${N.length} NFT(s)`);const de=J.contract,G=N.filter(ie=>ie.contractAddress===de);if(G.length!==N.length&&console.warn(`âš ï¸ Filtered ${N.length-G.length} NFT(s) from different contracts. Bridging ${G.length} NFT(s) from contract ${de}`),G.length===0)throw new Error("No NFTs found for the selected contract");const $=G.filter(ie=>ie.ownershipStatus==="ready-to-mint"),X=G.filter(ie=>ie.ownershipStatus==="owned");if(console.log(`ðŸ“Š NFT breakdown for contract ${de}: ${$.length} ready-to-mint, ${X.length} owned`),X.length>0){L("approve-nft-transfer","loading"),console.log(`ðŸ”„ Processing ${X.length} owned NFT(s) for transfer`);for(let ie=0;ie<X.length;ie++){const we=X[ie];console.log(`ðŸš€ Processing owned NFT ${ie+1}/${X.length}: Token ${we.tokenId}`);const ye=await H.getApprovalAddress.mutateAsync({request:{account:{owner:w.principal,subaccount:[]},remoteNFTPointer:{tokenId:BigInt(we.tokenId),contract:J.contract,network:J.network}}});if(!ye)throw new Error(`Failed to get approval address for NFT ${we.tokenId}`);L("transfer-nft-to-bridge","loading",`Transferring NFT ${ie+1}/${X.length}`);try{if(!window.ethereum)throw new Error("MetaMask not detected");const{ethers:ke}=await jt(async()=>{const{ethers:De}=await import("./index-D16to4BB.js");return{ethers:De}},__vite__mapDeps([3,1,2,4,0])),Je=await new ke.BrowserProvider(window.ethereum).getSigner(),Tn=["function safeTransferFrom(address from, address to, uint256 tokenId) external","function transferFrom(address from, address to, uint256 tokenId) external","function ownerOf(uint256 tokenId) external view returns (address)"],rt=new ke.Contract(we.contractAddress,Tn,Je),zt=BigInt(we.tokenId);console.log(`ðŸ” Pre-transfer checks for NFT ${ie+1}:`,{tokenId:zt.toString(),from:S,to:ye,contract:we.contractAddress});try{const De=await rt.ownerOf(zt);if(console.log(`Current NFT ${ie+1} owner:`,De),console.log("User address:",S),De.toLowerCase()!==S.toLowerCase())throw new Error(`NFT ${ie+1} ownership mismatch. Current owner: ${De}, User: ${S}`)}catch(De){throw console.error(`Ownership check failed for NFT ${ie+1}:`,De),new Error(`Failed to verify NFT ${ie+1} ownership: ${De instanceof Error?De.message:"Unknown error"}`)}console.log(`ðŸš€ Transferring NFT ${ie+1} (${zt.toString()}) from ${S} to ${ye}`),L("transfer-nft-to-bridge","loading",`Executing NFT ${ie+1} transfer...`);try{const De=await rt.safeTransferFrom(S,ye,zt);console.log(`Transfer transaction ${ie+1} submitted:`,De.hash);const Bt=await De.wait();console.log(`Transfer ${ie+1} confirmed:`,Bt),L("transfer-nft-to-bridge","loading",`NFT ${ie+1} transferred successfully`)}catch(De){console.warn(`safeTransferFrom failed for NFT ${ie+1}, trying transferFrom:`,De);const Bt=await rt.transferFrom(S,ye,zt);console.log(`Transfer transaction ${ie+1} submitted (via transferFrom):`,Bt.hash);const Et=await Bt.wait();console.log(`Transfer ${ie+1} confirmed (via transferFrom):`,Et),L("transfer-nft-to-bridge","loading",`NFT ${ie+1} transferred successfully`)}}catch(ke){console.error(`NFT ${ie+1} transfer failed:`,ke);let ze=`NFT ${ie+1} transfer failed`;throw ke instanceof Error&&(ke.message.includes("execution reverted")?ke.message.includes("ERC721: transfer caller is not owner nor approved")?ze=`Transfer failed for NFT ${ie+1}: Not approved for transfer. Please ensure the NFT is approved.`:ke.message.includes("ERC721: transfer from incorrect owner")?ze=`Transfer failed for NFT ${ie+1}: You do not own this NFT or ownership has changed.`:ke.message.includes("ERC721: transfer to the zero address")?ze=`Transfer failed for NFT ${ie+1}: Invalid bridge address received.`:ze=`Transfer failed for NFT ${ie+1}: ${ke.message}`:ze=`NFT ${ie+1}: ${ke.message}`),L("transfer-nft-to-bridge","failed",ze),console.error(`ðŸ”¥ Transfer error details for NFT ${ie+1}:`,{error:ke,tokenId:we.tokenId,contract:we.contractAddress,from:S,to:ye,network:j}),new Error(ze)}ie<X.length-1&&await new Promise(ke=>setTimeout(ke,1e3)),$.push(we),console.log(`âœ… NFT ${ie+1}/${X.length} transferred successfully and added to mint queue`)}await new Promise(ie=>setTimeout(ie,2e3)),L("approve-nft-transfer","completed",`${X.length} NFT(s) transferred`),L("transfer-nft-to-bridge","completed",`All ${X.length} owned NFT(s) transferred successfully`)}else console.log("ðŸƒâ€â™‚ï¸ No owned NFTs to transfer, skipping transfer steps"),L("approve-nft-transfer","completed","Skipped - No owned NFTs to transfer"),L("transfer-nft-to-bridge","completed","Skipped - No owned NFTs to transfer");L("create-cknft-canister","loading");let le;try{const we=(await H.getCkNFTCanister.mutateAsync([J]))[0];if(we)console.log("Using existing canister:",we),le={Ok:we};else{const Ce=N[0];le=await H.createCanister.mutateAsync({pointer:J,defaults:{name:P(Ce.name||"ckNFT Collection"),symbol:P(`ck${Ce.contractAddress.slice(-4)}`),description:P(`Bridged NFT collection from ${J.contract}`)},requiredCycles:O||BigInt(0),skipApproval:!1})}}catch(ie){console.log("Failed to check existing canister, creating new one:",ie);const we=N[0];le=await H.createCanister.mutateAsync({pointer:J,defaults:{name:P(we.name||"ckNFT Collection"),symbol:P(`ck${we.contractAddress.slice(-4)}`),description:P(`Bridged NFT collection from ${J.contract}`)},requiredCycles:O||BigInt(0),skipApproval:!1})}if("Err"in le){const ie=(()=>{try{return JSON.stringify(le.Err,(we,Ce)=>typeof Ce=="bigint"?Ce.toString():Ce)}catch{return String(le.Err)}})();throw new Error(`Canister creation failed: ${ie}`)}const be="Ok"in le?le.Ok:le;L("create-cknft-canister","completed"),L("mint-cknft","loading"),console.log(`ðŸŽ¯ Starting mint process for ${$.length} NFT(s)`);const he=[],Ee=[];for(let ie=0;ie<$.length;ie++){const we=$[ie];console.log(`ðŸ”„ Minting NFT ${ie+1}/${$.length}: Token ${we.tokenId}`),L("mint-cknft","loading",`Minting NFT ${ie+1}/${$.length}...`);const Ce={nft:{tokenId:BigInt(we.tokenId),contract:J.contract,network:J.network},resume:[],mintToAccount:{owner:w.principal,subaccount:[]},spender:[]};console.log(`ðŸ” Mint request data for NFT ${ie+1} (preserving token ID ${we.tokenId}):`,{mintRequest:{...Ce,nft:{...Ce.nft,tokenId:Ce.nft.tokenId.toString()},mintToAccount:{...Ce.mintToAccount,owner:Ce.mintToAccount.owner.toString()}},userPrincipal:w.principal,userPrincipalType:typeof w.principal,mintCosts:q==null?void 0:q.toString(),contractPointer:J,selectedNFT:we,note:"Token ID should be preserved: "+we.tokenId});const ye=await H.mintFromEVM.mutateAsync({request:Ce,requiredCycles:q||void 0,skipApproval:ie>0});if(console.log(`âœ… Raw mint result for NFT ${ie+1} (original token ID: ${we.tokenId}):`,ye),console.log("ðŸ” Mint result type analysis:",{resultType:typeof ye,hasOk:"Ok"in ye,hasErr:"Err"in ye,okValue:"Ok"in ye?ye.Ok:null,okValueType:"Ok"in ye?typeof ye.Ok:null,originalTokenId:we.tokenId,expectedBehavior:"The IC token should maintain the same ID as the original EVM token"}),"Ok"in ye){const ke=ye.Ok,ze=we.tokenId;console.log(`âœ… Mint request ${ie+1} submitted successfully with ID: ${ke.toString()}`),console.log("ðŸ” Polling for mint completion status...");let Je=0;const Tn=30;let rt=null,zt="";for(;Je<Tn;)try{const Bt=(await H.getMintStatus.mutateAsync([ke]))[0];if(Bt&&Array.isArray(Bt)&&Bt.length>0)if(rt=Bt[0],console.log(`ðŸ“Š Mint status poll ${Je+1}:`,rt),"Complete"in rt){const ws=rt.Complete.mintTrx;console.log(`ðŸŽ‰ Mint completed! Transaction ID: ${ws.toString()}`),console.log(`ðŸ” Token ID validation - Original: ${ze}, Expected to be preserved per ICRC-99 protocol`),zt=`Token ${ze} (IC Tx: ${ws.toString()})`,console.log(`âœ… Token ID preserved correctly: ${ze} (Mint Tx: ${ws})`);break}else if("Err"in rt){const Et=(()=>{try{return JSON.stringify(rt.Err,(ws,Ki)=>typeof Ki=="bigint"?Ki.toString():Ki)}catch{return String(rt.Err)}})();throw new Error(`Mint failed for NFT ${ie+1} (Token ${ze}): ${Et}`)}else{const Et=Object.keys(rt)[0];console.log(`â³ Mint still in progress... Status: ${Et}`),Et==="CheckingOwner"?L("mint-cknft","loading",`Verifying ownership for NFT ${ie+1}/${$.length}`):Et==="RetrievingMetadata"?L("mint-cknft","loading",`Retrieving metadata for NFT ${ie+1}/${$.length}`):Et==="Transferring"?L("mint-cknft","loading",`Transferring NFT ${ie+1}/${$.length}`):Et==="Minting"&&L("mint-cknft","loading",`Minting NFT ${ie+1}/${$.length} on IC`)}else console.log("â³ Waiting for mint status to be available...");Je++,Je<Tn&&!("Complete"in(rt||{}))&&await new Promise(Et=>setTimeout(Et,2e3))}catch(De){console.error(`âŒ Error checking mint status (attempt ${Je+1}):`,De),Je++,Je<Tn&&await new Promise(Bt=>setTimeout(Bt,2e3))}(!rt||!("Complete"in rt))&&(console.warn(`âš ï¸ Mint status polling timed out for NFT ${ie+1}`),zt=`Token ${ze} (IC - Pending)`),Ee.push(zt),he.push(ye),console.log(`ðŸŽ‰ NFT ${ie+1}/${$.length} processed: ${zt}`)}else{const ke=(()=>{try{return JSON.stringify(ye.Err,(ze,Je)=>typeof Je=="bigint"?Je.toString():Je)}catch{return String(ye.Err)}})();throw new Error(`Mint failed for NFT ${ie+1} (Token ${we.tokenId}): ${ke}`)}}L("mint-cknft","completed",`Successfully minted ${he.length} NFT(s)`),L("verify-mint-complete","loading"),L("verify-mint-complete","completed",`All ${he.length} NFT(s) verified`);const He=$.map(ie=>ie.tokenId);ne({success:!0,icTransactionHash:Ee.join(" | "),canisterAddress:be.toString(),tokenId:He.join(", ")}),console.log("ðŸŽ‰ Multi-NFT bridge process completed successfully!",{mintedCount:he.length,tokenReferences:Ee,canisterId:be.toString(),tokenIds:He}),v("complete"),n==null||n({success:!0,icTransactionHash:Ee.join(" | "),canisterAddress:be.toString(),tokenId:He.join(", ")})}catch(de){console.error("Bridge process failed:",de);const G=de instanceof Error?de.message:"Bridge failed";if(z!=null&&z.steps){const $=z.steps.find(X=>X.status==="loading");$&&L($.id,"failed",G)}ne({success:!1,error:G}),n==null||n({success:!1,error:G})}}},[N,S,J,w,H,O,L,n,z,Q]),Te=()=>{switch(g){case"connect":return i.jsx(wf,{isConnected:y,account:M,supportedNetworks:t,currentNetwork:j&&b[j]||null,onConnect:U,onSwitchNetwork:de=>{const G=p[de];if(G)return C(G);throw new Error(`Unsupported network: ${de}`)},selectedTargetNetwork:E&&"Ethereum"in E&&b[Number(E.Ethereum[0])]||void 0,onTargetNetworkChange:de=>{const G=p[de];G&&(console.log("ðŸŽ¯ Target network selected for import:",de,"Chain ID:",G),Y({Ethereum:[BigInt(G)]}))}});case"select":return i.jsx(ty,{account:M,network:j&&b[j]||null,selectedNFTs:N,onSelectionChange:V,nftDiscoveryService:r});case"costs":return i.jsx(ny,{selectedNFTs:N,costs:O,onCostsCalculated:Z,compact:D});case"gas":return i.jsx(iy,{selectedNFTs:N,mintCosts:q,onMintCostsCalculated:R});case"bridge":return i.jsx(ay,{progress:z,onRetryStep:se,onToggleStage:()=>{},setProgress:k});case"complete":return i.jsx(oy,{result:K,onStartNew:()=>{v("connect"),V([]),Z(null),R(null),ne(null),Q("evm-to-ic")},onClose:()=>s==null?void 0:s()});default:return null}},ae=i.jsxs("div",{className:_e("bg-white rounded-lg shadow-lg",o&&"max-w-4xl mx-auto",a),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Import NFTs from EVM"}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Step ",I+1," of ",F.length,": ",(Ae=F[I])==null?void 0:Ae.description]})]}),s&&i.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(nu,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"px-6 py-4 border-b border-gray-100",children:[i.jsx("div",{className:"flex items-center justify-between",children:F.map((de,G)=>i.jsxs("div",{className:_e("flex items-center",G<F.length-1&&"flex-1"),children:[i.jsx("div",{className:_e("flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium",G<I?"bg-green-100 text-green-600":G===I?D?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"),children:G<I?i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):G===I&&D?i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}):G+1}),i.jsx("span",{className:_e("ml-2 text-sm font-medium hidden sm:inline",G<=I?"text-gray-900":"text-gray-400",G===I&&D&&"text-red-600"),children:de.title}),G<F.length-1&&i.jsx("div",{className:_e("flex-1 h-0.5 mx-4",G<I?"bg-green-200":"bg-gray-200")})]},de.id))}),D&&i.jsx("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded-md",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("svg",{className:"w-4 h-4 text-red-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i.jsxs("span",{className:"text-sm text-red-700 font-medium",children:["Error in ",(Re=F[I])==null?void 0:Re.title]}),i.jsx("span",{className:"ml-2 text-xs text-red-600",children:"Use the Previous button to go back and retry"})]})})]}),i.jsx("div",{className:"p-6 min-h-[400px]",children:Te()}),i.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[i.jsxs("button",{onClick:pe,disabled:!re,className:_e("flex items-center px-4 py-2 text-sm font-medium rounded-md transition-colors",re?D?"text-white bg-red-600 hover:bg-red-700":"text-gray-700 bg-gray-100 hover:bg-gray-200":"text-gray-400 bg-gray-50 cursor-not-allowed"),children:[i.jsx(Dd,{className:"w-4 h-4 mr-1"}),D?"Go Back & Retry":"Previous"]}),i.jsxs("div",{className:"flex space-x-3",children:[g==="gas"&&ee()&&i.jsxs("button",{onClick:Ne,className:"flex items-center px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors",children:["Start Bridge",i.jsx(ia,{className:"w-4 h-4 ml-1"})]}),g!=="gas"&&g!=="bridge"&&g!=="complete"&&i.jsxs("button",{onClick:oe,disabled:!ee(),className:_e("flex items-center px-6 py-2 text-sm font-medium rounded-md transition-colors",ee()?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-100 cursor-not-allowed"),children:["Next",i.jsx(ia,{className:"w-4 h-4 ml-1"})]})]})]})]});return o?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:ae}):ae}function ay({progress:e,onRetryStep:t,onToggleStage:r,setProgress:n}){var c,l;if(!e)return i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Initializing bridge process..."})]});const a=(((c=e.steps)==null?void 0:c.filter(d=>d.status==="loading"||d.status==="failed"))||[])[0],o=((l=e.steps)==null?void 0:l.some(d=>d.status==="failed"))||!1;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:o?"Bridge Failed":"Bridge in Progress"}),i.jsx("p",{className:"text-gray-600",children:o?"An error occurred during the bridge process.":"Bridging your NFT to the Internet Computer..."})]}),a&&i.jsxs("div",{className:`p-4 rounded-lg border ${a.status==="failed"?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:[i.jsxs("div",{className:"flex items-center",children:[a.status==="loading"?i.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full mr-3"}):i.jsx("svg",{className:"w-5 h-5 text-red-500 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i.jsxs("div",{children:[i.jsxs("h4",{className:`font-medium ${a.status==="failed"?"text-red-800":"text-blue-800"}`,children:[a.status==="loading"?"In Progress: ":"Failed: ",a.title||a.id]}),a.error&&i.jsx("p",{className:"text-sm text-red-600 mt-1",children:a.error}),a.status==="loading"&&i.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Please wait..."})]})]}),a.status==="failed"&&i.jsxs("div",{className:"mt-3 space-x-2",children:[i.jsx("button",{onClick:()=>t(a.id),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors",children:"Retry Step"}),a.id==="transfer-nft-to-bridge"&&n&&i.jsx("button",{onClick:()=>{if(console.log("â­ï¸ Skipping failed transfer step for debugging"),e!=null&&e.steps){const d={...e},u=d.steps.findIndex(h=>h.id===a.id);u!==-1&&(d.steps[u]={...d.steps[u],status:"completed",error:void 0},n(d))}},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Skip for Testing"})]})]}),!a&&!o&&e.steps&&e.steps.length>0&&i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-green-800",children:"Bridge Complete!"}),i.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Your NFT has been successfully bridged."})]})]})}),i.jsxs("details",{className:"mt-6",children:[i.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 hover:text-gray-900",children:"Show Detailed Progress"}),i.jsx("div",{className:"mt-3 p-4 bg-gray-50 rounded-lg",children:i.jsx(bu,{progress:e,onRetryStep:t,onToggleStage:r})})]})]})}function oy({result:e,onStartNew:t,onClose:r}){const n=e.tokenId?e.tokenId.split(", "):[],s=e.icTransactionHash?e.icTransactionHash.split(" | "):[],a=n.length>1,o=u=>{const h=u.match(/Token (\d+) \(IC Tx: (\d+)\)/);if(h)return{original:h[1],ic:h[1],hasMismatch:!1,txId:h[2]};const m=u.match(/Token (\d+) \(IC - Pending\)/);if(m)return{original:m[1],ic:m[1],hasMismatch:!1,isPending:!0};const p=u.match(/Token (\d+) â†’ (\d+)/);if(p)return{original:p[1],ic:p[2],hasMismatch:!0};const b=u.match(/Token (\d+) \(IC/);if(b)return{original:b[1],ic:b[1],hasMismatch:!1};const g=u.match(/Token (\d+)/);return g?{original:g[1],ic:g[1],hasMismatch:!1}:{original:"Unknown",ic:"Unknown",hasMismatch:!1}},c=s.map(o),l=c.some(u=>u.hasMismatch),d=c.some(u=>u.isPending);return i.jsxs("div",{className:"space-y-6 text-center",children:[i.jsx("div",{children:e.success?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:a?`${n.length} NFTs Imported Successfully!`:"Import Successful!"}),i.jsx("p",{className:"text-gray-600",children:a?`Your ${n.length} NFTs have been successfully bridged to the Internet Computer.`:"Your NFT has been successfully bridged to the Internet Computer."}),l&&i.jsx("div",{className:"mt-2 p-2 bg-amber-50 border border-amber-200 rounded-md",children:i.jsx("p",{className:"text-sm text-amber-800",children:"âš ï¸ Note: Some token IDs were changed during minting. This should be investigated."})}),d&&i.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-md",children:i.jsx("p",{className:"text-sm text-blue-800",children:"â³ Note: Some mints are still pending completion. You can check back later for the final status."})})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Import Failed"}),i.jsx("p",{className:"text-gray-600",children:e.error})]})}),e.success&&i.jsxs("div",{className:"space-y-3 text-sm",children:[c.length>0&&i.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-green-800 mb-2",children:a?`${n.length} NFTs Bridged Successfully!`:"NFT Bridged Successfully!"}),a?i.jsx("div",{className:"space-y-2",children:c.map((u,h)=>i.jsx("div",{className:"text-green-700",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"font-medium",children:["NFT ",h+1,":"]}),i.jsx("div",{className:"text-right",children:u.hasMismatch?i.jsxs("div",{className:"text-amber-700",children:[i.jsxs("code",{className:"bg-amber-100 px-2 py-1 rounded text-xs",children:["EVM: ",u.original," â†’ IC: ",u.ic]}),i.jsx("div",{className:"text-xs text-amber-600 mt-1",children:"âš ï¸ Token ID changed"})]}):u.isPending?i.jsxs("div",{className:"text-blue-700",children:[i.jsxs("code",{className:"bg-blue-100 px-2 py-1 rounded text-xs",children:["Token ID: ",u.original]}),i.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"â³ Mint pending..."})]}):i.jsxs("div",{children:[i.jsxs("code",{className:"bg-green-100 px-2 py-1 rounded text-xs",children:["Token ID: ",u.original]}),i.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["ID preserved âœ“",u.txId?` (Tx: ${u.txId})`:""]})]})})]})},h))}):i.jsx("div",{className:"text-green-700",children:c[0].hasMismatch?i.jsxs("div",{className:"text-amber-700",children:[i.jsxs("code",{className:"bg-amber-100 px-2 py-1 rounded text-xs",children:["EVM: ",c[0].original," â†’ IC: ",c[0].ic]}),i.jsx("div",{className:"text-xs text-amber-600 mt-1",children:"âš ï¸ Token ID was changed during minting"})]}):c[0].isPending?i.jsxs("div",{className:"text-blue-700",children:[i.jsxs("code",{className:"bg-blue-100 px-2 py-1 rounded text-xs",children:["Token ID: ",c[0].original]}),i.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"â³ Mint still pending..."})]}):i.jsxs("div",{children:[i.jsxs("code",{className:"bg-green-100 px-2 py-1 rounded text-xs",children:["Token ID: ",c[0].original]}),i.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Token ID preserved correctly âœ“",c[0].txId?` (Tx: ${c[0].txId})`:""]})]})})]}),e.canisterAddress&&i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-blue-800 mb-1",children:"ckNFT Canister"}),i.jsxs("p",{className:"text-blue-700",children:["ID: ",i.jsx("code",{className:"bg-blue-100 px-2 py-1 rounded text-xs",children:e.canisterAddress})]})]}),i.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[i.jsxs("p",{className:"font-medium text-purple-800 mb-1",children:["Cross-Chain Token ID",a?"s":""]}),i.jsx("div",{className:"text-xs text-purple-600 mb-2",children:"NFT token IDs should remain the same on both EVM and IC networks"}),a?i.jsx("div",{className:"space-y-1",children:n.map((u,h)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{className:"text-purple-700",children:["Original EVM ID ",h+1,":"]}),i.jsx("code",{className:"bg-purple-100 px-2 py-1 rounded text-xs",children:u})]},h))}):i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-purple-700",children:"Original EVM ID:"}),i.jsx("code",{className:"bg-purple-100 px-2 py-1 rounded text-xs",children:n[0]})]})]}),e.evmTransactionHash&&i.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-gray-800 mb-1",children:"EVM Transaction"}),i.jsxs("p",{className:"text-gray-700",children:["Hash: ",i.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:e.evmTransactionHash})]})]})]}),i.jsxs("div",{className:"flex justify-center space-x-4",children:[i.jsx("button",{onClick:t,className:"px-6 py-2 text-blue-600 border border-blue-600 rounded-md hover:bg-blue-50 transition-colors",children:"Import More NFTs"}),i.jsx("button",{onClick:r,className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"Close"})]})]})}function cy(e){const[t,r]=_.useState({isSupported:!1,isLoading:!1});return _.useEffect(()=>{if(console.log("ðŸŽ¯ useICRC99Support effect triggered with canisterId:",e),!e){console.log("âŒ No canisterId provided, returning unsupported"),r({isSupported:!1,isLoading:!1});return}let n=!1;return(async()=>{console.log("ðŸš€ Starting ICRC-99 support check for:",e),r(a=>({...a,isLoading:!0}));try{console.log("ðŸ” Checking ICRC-99 support for NFT canister:",e);const a=it.fromText(e),{HttpAgent:o,Actor:c}=await jt(async()=>{const{HttpAgent:p,Actor:b}=await import("./index-CQEhYxiE.js").then(g=>g.a);return{HttpAgent:p,Actor:b}},__vite__mapDeps([0,1,2])),l=new o({host:"http://localhost:8080"});await l.fetchRootKey();const u=await c.createActor(({IDL:p})=>{const b=p.Vec(p.Tuple(p.Text,p.Reserved)),g=p.Variant({IC:p.Opt(p.Text),Ethereum:p.Opt(p.Nat),Solana:p.Opt(p.Nat),Bitcoin:p.Opt(p.Text),Other:b}),v=p.Record({contract:p.Text,network:g});return p.Service({icrc99_native_chain:p.Func([],[v],["query"])})},{agent:l,canisterId:a}).icrc99_native_chain();console.log("âœ… ICRC-99 support detected. Native chain result:",u);const h=u.network;let m;"IC"in h?m={IC:h.IC}:"Ethereum"in h?h.Ethereum.length>0?m={Ethereum:[BigInt(h.Ethereum[0])]}:m={Ethereum:[]}:"Solana"in h?h.Solana.length>0?m={Solana:[BigInt(h.Solana[0])]}:m={Solana:[]}:"Bitcoin"in h?m={Bitcoin:h.Bitcoin}:m={IC:[]},console.log("ðŸ”„ Transformed network for ContractPointer:",m),n||r({isSupported:!0,nativeChain:{network:m,contract:u.contract},isLoading:!1})}catch(a){console.log("âš ï¸ ICRC-99 not supported or call failed:",a),n||r({isSupported:!1,nativeChain:{network:{IC:[]},contract:e},isLoading:!1})}})(),()=>{n=!0}},[e]),t}function ly(e,t,r){const[n,s]=_.useState([]),[a,o]=_.useState(!0),[c,l]=_.useState(null),d=zf();return _.useEffect(()=>{let u=!1;async function h(){o(!0),l(null);try{const m=Hf.createActor(Jf,{agent:d,canisterId:e});let p,b=[],g=50,v=[];for(;b=(await m.icrc7_tokens_of({owner:it.fromText(t.owner),subaccount:t.subaccount?[t.subaccount]:[]},p!==void 0?[p]:[],[BigInt(g)])||[]).map(V=>BigInt(V)),!(b.length===0||(v.push(...b),b.length<g));)p=b[b.length-1];u||s(v)}catch(m){u||l(m)}finally{u||o(!1)}}return h(),()=>{u=!0}},[e,t==null?void 0:t.owner,t==null?void 0:t.subaccount,r==null?void 0:r.override,r==null?void 0:r.queryArgs,d]),{tokenIds:n,loading:a,error:c}}function dy({canisterId:e,tokenId:t,onMetadataLoaded:r}){const{metadata:n,loading:s,error:a}=qf(e,t);return _.useEffect(()=>{if(n&&!s&&!a){console.log("ðŸ” Processing metadata for token",t,"metadata:",n);const o={tokenId:t.toString(),canisterId:e,metadata:n,name:n.parsedMetadata.icrc97.name||`NFT #${t}`,description:n.parsedMetadata.icrc97.description||void 0,image:n.parsedMetadata.icrc97.image||void 0,attributes:n.parsedMetadata.icrc97.attributes||[]};console.log("ðŸŽ¯ Converted NFT object:",o),r(o)}},[n,s,a,t,e,r]),null}function uy({sourceCanisterId:e,selectedNFTs:t,onSelectionChange:r,userPrincipal:n,onCanisterChange:s}){const[a,o]=_.useState(!1),[c,l]=_.useState(null),[d,u]=_.useState([]),[h,m]=_.useState(0),[p,b]=_.useState(""),[g,v]=_.useState(e||""),[N,V]=_.useState(e||""),[E,Y]=_.useState(null),O=_.useCallback(w=>{if(!w.trim())return Y("Canister ID is required"),!1;try{return it.fromText(w.trim()),Y(null),V(w.trim()),l(null),s==null||s(w.trim()),!0}catch{return Y("Invalid canister ID format"),!1}},[s]),Z=_.useCallback(w=>{v(w),Y(null)},[]),q=_.useCallback(()=>{O(g)&&(u([]),m(0))},[g,O]),R=_.useMemo(()=>n?{owner:n.toString(),subaccount:void 0}:null,[n]),{tokenIds:K,loading:ne,error:z}=ly(N||"aaaaa-aa",R||{owner:"aaaaa-aa",subaccount:void 0});_.useEffect(()=>{if(z){l(z.message||"Failed to fetch owned tokens"),o(!1);return}if(!ne&&K.length===0){u([]),o(!1),m(0);return}!ne&&K.length>0&&(o(!0),l(null),u([]),m(0))},[K,ne,z]);const k=_.useCallback(w=>{console.log("ðŸ“¥ handleMetadataLoaded called with:",w),u(H=>{if(H.some(M=>M.tokenId===w.tokenId&&M.canisterId===w.canisterId))return console.log("âš ï¸ NFT already exists in list, skipping"),H;const y=[...H,w].sort((M,P)=>parseInt(M.tokenId)-parseInt(P.tokenId));return console.log("âœ… Updated ownedNFTs array:",y),y}),m(H=>{const J=H+1;return console.log(`ðŸ“Š Fetched count: ${J}/${K.length}`),J>=K.length&&(console.log("ðŸ All metadata fetched, stopping loading"),o(!1)),J})},[K.length]);_.useEffect(()=>{o(ne||K.length>0&&h<K.length)},[ne,K.length,h]);const S=_.useMemo(()=>{if(!p)return d;const w=p.toLowerCase();return d.filter(H=>{var J,y,M;return((J=H.name)==null?void 0:J.toLowerCase().includes(w))||((y=H.description)==null?void 0:y.toLowerCase().includes(w))||H.tokenId.includes(w)||((M=H.attributes)==null?void 0:M.some(P=>P.trait_type.toLowerCase().includes(w)||P.value.toLowerCase().includes(w)))})},[d,p]),ce=w=>t.some(H=>H.tokenId===w.tokenId&&H.canisterId===w.canisterId),U=w=>{const H={tokenId:w.tokenId,canisterId:w.canisterId,metadata:w.metadata||void 0,owner:n,image:w.image,name:w.name,description:w.description};ce(w)?r(t.filter(J=>!(J.tokenId===w.tokenId&&J.canisterId===w.canisterId))):r([...t,H])},C=()=>{const w=S.filter(H=>!ce(H)).map(H=>({tokenId:H.tokenId,canisterId:H.canisterId,metadata:H.metadata||void 0,owner:n,image:H.image,name:H.name,description:H.description}));r([...t,...w])},j=()=>{r([])};return n?i.jsxs("div",{className:"space-y-6",children:[!ne&&K.length>0&&N&&i.jsx(i.Fragment,{children:K.map(w=>i.jsx(dy,{canisterId:N,tokenId:w,onMetadataLoaded:k},`${N}-${w}`))}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select NFTs to Export"}),i.jsx("p",{className:"text-gray-600",children:"Choose the ckNFTs you want to export back to EVM blockchain. Enter the canister ID of the NFT collection you want to check."})]}),i.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"canister-id",className:"block text-sm font-medium text-gray-700 mb-2",children:"NFT Collection Canister ID"}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("input",{id:"canister-id",type:"text",value:g,onChange:w=>Z(w.target.value),placeholder:"e.g., umunu-kh777-77774-qaaca-cai",className:_e("w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",E?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300")}),E&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:E})]}),i.jsx("button",{onClick:q,disabled:!g.trim()||a,className:_e("px-6 py-2 text-sm font-medium rounded-md transition-colors",!g.trim()||a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:a?"Loading...":"Load NFTs"})]})]}),N&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsx("span",{children:"Currently viewing:"}),i.jsx("code",{className:"px-2 py-1 bg-gray-200 rounded text-xs font-mono",children:N}),i.jsx("button",{onClick:()=>{V(""),u([]),l(null)},className:"text-blue-600 hover:text-blue-700 ml-2",children:"Change Collection"})]})]})}),ne&&N&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(St,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Your NFTs"}),i.jsxs("p",{className:"text-gray-600",children:["Fetching your ckNFTs from ",N,"..."]})]}),c&&N&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Sr,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading NFTs"}),i.jsx("p",{className:"text-gray-600 mb-4",children:c}),i.jsxs("div",{className:"space-x-2",children:[i.jsx("button",{onClick:q,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Retry"}),i.jsx("button",{onClick:()=>{V(""),l(null)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",children:"Try Different Collection"})]})]}),!a&&!ne&&N&&K.length===0&&!c&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(dc,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No NFTs Found"}),i.jsxs("p",{className:"text-gray-600",children:["No ckNFTs found in canister ",N]}),i.jsx("button",{onClick:()=>{V(""),v("")},className:"mt-2 text-blue-600 hover:text-blue-700 text-sm",children:"Try Different Collection"})]}),!ne&&N&&K.length>0&&!c&&i.jsxs(i.Fragment,{children:[(a||h<K.length)&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(St,{className:"w-5 h-5 text-blue-600 animate-spin mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-blue-800",children:"Loading NFT metadata..."}),i.jsxs("p",{className:"text-sm text-blue-600",children:[h," of ",K.length," NFTs loaded"]})]})]}),i.jsx("div",{className:"text-right",children:i.jsx("div",{className:"w-32 bg-blue-200 rounded-full h-2",children:i.jsx("div",{className:"h-2 bg-blue-600 rounded-full transition-all duration-300",style:{width:`${h/K.length*100}%`}})})})]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsx("div",{className:"flex-1",children:i.jsx("input",{type:"text",placeholder:"Search NFTs by name, description, or attributes...",value:p,onChange:w=>b(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:C,disabled:S.every(w=>ce(w)),className:"px-4 py-2 text-sm font-medium text-blue-600 border border-blue-600 rounded-md hover:bg-blue-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Select All"}),i.jsx("button",{onClick:j,disabled:t.length===0,className:"px-4 py-2 text-sm font-medium text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Clear All"})]})]}),i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"font-medium text-blue-800",children:[t.length," NFT",t.length!==1?"s":""," selected"]}),i.jsxs("p",{className:"text-sm text-blue-600",children:[S.length," NFT",S.length!==1?"s":""," available"]})]}),t.length>0&&i.jsx("div",{className:"text-right",children:i.jsx("p",{className:"text-sm text-blue-600",children:"Ready for export to EVM"})})]})}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:S.map(w=>i.jsx(hy,{nft:w,selected:ce(w),onToggle:()=>U(w)},`${w.canisterId}-${w.tokenId}`))}),S.length===0&&p&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(dc,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),i.jsx("p",{className:"text-gray-600",children:"No NFTs match your search criteria"}),i.jsx("button",{onClick:()=>b(""),className:"mt-2 text-blue-600 hover:text-blue-700 text-sm",children:"Clear search"})]})]})]}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Sr,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connect Your Identity"}),i.jsx("p",{className:"text-gray-600",children:"Please connect your Internet Identity to view and select your ckNFTs for export."})]})}function hy({nft:e,selected:t,onToggle:r}){const[n,s]=_.useState(!1);return i.jsx("div",{className:"relative",children:i.jsxs("button",{onClick:r,className:_e("w-full p-3 border rounded-lg text-left transition-all cursor-pointer",t?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),children:[e.image&&!n?i.jsx("img",{src:e.image,alt:e.name||`NFT #${e.tokenId}`,className:"w-full h-32 object-cover rounded-md mb-2",onError:()=>s(!0)}):i.jsx("div",{className:"w-full h-32 bg-gray-100 rounded-md mb-2 flex items-center justify-center",children:i.jsx(dc,{className:"w-8 h-8 text-gray-400"})}),i.jsx("p",{className:"font-medium text-sm truncate",children:e.name||`NFT #${e.tokenId}`}),i.jsxs("p",{className:"text-xs text-gray-600",children:["#",e.tokenId]}),e.description&&i.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:e.description}),e.attributes&&e.attributes.length>0&&i.jsxs("div",{className:"mt-2 space-y-1",children:[e.attributes.slice(0,2).map((a,o)=>i.jsxs("div",{className:"flex justify-between text-xs",children:[i.jsx("span",{className:"text-gray-500 truncate",children:a.trait_type}),i.jsx("span",{className:"text-gray-700 font-medium truncate ml-1",children:a.value})]},o)),e.attributes.length>2&&i.jsxs("p",{className:"text-xs text-gray-500",children:["+",e.attributes.length-2," more"]})]}),t&&i.jsx("div",{className:"mt-2 text-xs font-medium text-blue-600",children:"âœ“ Selected for export"})]})})}var fy={};const my=e=>{const r=BigInt(1e12),n=e/r,a=(e%r).toString().padStart(12,"0").slice(0,3);return`${n.toLocaleString()}.${a}`},lc=e=>{const r=BigInt(1e12),n=e/r,a=(e%r).toString().padStart(12,"0").slice(0,3);return`${n.toLocaleString()}.${a} TC`},py="0x608060405234801561001057600080fd5b50600436106100365760003560e01c8063095ea7b31461003b57806318160ddd14610071575b600080fd5b61005560048036038101906100509190610234565b610090565b6040516100689190610289565b60405180910390f35b610079610221565b60405161008691906102e4565b60405180910390f35b600080fd5b6000808284019050838110156100ec576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016100e39061033c565b60405180910390fd5b8091505092915050565b60006101098383610095565b905092915050565b60008135905061012081610392565b919050565b60008135905061013481610399565b919050565b6000602082840312156101555761015461037d565b5b600061016384828501610111565b91505092915050565b600080604083850312156101835761018261037d565b5b600061019185828601610111565b92505060206101a285828601610125565b9150509250929050565b6101b581610362565b82525050565b6101c48161036e565b82525050565b60006101d7601b83610351565b91506101e28261038a565b602082019050919050565b60006101fa60208361035f565b9150610205826103b3565b602082019050919050565b61021981610378565b82525050565b600060208201905061023460008301846101ac565b92915050565b6000806040838503121561025157610250610382565b5b600061025f85828601610111565b925050602061027085828601610125565b9150509250929050565b610283816103a8565b82525050565b600060208201905061029e600083018461027a565b92915050565b60006020820190506102b960008301846101bb565b92915050565b600060208201905081810360008301526102d8816101ca565b9050919050565b60006020820190506102f46000830184610210565b92915050565b600061030582610358565b915061031083610358565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff038211156103455761034461035c565b5b828201905092915050565b6000819050919050565b6000819050919050565b60006103708261035f565b9050919050565b60008115159050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60006103b982610378565b9050919050565b7f536166654d6174683a206164646974696f6e206f766572666c6f770000000000600082015250565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600080fd5b61039b81610365565b81146103a657600080fd5b50565b6103b281610378565b81146103bd57600080fd5b5056fea26469706673582212203d8b9c1e1f0b2a3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f90a1b2c3d4e5f6078a64736f6c634300080700330000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000054d794e465400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000054d794e4654000000000000000000000000000000000000000000000000000000";function gy({selectedNFTs:e,targetChainId:t,remoteContractInfo:r,onRemoteContractInfoChange:n,sourceCanisterId:s,sourceContractPointer:a}){const[o,c]=_.useState(null),[l,d]=_.useState(!1),[u,h]=_.useState(!1),[m,p]=_.useState(null),[b,g]=_.useState(null),[v,N]=_.useState(null),[V,E]=_.useState(null),[Y,O]=_.useState(null),[Z,q]=_.useState(null),[R,K]=_.useState(!1),[ne,z]=_.useState(!1),[k,S]=_.useState(!1),[ce,U]=_.useState(null),[C,j]=_.useState(!1),{activeAddress:w,isUnlocked:H,chainId:J}=Ji(),{user:y}=Er(),M=fy.CYCLES_LEDGER_CANISTER_ID||"um5iw-rqaaa-aaaaq-qaaba-cai",P=Vi(M),{useBalance:Q,useApprove:L}=P,se=Q(y!=null&&y.principal?{owner:y.principal,subaccount:[]}:void 0),F=L(),I=se.data,ee=se.isLoading;console.log("ðŸ”„ RemoteContractStep initialized with:",{selectedNFTs:e,targetChainId:t,remoteContractInfo:r,sourceCanisterId:s});const D="uzt4z-lp777-77774-qaabq-cai",re=Fa(D,ji),oe=Xd(D,ji),pe=_.useMemo(()=>({Ethereum:[BigInt(t)]}),[t]);console.log("ðŸ” Contract check state:",{isCheckingContract:u,existingContract:o,contractCheckComplete:l,unauthenticatedOrchActor:!!re,targetChainId:t,sourceCanisterId:s}),_.useEffect(()=>{const G=async()=>{if(!t||!s||!re||!a){c(null),d(!1);return}if(!u){h(!0),d(!1);try{console.log("ðŸ” Checking for existing ckNFT canister...",{sourceCanisterId:s,targetNetwork:pe,sourceContractPointer:a});const $=await re.get_ck_nft_canister([a]);if(console.log("ðŸ” ckNFT canister lookup result:",$),Array.isArray($)&&$[0]&&$[0][0]){const X=$[0][0];console.log("âœ… Found existing ckNFT canister:",X.toString()),console.log("ðŸ” Now checking for remote contract on target network...");const le=await re.get_remote([[X,pe]]);if(console.log("ðŸ” Remote contract lookup result:",le),le&&le[0]&&le[0][0]!=null){const be=le[0][0];console.log("âœ… Found existing remote contract:",be);const he=be.address&&be.address[0],Ee={address:he?be.address[0]:`ckNFT-${X.toString().slice(0,8)}...`,network:pe,name:`CK-${s.slice(0,5)}...`,symbol:"CKNFT",totalSupply:0,verified:!0,deploymentTx:he?be.address[0]:X.toString()};c(Ee),n(he?{address:be.address[0],network:pe,deployed:!0}:{network:pe,deployed:!1})}else console.log("ðŸ“‹ ckNFT canister exists but no remote contract found - will need to deploy remote contract"),c(null),n({network:pe,deployed:!1})}else console.log("ðŸ“‹ No existing ckNFT canister found - will need to deploy new bridge"),c(null),n({network:pe,deployed:!1})}catch($){console.error("âŒ Error checking for existing canister:",$),c(null),n({network:pe,deployed:!1})}finally{h(!1),d(!0)}}};!u&&!l&&(console.log("ðŸ”„ Checking for existing contract on target network:",pe),G())},[t,s,re,r,u,l,a]),_.useEffect(()=>{if(C||o)return;(async()=>{if(!(!re||!s||!t||u||!l||!a))try{console.log("ðŸ’° Estimating remote contract creation costs (one time only)...",{sourceCanisterId:s,targetChainId:t,sourceContractPointer:a}),j(!0);const $=await re.get_remote_cost(a,pe);p($),console.log("ðŸ’° Cycles needed for remote contract:",$.toString());const X=await re.get_icrc99_address(it.fromText(s),pe);X&&X[0]&&(E(X[0]),console.log("ðŸ’° Remote funding address:",X[0])),console.log("ðŸ’° Estimating gas using static calculation to avoid infinite loops...");const le=py.length/2,be=BigInt(Math.max(2e6,le*50)),he=50000000000n;N(be);const Ee=be*he*120n/100n;g(Ee),console.log("ðŸ’° Static gas estimation complete:",{estimatedGas:be.toString(),gasPrice:he.toString(),totalCost:Ee.toString()})}catch($){console.error("Error estimating remote contract costs:",$),j(!1)}})()},[re,s,t,o,u,l,a,C,pe]),_.useEffect(()=>{(async()=>{if(!(!V||Y!==null||!J||J.toString()!==t||!window.ethereum))try{console.log("ðŸ’° Checking funding balance for address:",V);const X=await new Nn(window.ethereum).getBalance(V);O(X),console.log("ðŸ’° Current funding balance:",vs(X),"ETH")}catch($){console.error("Error checking funding balance:",$)}})()},[V,J,t,Y]);const Ne=P.useAllowance(y!=null&&y.principal?{account:{owner:y.principal,subaccount:[]},spender:{owner:it.fromText(D),subaccount:[]}}:void 0),Te=async(G,$=10,X=5e3)=>{S(!0);let le=0;console.log("ðŸ” Starting to poll for new contract...",{txHash:G,maxAttempts:$,intervalMs:X});const be=setInterval(async()=>{le++,console.log(`ðŸ” Polling attempt ${le}/${$} for contract creation...`);try{if(J&&J.toString()===t&&window.ethereum)try{const Ee=await new Nn(window.ethereum).getTransactionReceipt(G);Ee?(console.log("âœ… Transaction mined on target network:",Ee),console.log("ðŸ“‹ Contract address from receipt:",Ee.contractAddress)):console.log("â³ Transaction not yet mined on target network")}catch(he){console.warn("Could not check transaction status on target network:",he)}if(re&&s&&t)try{const he={contract:s,network:pe},Ee=await re.get_ck_nft_canister([he]);if(Array.isArray(Ee)&&Ee[0]&&Ee[0][0]){const He=Ee[0][0];console.log("âœ… Found ckNFT canister:",He.toString());const ie=await re.get_remote([[He,pe]]);if(Array.isArray(ie)&&ie[0]&&ie[0][0]){const we=ie[0][0],Ce=we.address&&we.address.length>0?we.address[0]:null;if(Ce){console.log("ðŸŽ‰ Found newly deployed remote contract:",Ce);const ye={address:Ce,network:pe,name:`CK-${s.slice(0,5)}...`,symbol:"CKNFT",totalSupply:0,verified:!0,deploymentTx:G};c(ye),n({address:Ce,network:pe,deployed:!0}),clearInterval(be),S(!1),U(null);return}else console.log("â³ Remote contract found but address not yet available")}else console.log("â³ ckNFT canister exists but remote contract not yet deployed")}else console.log("â³ ckNFT canister not yet created")}catch(he){console.warn("Error checking for remote contract:",he)}le>=$&&(console.warn("âš ï¸ Max polling attempts reached, stopping poll"),clearInterval(be),S(!1),U(null))}catch(he){console.error("Error during contract polling:",he),le>=$&&(clearInterval(be),S(!1),U(null))}},X);return()=>{clearInterval(be),S(!1)}};_.useEffect(()=>{var G;((G=Ne.data)==null?void 0:G.allowance)!==void 0?(q(Ne.data.allowance),console.log("ðŸ’° Current cycles allowance:",Ne.data.allowance.toString())):(Ne.data===null||Ne.error)&&q(BigInt(0))},[Ne.data,Ne.error]),_.useEffect(()=>()=>{S(!1),U(null)},[]);const ae=async()=>{var G,$;if(!(y!=null&&y.principal)||!oe||!t||!s||!a){console.error("Missing required information for remote creation");return}try{K(!0),console.log("ðŸš€ Creating remote contract..."),console.log("ðŸ“‹ Using source contract pointer from ICRC-99 check:",a),console.log("ðŸ“‹ Target network for remote creation:",pe);let X={},le={},be=2000000n,he=1000n;if(J&&J.toString()===t&&window.ethereum)try{const ke=await new Nn(window.ethereum).getFeeData();X={maxFeePerGas:ke.maxFeePerGas||ke.gasPrice||50000000000n,l1DataFee:16n},le={gasPrice:ke.gasPrice||20000000000n};try{be=1800000n}catch(ze){console.warn("Could not estimate deployment gas, using default:",ze)}console.log("ï¿½ Enhanced gas data:",{maxFeePerGas:(G=X.maxFeePerGas)==null?void 0:G.toString(),gasPrice:($=le.gasPrice)==null?void 0:$.toString(),estimatedGas:be.toString(),estimatedSize:he.toString()})}catch(ye){console.warn("Could not get enhanced gas data, using fallback:",ye)}let Ee,He,ie;if(X.maxFeePerGas&&le.gasPrice){const ye=X.l1DataFee&&X.l1DataFee>0n?le.gasPrice*16n*(he+300n)/(be*120n/100n):0n;Ee=X.maxFeePerGas+2000000n+ye,He=be,ie=2000000n,console.log("âœ¨ Using enhanced gas calculation:",{baseMaxFeePerGas:X.maxFeePerGas.toString(),l1DataComponent:ye.toString(),finalFeePerGas:Ee.toString(),gasLimit:He.toString()})}else Ee=50000000000n,He=2000000n,ie=2000000000n,console.log("âš ï¸ Using fallback gas calculation");const we=await oe.create_remote(a,pe,Ee,He,ie,y!=null&&y.principal?[{owner:y.principal,subaccount:[]}]:[]);console.log("âœ… Remote contract creation initiated:",we);let Ce=null;typeof we=="object"&&we!==null?"Ok"in we&&typeof we.Ok=="string"?Ce=we.Ok:"transactionHash"in we?Ce=we.transactionHash:typeof we=="string"&&(Ce=we):typeof we=="string"&&(Ce=we),Ce?(console.log("ðŸ“‹ Got transaction hash:",Ce),U(Ce),Te(Ce),n({network:pe,deployed:!1})):(console.warn("âš ï¸ No transaction hash received from create_remote, result:",we),n({network:pe,deployed:!1}))}catch(X){console.error("âŒ Error creating remote contract:",X);const le=X instanceof Error?X.message:String(X);throw alert(`Failed to create remote contract: ${le}`),X}finally{K(!1)}},Ae=async()=>{if(!m||!D)throw new Error("Cannot approve cycles - missing requirements");try{z(!0),console.log("ðŸ’° Approving cycles for remote creation...",{amount:m.toString(),spender:D});const G=it.fromText(D),$=m*BigInt(110)/BigInt(100),X=BigInt(Date.now()*1e6)+BigInt(24*60*60*1e9),le=await F.mutateAsync({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:$,expected_allowance:[],expires_at:[X],spender:{owner:G,subaccount:[]}});return Ne.refetch(),console.log("âœ… Cycles approval successful"),le}catch(G){throw console.error("Error approving cycles:",G),G}finally{z(!1)}},Re=async()=>{if(!V||!b||!window.ethereum){console.error("Missing required information for funding");return}try{const G=new Nn(window.ethereum),$=await G.getSigner(),X=b*120n/100n;console.log("ðŸ’° Funding remote contract:",{to:V,value:vs(X)});const le=await $.sendTransaction({to:V,value:X});console.log("ðŸ’° Funding transaction sent:",le.hash);const be=await le.wait();console.log("ðŸ’° Funding transaction confirmed:",be);const he=await G.getBalance(V);O(he)}catch(G){console.error("Error funding remote contract:",G)}},de=t&&r&&l&&!u;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Remote Contract Configuration"}),i.jsx("p",{className:"text-gray-600",children:"Checking for existing contracts and configuring the target EVM deployment."})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Export Summary"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-600",children:"NFTs to Export:"}),i.jsxs("span",{className:"ml-2 font-medium text-blue-800",children:[e.length," NFT",e.length!==1?"s":""]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-600",children:"Source Canister:"}),i.jsx("span",{className:"ml-2 font-medium text-blue-800 font-mono text-xs",children:s})]})]}),e.length>0&&i.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.slice(0,3).map(G=>i.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-md",children:G.name||`Token ${G.tokenId}`},`${G.canisterId}-${G.tokenId}`)),e.length>3&&i.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-md",children:["+",e.length-3," more"]})]})]}),t&&i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Target Network"}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"text-2xl mr-3",children:"ðŸ”—"}),i.jsxs("div",{children:[i.jsxs("h5",{className:"font-medium text-gray-900",children:["Network: Chain ",t]}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Chain ID: ",t]})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Contract Status"}),u&&i.jsxs("div",{className:"flex items-center py-4",children:[i.jsx(St,{className:"w-5 h-5 text-blue-600 animate-spin mr-3"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Checking for existing contracts..."}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Searching for contracts linked to canister ",s]})]})]}),!u&&o&&i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx($r,{className:"w-5 h-5 text-green-600 mr-3 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h5",{className:"font-medium text-green-800 mb-1",children:"Existing Contract Found"}),i.jsx("p",{className:"text-sm text-green-700 mb-3",children:"A contract already exists for this canister on the target network. Your NFTs will be exported to this existing contract."}),i.jsx("div",{className:"bg-white border border-green-200 rounded-lg p-3",children:i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center mb-1",children:[i.jsx("h6",{className:"font-medium text-gray-900",children:o.name}),i.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["(",o.symbol,")"]}),o.verified&&i.jsx($r,{className:"w-4 h-4 text-green-500 ml-2"})]}),i.jsx("p",{className:"text-sm text-gray-600 font-mono mb-2",children:o.address}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[i.jsxs("span",{children:["Total Supply: ",o.totalSupply]}),i.jsxs("a",{href:"#",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 inline-flex items-center",children:["View on Explorer ",i.jsx(tu,{className:"w-3 h-3 ml-1"})]})]})]})})})]})]})}),!u&&!o&&l&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(m0,{className:"w-5 h-5 text-amber-600 mr-3 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h5",{className:"font-medium text-amber-800 mb-1",children:"New Contract Required"}),i.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"No existing contract found for this canister on the target network. A new ERC-721 contract will be deployed during the export process."}),i.jsx("div",{className:"bg-white border border-amber-200 rounded-lg p-3",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-amber-600",children:"Chain ID:"}),i.jsx("span",{className:"ml-2 font-medium text-amber-800",children:t})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-amber-600",children:"Standard:"}),i.jsx("span",{className:"ml-2 font-medium text-amber-800",children:"ERC-721"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-amber-600",children:"NFTs:"}),i.jsxs("span",{className:"ml-2 font-medium text-amber-800",children:[e.length," token",e.length!==1?"s":""]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-amber-600",children:"Gas Fee:"}),i.jsx("span",{className:"ml-2 font-medium text-amber-800",children:b?`~${vs(b)} ETH`:"~0.05 ETH"})]})]})})]})]})}),i.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("h5",{className:"font-medium text-blue-800 mb-3",children:"Remote Contract Creation Costs"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-blue-200 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-900",children:"Cycles Required"}),i.jsx("p",{className:"text-sm text-gray-600",children:"For orchestrator contract deployment"})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("span",{className:"font-medium text-blue-800",children:m?`${(Number(m)/1e12).toFixed(3)} T`:"Estimating..."}),i.jsx("p",{className:"text-xs text-gray-500",children:"cycles"})]})]}),i.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-blue-200 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-gray-900",children:"ETH Required"}),i.jsx("p",{className:"text-sm text-gray-600",children:"For EVM contract deployment gas"})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("span",{className:"font-medium text-blue-800",children:b?`${vs(b)} ETH`:"Estimating..."}),i.jsx("p",{className:"text-xs text-gray-500",children:v?`~${v.toString()} gas`:"~2M gas"})]})]}),V?i.jsxs("div",{className:"p-3 bg-white border border-blue-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium text-gray-900",children:"Funding Address"}),Y!==null&&i.jsxs("span",{className:`text-sm font-medium ${Y>=(b||0n)?"text-green-600":"text-red-600"}`,children:[vs(Y)," ETH"]})]}),i.jsx("p",{className:"text-xs text-gray-600 font-mono break-all",children:V}),Y!==null&&b&&Y<b&&i.jsxs("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Sr,{className:"w-4 h-4 text-red-500 mr-2"}),i.jsx("span",{className:"text-sm text-red-700 font-medium",children:"Insufficient ETH balance"})]}),i.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Need ",vs(b-Y)," more ETH"]})]}),Y!==null&&b&&Y>=b&&i.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx($r,{className:"w-4 h-4 text-green-500 mr-2"}),i.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Sufficient ETH balance"})]}),i.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Ready for contract deployment"})]})]}):i.jsxs("div",{className:"p-3 bg-white border border-blue-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium text-gray-900",children:"Funding Address"}),i.jsx("span",{className:"text-sm text-gray-500",children:"Loading..."})]}),i.jsx("p",{className:"text-xs text-gray-600",children:"Retrieving funding address..."})]}),V&&b&&w&&H&&Y!==null&&Y<b&&i.jsxs("button",{onClick:Re,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(ru,{className:"w-4 h-4 mr-2"}),"Fund Remote Contract"]})]})]})]})]}),l&&!o&&m&&i.jsxs("div",{className:"bg-muted/30 rounded-lg p-4",children:[i.jsx("h4",{className:"text-sm font-medium mb-3",children:"Cycles Approval"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-muted-foreground",children:"Required:"}),i.jsx("span",{className:"text-sm font-mono",children:lc(m)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-muted-foreground",children:"Approved:"}),i.jsx("span",{className:"text-sm font-mono",children:Z!==null?lc(Z):"..."})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-muted-foreground",children:"Your Balance:"}),i.jsx("span",{className:"text-sm font-mono",children:ee?"Loading...":I!==void 0?lc(I):"Unable to load"})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-muted-foreground",children:"Status:"}),i.jsx("span",{className:`text-sm font-medium ${Z!==null&&Z>=m?"text-green-500":"text-orange-500"}`,children:Z!==null?Z>=m?"Sufficient":"Insufficient":"Checking..."})]}),k?i.jsxs("div",{className:"w-full mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx(St,{className:"mr-2 h-4 w-4 animate-spin text-blue-600"}),i.jsx("span",{className:"text-sm text-blue-700 font-medium",children:"Waiting for contract deployment..."})]}),i.jsx("p",{className:"text-xs text-blue-600 text-center mt-1",children:"Checking target network for new contract"}),ce&&i.jsxs("p",{className:"text-xs text-blue-500 text-center mt-1 font-mono",children:["TX: ",ce.slice(0,10),"...",ce.slice(-8)]})]}):Z!==null&&Z>=m?i.jsx("button",{onClick:ae,disabled:R,className:"w-full mt-4 flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:R?i.jsxs(i.Fragment,{children:[i.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Remote Contract..."]}):"Create Remote Contract"}):i.jsx("button",{onClick:Ae,disabled:ne||!(y!=null&&y.principal),className:"w-full mt-4 flex items-center justify-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50",children:ne?i.jsxs(i.Fragment,{children:[i.jsx(St,{className:"mr-2 h-4 w-4 animate-spin"}),"Approving Cycles..."]}):"Approve Cycles"}),Z!==null&&Z<m&&i.jsxs("div",{className:"mt-4 p-3 bg-orange-500/10 border border-orange-500/20 rounded-lg",children:[i.jsxs("p",{className:"text-sm text-orange-600 mb-2",children:['Insufficient cycles approval. Click "Approve Cycles" above to approve'," ",my(m)," TCycles for the orchestrator canister."]}),!(y!=null&&y.principal)&&i.jsx("p",{className:"text-xs text-orange-500 mb-2",children:"ðŸ” Please connect your wallet to approve cycles."}),i.jsxs("div",{className:"text-xs text-orange-500",children:[i.jsx("p",{className:"mb-1",children:"ðŸ’¡ About cycles approval:"}),i.jsx("p",{children:"â€¢ Allows the orchestrator to spend cycles on your behalf"}),i.jsx("p",{children:"â€¢ Only the approved amount can be spent"}),i.jsx("p",{children:"â€¢ Required for remote contract deployment"})]})]}),Z!==null&&Z>=m&&i.jsxs("div",{className:"mt-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx($r,{className:"w-4 h-4 text-green-500 mr-2"}),i.jsx("span",{className:"text-sm text-green-600 font-medium",children:"Cycles approved successfully!"})]}),i.jsx("p",{className:"text-xs text-green-500 mt-1",children:"Ready to create the remote contract."})]})]})]}),de&&i.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx($r,{className:"w-5 h-5 text-green-600 mr-2"}),i.jsx("span",{className:"font-medium text-green-800",children:"Configuration Complete"})]}),i.jsxs("div",{className:"mt-2 text-sm text-green-700",children:[i.jsxs("p",{children:["âœ“ Target ChainId: ",t]}),i.jsxs("p",{children:["âœ“ Contract: ",o?"Use existing contract":"Deploy new contract"]}),i.jsx("p",{children:"âœ“ Ready to calculate export costs"})]})]})]})}var xy={};function by({selectedNFTs:e,targetNetwork:t,remoteContractInfo:r,sourceContractPointer:n,onCostsCalculated:s}){const[a,o]=_.useState(!1),[c,l]=_.useState(null),[d,u]=_.useState(null),[h,m]=_.useState(null),[p,b]=_.useState(!1),[g,v]=_.useState(!1),[N,V]=_.useState(null),[E,Y]=_.useState(null),[O,Z]=_.useState(null),[q,R]=_.useState(null),[K,ne]=_.useState(null),z=Hi("uzt4z-lp777-77774-qaabq-cai"),{user:k}=Er(),S=xy.CYCLES_LEDGER_CANISTER_ID||"um5iw-rqaaa-aaaaq-qaaba-cai",ce=Vi(S),U=k!=null&&k.principal?{owner:typeof k.principal=="string"?it.fromText(k.principal):k.principal,subaccount:[]}:void 0,C=ce.useBalance(U),j=el(d==null?void 0:d.total);_.useEffect(()=>{C.data!==void 0&&V(C.data)},[C.data]),_.useEffect(()=>{var M,P,Q,L;if(console.log("ðŸ” useEffect [allowanceQuery.data, costBreakdown?.total] triggered:",{hasAllowanceData:!!j.data,allowanceDataRef:j.data,allowanceAmount:(P=(M=j.data)==null?void 0:M.allowance)==null?void 0:P.toString(),isExpired:(Q=j.data)==null?void 0:Q.isExpired,costBreakdownTotal:(L=d==null?void 0:d.total)==null?void 0:L.toString(),allowanceQueryDataKeys:j.data?Object.keys(j.data):"no data"}),j.data&&(d!=null&&d.total)){const se={amount:j.data.allowance,isExpired:j.data.isExpired,isSufficient:j.data.allowance>=d.total};console.log("ðŸ” Setting new allowance status:",se),ne(se);const F=j.data.allowance>=d.total&&!j.data.isExpired;console.log("ðŸ” Setting payment approved:",F),b(F)}},[j.data,d==null?void 0:d.total]);const w=_.useMemo(()=>{if(!t||!("Ethereum"in t))return"Unknown";const M=Number(t.Ethereum[0]);return{1:"Ethereum",137:"Polygon",56:"BNB Smart Chain",42161:"Arbitrum",10:"Optimism",8453:"Base"}[M]||`Chain ${M}`},[t]),H=_.useMemo(()=>r!=null&&r.address?{network:t,contract:r.address}:null,[r,t]);_.useEffect(()=>{(async()=>{var P;if(!e.length||!t||!r||!n){u(null),s(0n);return}o(!0),l(null);try{console.log("ðŸ” Calculating export costs for:",{nftCount:e.length,network:w,remoteContract:r,sourceContract:n,hasSourceContractPointer:!!n,sourceContractAddress:n==null?void 0:n.contract});let Q,L=0n;if(!r.deployed&&H){console.log("ðŸ“Š Getting remote contract deployment cost...");try{const re=await z.getRemoteCost.mutateAsync({pointer:n,network:t});Q=BigInt(re),console.log("ðŸ’° Remote contract deployment cost:",Q.toString())}catch(re){console.error("Failed to get deployment cost:",re),Q=5000000000n}}try{console.log("ðŸ“Š Getting real cast costs from ckNFT canisters...");const oe=(await z.getCkNFTCanister.mutateAsync([n]))[0];if(oe&&(r!=null&&r.address)){console.log(`ðŸ” Using ckNFT canister ${oe.toString()} for cast cost calculations`);for(const pe of e)try{const Ne=await z.getCastCost.mutateAsync({ckNFTCanisterId:oe,contract:r.address,network:t,tokenId:BigInt(pe.tokenId)});L+=Ne,console.log(`ðŸ’° Real cast cost for NFT ${pe.tokenId}: ${Ne.toString()}`)}catch(Ne){console.error(`Error getting cast cost for NFT ${pe.tokenId}:`,Ne),L+=1000000000n}console.log("ðŸ’° Total real cast operations cost:",L.toString())}else console.warn("No ckNFT canister found for source contract, using fallback estimation"),L=BigInt(e.length)*1000000000n}catch(re){console.error("Failed to get real cast costs, using estimation:",re);const oe=1000000000n,Ne=BigInt(Math.floor(({Ethereum:50,Polygon:1,"BNB Smart Chain":5,Arbitrum:.5,Optimism:.5,Base:.5}[w]||10)*100));L=BigInt(e.length)*oe*Ne/100n}let se=0n,F="0.000",I=null;try{console.log("ðŸ” Getting ckNFT canister for funding address...",{sourceContract:n.contract,sourceContractNetwork:n.network,targetNetwork:t,mutations:!!z,userAuthenticated:!!(k!=null&&k.principal)});const oe=(await z.getCkNFTCanister.mutateAsync([n]))[0];oe?(console.log("âœ… Found ckNFT canister for funding address:",oe.toString()),I=await z.getICRC99Address.mutateAsync({canister:oe,network:t}),I?(R(I),console.log("ðŸ’° Got funding address from ckNFT canister:",I)):(console.warn("ðŸ’° No funding address returned from ckNFT canister"),R(null))):(console.warn("âš ï¸ No ckNFT canister found for source contract, cannot get funding address"),R(null))}catch(re){console.error("âŒ Failed to get funding address from orchestrator:",re),console.error("ðŸ’° Error details:",{message:re instanceof Error?re.message:String(re),sourceContractPointer:n,targetNetwork:t,userAuthenticated:!!(k!=null&&k.principal),mutationsAvailable:!!(z!=null&&z.getICRC99Address)}),R(null)}try{if(("Ethereum"in t?Number(t.Ethereum[0]):null)&&window.ethereum){const oe=new(await jt(async()=>{const{ethers:$}=await import("./index-D16to4BB.js");return{ethers:$}},__vite__mapDeps([3,1,2,4,0]))).ethers.BrowserProvider(window.ethereum),pe=await oe.getFeeData(),Ne=await jt(()=>import("./ICRC99NFT-BEaR-XE0.js"),[]),Te=Ne.abi,ae=Ne.bytecode;let Ae=0n;if(r!=null&&r.deployed&&r.address&&I){console.log("ðŸ’° Estimating gas for mint_icrc99 calls to existing contract:",r.address);try{for(let $=0;$<e.length;$++){const X=e[$],le=JSON.stringify({name:X.name||`NFT ${X.tokenId}`,description:X.description||"Bridged NFT from Internet Computer",image:X.image||"",tokenId:X.tokenId}),{ethers:be}=await jt(async()=>{const{ethers:He}=await import("./index-D16to4BB.js");return{ethers:He}},__vite__mapDeps([3,1,2,4,0])),he=be.getAddress("0x742d35Cc6635C0532925a3b8D11e432f1b7C4b7b"),Ee=await oe.estimateGas({to:r.address,data:new be.Interface(Te).encodeFunctionData("mint_icrc99",[BigInt(X.tokenId),he,le]),from:I});Ae+=Ee,console.log(`ðŸ’° Estimated gas for NFT ${X.tokenId}: ${Ee.toString()}`)}console.log(`ðŸ’° Total estimated gas for ${e.length} mint operations: ${Ae.toString()}`)}catch($){console.warn("Failed to estimate mint gas, using fallback:",$),Ae=BigInt(e.length)*150000n}}else if(r!=null&&r.deployed)console.warn("ðŸ’° No funding address available, using conservative gas estimates"),Ae=BigInt(e.length)*150000n;else{console.log("ðŸ’° Estimating gas for contract deployment + mints");try{const $=ae+"0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000054d794e465400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000054d794e4654000000000000000000000000000000000000000000000000000000",X=await oe.estimateGas({data:$,from:I||"0x742d35Cc6635C0532925a3b8D11e432f1b7C4b7b"});console.log("ðŸ’° Estimated deployment gas:",X.toString());let le=0n;try{const be=JSON.stringify({name:"Sample NFT",description:"Sample bridged NFT",image:"",tokenId:1}),he=await oe.estimateGas({data:ae+new(await jt(async()=>{const{ethers:Ee}=await import("./index-D16to4BB.js");return{ethers:Ee}},__vite__mapDeps([3,1,2,4,0]))).ethers.Interface(Te).encodeFunctionData("mint_icrc99",[1n,"0x742d35Cc6635C0532925a3b8D11e432f1b7C4b7b",be]).slice(2),from:I||"0x742d35Cc6635C0532925a3b8D11e432f1b7C4b7b"});le=BigInt(e.length)*he,console.log("ðŸ’° Estimated mint gas per NFT:",he.toString())}catch(be){console.warn("Failed to estimate individual mint gas:",be),le=BigInt(e.length)*120000n}Ae=X+le,console.log("ðŸ’° Total gas (deployment + mints):",Ae.toString())}catch($){console.warn("Failed to estimate deployment gas, using fallback:",$),Ae=1500000n+BigInt(e.length)*120000n}}const Re=pe.gasPrice||pe.maxFeePerGas||20000000000n,de=Ae*Re,G=await jt(()=>import("./index-D16to4BB.js"),__vite__mapDeps([3,1,2,4,0]));if(F=G.ethers.formatEther(de),Z(F),se=0n,console.log("ðŸ’° Real EVM gas cost calculation:",{gasPrice:Re.toString(),totalGasUnits:Ae.toString(),totalGasCostWei:de.toString(),evmGasFeesETH:F,fundingAddress:I,contractDeployed:r==null?void 0:r.deployed,nftCount:e.length}),I)try{const $=await oe.getBalance(I),X=G.ethers.formatEther($);Y(X),console.log("ðŸ’° ETH balance check for funding address:",{address:I,balanceETH:X,requiredETH:F,hasSufficientBalance:parseFloat(X)>parseFloat(F)})}catch($){console.warn("Could not check funding address balance:",$),Y(null)}}else throw new Error("No MetaMask or chain ID available")}catch(re){console.warn("Failed to get real gas costs, using estimates:",re),console.warn("ðŸ’° Error details:",{message:re instanceof Error?re.message:String(re),sourceContractPointer:n,targetNetwork:t}),se=0n,F="~0.050"}const ee=(Q||0n)+L+se,D={remoteContractDeployment:Q,castOperations:L,evmGasFees:se,evmGasFeesETH:F,total:ee};console.log("ðŸ’° Final cost breakdown:",{remoteContractDeployment:(P=D.remoteContractDeployment)==null?void 0:P.toString(),castOperations:D.castOperations.toString(),evmGasFees:D.evmGasFees.toString(),total:D.total.toString()}),u(D),s(ee)}catch(Q){console.error("Error calculating export costs:",Q),l(Q instanceof Error?Q.message:"Failed to calculate export costs"),u(null),s(0n)}finally{o(!1)}})()},[e,t,r,n,w,H]),_.useEffect(()=>{(async()=>{if(!(!t||h))try{console.log("â›½ Fetching real gas price data for network:",w);const P="Ethereum"in t?Number(t.Ethereum[0]):null;if(!P){console.warn("Unable to determine chain ID for gas price fetching");return}if(window.ethereum)try{const se=new(await jt(async()=>{const{ethers:I}=await import("./index-D16to4BB.js");return{ethers:I}},__vite__mapDeps([3,1,2,4,0]))).ethers.BrowserProvider(window.ethereum),F=await se.getNetwork();if(Number(F.chainId)===P){const I=await se.getFeeData(),ee=I.gasPrice||I.maxFeePerGas||20000000000n,D=Number(ee)/1e9,re=D*21e-6*2e3;m({network:w,gasPrice:`${D.toFixed(1)} gwei`,usdPrice:`$${re.toFixed(2)}`,estimatedConfirmationTime:P===1?"2-5 minutes":"1-3 minutes"}),console.log("â›½ Real gas price fetched:",{gasPrice:`${D.toFixed(1)} gwei`,chainId:P,network:w});return}}catch(se){console.warn("Could not fetch gas price from MetaMask:",se)}const L={1:{gwei:30,usd:15,confirmTime:"2-5 minutes"},137:{gwei:35,usd:.01,confirmTime:"1-3 minutes"},56:{gwei:5,usd:.05,confirmTime:"1-3 minutes"},42161:{gwei:.1,usd:.5,confirmTime:"1-2 minutes"},10:{gwei:.1,usd:.5,confirmTime:"1-2 minutes"},8453:{gwei:.1,usd:.5,confirmTime:"1-2 minutes"}}[P]||{gwei:20,usd:5,confirmTime:"2-5 minutes"};m({network:w,gasPrice:`${L.gwei} gwei`,usdPrice:`$${L.usd.toFixed(2)}`,estimatedConfirmationTime:L.confirmTime}),console.log("â›½ Using fallback gas price estimates for chain",P)}catch(P){console.error("Error fetching gas price info:",P),m({network:w,gasPrice:"Unknown",usdPrice:"Unknown",estimatedConfirmationTime:"2-5 minutes"})}})()},[t,w,h]);const J=M=>{const Q=BigInt(1e12),L=M/Q,F=(M%Q).toString().padStart(12,"0").slice(0,3);return`${L.toLocaleString()}.${F} TC`},y=async()=>{if(!(!d||!(k!=null&&k.principal))){v(!0),o(!0),l(null);try{if(console.log("ðŸ”„ Approving cycles payment for export...",{totalCost:d.total.toString(),userBalance:(N==null?void 0:N.toString())||"unknown",orchestratorCanister:"uzt4z-lp777-77774-qaabq-cai"}),N!==null&&N<d.total)throw new Error(`Insufficient cycles balance. You have ${J(N)} but need ${J(d.total)}. Please deposit more cycles to your account.`);const M=d.total*BigInt(110)/BigInt(100),P=BigInt(24*60*60*1e9),Q=BigInt(Date.now()*1e6)+P;console.log("ðŸ“ Submitting cycles approval...",{approvalAmount:M.toString(),originalAmount:d.total.toString(),expiryTime:Q.toString()}),await z.cyclesApprove.mutateAsync({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:M,expected_allowance:[],expires_at:[Q],spender:{owner:it.fromText("uzt4z-lp777-77774-qaabq-cai"),subaccount:[]}}),console.log("âœ… Cycles approval successful!"),await j.refetch(),await C.refetch(),b(!0)}catch(M){console.error("âŒ Error approving cycles payment:",M),l(M instanceof Error?M.message:"Failed to approve cycles payment"),b(!1)}finally{v(!1),o(!1)}}};return a&&!d?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(St,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Calculating Export Costs"}),i.jsxs("p",{className:"text-gray-600",children:["Estimating cycles needed for ",e.length," NFT",e.length!==1?"s":"",r!=null&&r.deployed?"":" and contract deployment","..."]})]}):c?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Sr,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Calculating Costs"}),i.jsx("p",{className:"text-gray-600 mb-4",children:c}),i.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Retry"})]}):d?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Export Costs"}),i.jsxs("p",{className:"text-gray-600",children:["Review the costs for exporting your ",e.length," NFT",e.length!==1?"s":""," to ",w,"."]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-3",children:"Export Summary"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-600",children:"NFTs:"}),i.jsxs("span",{className:"ml-2 font-medium text-blue-800",children:[e.length," token",e.length!==1?"s":""]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-600",children:"Target Network:"}),i.jsx("span",{className:"ml-2 font-medium text-blue-800",children:w})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-600",children:"Contract:"}),i.jsx("span",{className:"ml-2 font-medium text-blue-800",children:r!=null&&r.deployed?"Existing":"New Deployment"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-blue-600",children:"Operation:"}),i.jsx("span",{className:"ml-2 font-medium text-blue-800",children:"Cast to EVM"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Cost Breakdown"}),i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg divide-y divide-gray-200",children:[i.jsxs("div",{className:"p-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(A0,{className:"w-5 h-5 text-blue-600 mr-3"}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-gray-900",children:"Cast Operations"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Bridge ",e.length," NFT",e.length!==1?"s":""," to ",w]})]})]}),i.jsx("span",{className:"font-medium text-gray-900",children:J(d.castOperations)})]}),d.remoteContractDeployment&&i.jsxs("div",{className:"p-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(l0,{className:"w-5 h-5 text-green-600 mr-3"}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-gray-900",children:"Contract Deployment"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Deploy new ERC-721 contract on ",w]})]})]}),i.jsx("span",{className:"font-medium text-gray-900",children:J(d.remoteContractDeployment)})]}),i.jsxs("div",{className:"p-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Lf,{className:"w-5 h-5 text-orange-600 mr-3"}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-gray-900",children:"EVM Gas Fees"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Estimated gas costs on ",w]}),E&&O&&i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Balance: ",parseFloat(E).toFixed(4)," ETH",q&&i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",q.slice(0,6),"...",q.slice(-4),")"]}),parseFloat(E)<parseFloat(O)&&i.jsx("span",{className:"text-red-600 ml-1",children:"âš ï¸ Insufficient"})]})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("span",{className:"font-medium text-gray-900",children:[d.evmGasFeesETH," ETH"]}),h&&i.jsxs("p",{className:"text-xs text-gray-500",children:["~",h.gasPrice]})]})]})]})]}),h&&i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Current Gas Prices"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-yellow-600",children:"Network:"}),i.jsx("span",{className:"ml-2 font-medium text-yellow-800",children:h.network})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-yellow-600",children:"Gas Price:"}),i.jsx("span",{className:"ml-2 font-medium text-yellow-800",children:h.gasPrice})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-yellow-600",children:"USD Est.:"}),i.jsx("span",{className:"ml-2 font-medium text-yellow-800",children:h.usdPrice})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-yellow-600",children:"Confirmation:"}),i.jsx("span",{className:"ml-2 font-medium text-yellow-800",children:h.estimatedConfirmationTime})]})]})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-3",children:"ETH Funding Address"}),i.jsx("div",{className:"bg-white border border-blue-200 rounded-lg p-3",children:q?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium text-gray-900",children:"Address Balance"}),E!==null?i.jsxs("span",{className:`text-sm font-medium ${O&&parseFloat(E)>=parseFloat(O)?"text-green-600":"text-red-600"}`,children:[parseFloat(E).toFixed(6)," ETH"]}):i.jsx("span",{className:"text-sm text-gray-500",children:"Loading..."})]}),i.jsx("p",{className:"text-xs text-gray-600 font-mono break-all mb-2",children:q}),E!==null&&O&&i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[i.jsx("span",{children:"Required for gas:"}),i.jsxs("span",{children:[parseFloat(O).toFixed(6)," ETH"]})]}),parseFloat(E)<parseFloat(O)?i.jsxs("div",{className:"p-2 bg-red-50 border border-red-200 rounded",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Sr,{className:"w-4 h-4 text-red-500 mr-2"}),i.jsx("span",{className:"text-sm text-red-700 font-medium",children:"Insufficient ETH balance"})]}),i.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Need ",(parseFloat(O)-parseFloat(E)).toFixed(6)," more ETH"]})]}):i.jsxs("div",{className:"p-2 bg-green-50 border border-green-200 rounded",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx($r,{className:"w-4 h-4 text-green-500 mr-2"}),i.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Sufficient ETH balance"})]}),i.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Ready for gas fee payment"})]})]}),E===null&&i.jsx("div",{className:"mt-2 p-2 bg-gray-50 border border-gray-200 rounded",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx(St,{className:"w-4 h-4 text-gray-500 animate-spin mr-2"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Checking balance..."})]})})]}):q?i.jsxs("div",{className:"flex items-center justify-center py-4",children:[i.jsx(St,{className:"w-4 h-4 text-gray-500 animate-spin mr-2"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Retrieving funding address from ckNFT canister..."})]}):i.jsxs("div",{className:"py-4 text-center",children:[i.jsxs("div",{className:"flex items-center justify-center mb-2",children:[i.jsx(Sr,{className:"w-5 h-5 text-yellow-500 mr-2"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"No ICRC-99 Funding Address Available"})]}),i.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"No ckNFT canister found for this source contract"}),i.jsx("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded",children:i.jsx("p",{className:"text-xs text-yellow-700",children:"ðŸ’¡ This may be a new contract that hasn't been registered yet"})})]})}),i.jsxs("div",{className:"mt-3 text-xs text-blue-600",children:[i.jsx("p",{className:"mb-1",children:"ðŸ’¡ About the funding address:"}),q?i.jsxs(i.Fragment,{children:[i.jsx("p",{children:"â€¢ This address pays for EVM gas fees during the export"}),i.jsx("p",{children:"â€¢ Managed by the ckNFT canister on Internet Computer"}),i.jsx("p",{children:"â€¢ Balance is checked automatically before export"}),i.jsx("p",{className:"mt-1 text-green-600",children:"âœ“ Address retrieved successfully"})]}):i.jsxs(i.Fragment,{children:[i.jsx("p",{children:"â€¢ ckNFT canisters manage funding addresses for gas payments"}),i.jsx("p",{children:"â€¢ Each supported contract has a corresponding ckNFT canister"}),i.jsx("p",{children:"â€¢ Contact support if your contract should be supported"})]})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Payment Approval"}),i.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(ru,{className:"w-5 h-5 text-gray-600 mr-2"}),i.jsx("h5",{className:"font-medium text-gray-900",children:"Your Cycles Balance"})]}),C.isLoading?i.jsx(St,{className:"w-4 h-4 animate-spin text-gray-500"}):i.jsx("span",{className:_e("font-medium",N!==null&&d&&N>=d.total?"text-green-600":"text-red-600"),children:N!==null?J(N):"Unknown"})]}),N!==null&&d&&i.jsxs("div",{className:"text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center mb-1",children:[i.jsx("span",{className:"text-gray-600",children:"Required:"}),i.jsx("span",{className:"text-gray-900",children:J(d.total)})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-gray-600",children:"Remaining after export:"}),i.jsx("span",{className:_e("font-medium",N>=d.total?"text-green-600":"text-red-600"),children:N>=d.total?J(N-d.total):"Insufficient Balance"})]})]}),N!==null&&d&&N<d.total&&i.jsx("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded-md",children:i.jsxs("p",{className:"text-sm text-red-700",children:["âš ï¸ Insufficient cycles balance. Please deposit ",J(d.total-N)," more."]})})]}),K&&i.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(eu,{className:"w-5 h-5 text-blue-600 mr-2"}),i.jsx("h5",{className:"font-medium text-blue-900",children:"Current Allowance"})]}),i.jsx("span",{className:_e("font-medium",K.isSufficient&&!K.isExpired?"text-green-600":"text-orange-600"),children:J(K.amount)})]}),i.jsxs("div",{className:"text-sm space-y-1",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-blue-600",children:"Status:"}),i.jsx("span",{className:_e("font-medium",K.isSufficient&&!K.isExpired?"text-green-600":"text-orange-600"),children:K.isExpired?"Expired":K.isSufficient?"Sufficient":"Insufficient"})]}),K.isExpired&&i.jsx("p",{className:"text-orange-700 text-xs",children:"Your previous allowance has expired. A new approval is required."}),!K.isSufficient&&!K.isExpired&&i.jsx("p",{className:"text-orange-700 text-xs",children:"Your current allowance is insufficient for this export operation."})]})]}),p?i.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx($r,{className:"w-5 h-5 text-green-600 mr-2"}),i.jsx("span",{className:"font-medium text-green-800",children:"Payment Approved"})]}),i.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Cycles approved for export operation. You can now proceed with the export."}),i.jsxs("div",{className:"mt-2 text-xs text-green-600",children:["Approved: ",K?J(K.amount):"Unknown amount"]})]}):i.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-gray-900",children:"Approve Cycles Payment"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Authorize the orchestrator to use ",d?J(d.total):"..."," for this export"]})]}),i.jsx("button",{onClick:y,disabled:g||C.isLoading||!d||N!==null&&N<d.total,className:_e("px-6 py-2 rounded-md font-medium transition-colors",g||C.isLoading||!d||N!==null&&N<d.total?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"),children:g?i.jsxs("div",{className:"flex items-center",children:[i.jsx(St,{className:"w-4 h-4 animate-spin mr-2"}),"Approving..."]}):C.isLoading?i.jsxs("div",{className:"flex items-center",children:[i.jsx(St,{className:"w-4 h-4 animate-spin mr-2"}),"Checking Balance..."]}):"Approve Payment"})]}),i.jsxs("div",{className:"text-sm text-gray-600",children:[i.jsx("p",{className:"mb-1",children:"This will:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[i.jsx("li",{children:"Approve the cycles ledger transfer"}),i.jsx("li",{children:"Allow the orchestrator to process your export"}),i.jsxs("li",{children:["Enable automatic gas fee payment on ",w]}),i.jsx("li",{children:"Include 10% buffer for gas price fluctuations"})]})]})]})]}),p&&i.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx($r,{className:"w-5 h-5 text-blue-600 mr-2"}),i.jsx("span",{className:"font-medium text-blue-800",children:"Ready to Export"})]}),i.jsx("p",{className:"text-sm text-blue-700 mt-1",children:'All requirements met. Click "Start Export" to begin the bridging process.'}),i.jsxs("div",{className:"mt-2 text-xs text-blue-600 space-y-1",children:[i.jsxs("div",{children:["âœ“ Cycles balance: ",N?J(N):"Verified"]}),i.jsxs("div",{children:["âœ“ Payment approved: ",K?J(K.amount):"Confirmed"]}),i.jsxs("div",{children:["âœ“ Target network: ",w]}),i.jsxs("div",{children:["âœ“ NFTs selected: ",e.length]})]})]}),E&&O&&parseFloat(E)<parseFloat(O)&&i.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Sr,{className:"w-5 h-5 text-red-600 mr-2"}),i.jsx("span",{className:"font-medium text-red-800",children:"Insufficient ETH for Gas Fees"})]}),i.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["The funding address needs ",parseFloat(O).toFixed(4)," ETH for gas fees but only has ",parseFloat(E).toFixed(4)," ETH.",q&&i.jsxs(i.Fragment,{children:[i.jsx("br",{}),i.jsxs("span",{className:"text-xs text-red-600",children:["Address: ",q]})]}),i.jsx("br",{}),"Please add ",(parseFloat(O)-parseFloat(E)).toFixed(4)," ETH to the funding address."]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:()=>window.open(`https://faucet.quicknode.com/${w.toLowerCase()}`,"_blank"),className:"px-4 py-2 text-sm font-medium text-red-700 bg-red-100 rounded-md hover:bg-red-200 transition-colors",children:"Get Test ETH"})})]}),N!==null&&d&&N<d.total&&i.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx(Sr,{className:"w-5 h-5 text-red-600 mr-2"}),i.jsx("span",{className:"font-medium text-red-800",children:"Insufficient Cycles Balance"})]}),i.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["You need ",J(d.total-N)," more to complete this export."]}),i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:()=>window.open("https://nns.ic0.app/wallet/","_blank"),className:"px-4 py-2 text-sm font-medium text-red-700 bg-red-100 rounded-md hover:bg-red-200 transition-colors",children:"Get More Cycles"})})]})]}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Sr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Unable to Calculate Costs"}),i.jsx("p",{className:"text-gray-600",children:"Please check your export configuration and try again."})]})}function Yd({sourceCanisterId:e,supportedNetworks:t=["ethereum","polygon","hardhat","hardhat-2"],onComplete:r,onCancel:n,className:s,modal:a=!1,initialStep:o,mockSelectedICNFTs:c,mockWalletConnected:l,mockExportCosts:d,mockExportResult:u}){var Re,de;const h={ethereum:1,polygon:137,bsc:56,hardhat:31337,"hardhat-2":1338,arbitrum:42161,optimism:10,base:8453},m=Object.fromEntries(Object.entries(h).map(([G,$])=>[$,G])),[p,b]=_.useState(o||"select-ic-nft"),[g,v]=_.useState(c||[]),[N,V]=_.useState(null),[E,Y]=_.useState(null),[O,Z]=_.useState(d?BigInt(d):null),[q,R]=_.useState(e||null),[K,ne]=_.useState(null);_.useEffect(()=>{console.log("ðŸ’° Export costs updated:",{exportCosts:(O==null?void 0:O.toString())||"null",currentStep:p,canGoNextResult:p==="costs"?O!==null:"not costs step"})},[O,p]);const[z,k]=_.useState(u||null),[S,ce]=_.useState(null),{activeAddress:U,isUnlocked:C,connectWallet:j,switchChain:w,chainId:H}=Ji(),{user:J}=Er(),y=cy(q);_.useEffect(()=>{console.log("ðŸ” EVMExportWizard ICRC-99 support state:",{activeCanisterId:q,icrc99Support:y,sourceCanisterId:e})},[q,y,e]),_.useEffect(()=>{if(!q||y.isLoading){ne(null);return}y.isSupported&&y.nativeChain?(console.log("âœ… ICRC-99 supported, using native chain info as source pointer:",y.nativeChain),ne(y.nativeChain)):(console.log("ðŸ”„ ICRC-99 not supported, using IC network fallback for canister:",q),ne({network:{IC:[]},contract:q}))},[q,y.isLoading,y.isSupported,y.nativeChain]);const M=Hi("uzt4z-lp777-77774-qaabq-cai"),P=l!==void 0?l:C,Q=l?"0x742d35Cc6635C0532925a3b8D11e432f1b7C4b7b":U,L=_.useCallback(G=>{const X=iu(G,[{id:"create-remote-contract",title:"Deploy Remote Contract",description:"Creating or verifying EVM contract for receiving NFTs",estimatedDuration:180,retryable:!0,stage:"contract"},{id:"fund-gas-account",title:"Fund Gas Account",description:"Sending ETH to bridge funding address for gas fees",estimatedDuration:90,retryable:!0,stage:"preparation"},{id:"approve-cycles-cast",title:"Approve Cycles",description:"Approving cycles for cast operations",estimatedDuration:30,retryable:!0,stage:"preparation"},{id:"cast-nfts",title:"Cast NFTs",description:"Exporting ckNFTs to EVM blockchain",estimatedDuration:120,retryable:!0,stage:"execution"},{id:"wait-evm-confirmation",title:"Wait for Confirmation",description:"Monitoring cast operations for completion",estimatedDuration:300,retryable:!1,stage:"execution"}]);return ce(X),X},[]),se=_.useCallback((G,$,X,le)=>{if(!S)return;const be=au(S,G,{status:$,...X&&{error:X},...le&&{txHash:le}});ce(be)},[S]),F=_.useCallback(G=>{if(!S)return;const $=ou(S,G);ce($)},[S]);_.useEffect(()=>{L("ic-to-evm")},[L]);const I=[{id:"select-ic-nft",title:"Select IC NFTs",description:"Choose ckNFTs to export back to EVM"},{id:"connect",title:"Connect Wallet",description:"Connect your EVM wallet for receiving NFTs"},{id:"remote-contract",title:"Remote Contract",description:"Deploy or use existing EVM contract"},{id:"costs",title:"Export Costs",description:"Review and approve cycles for export operation"},{id:"export",title:"Export Progress",description:"Monitor the export process"},{id:"complete",title:"Complete",description:"Export summary"}],ee=I.findIndex(G=>G.id===p),D=_.useCallback(()=>{const G=(()=>{switch(p){case"select-ic-nft":return g.length>0;case"connect":return C&&U;case"remote-contract":return E!==null;case"costs":return O!==null;case"export":return(z==null?void 0:z.success)===!0;default:return!1}})();return console.log("ðŸ” canGoNext check:",{currentStep:p,result:G,selectedICNFTs:g.length,isUnlocked:C,activeAddress:!!U,remoteContractInfo:!!E,exportCosts:(O==null?void 0:O.toString())||"null",exportResultSuccess:z==null?void 0:z.success}),G},[p,g,C,U,E,O,z]),re=_.useMemo(()=>!!(S!=null&&S.steps&&S.steps.some($=>$.status==="failed")||z&&!z.success),[S,z]),oe=ee>0&&(p!=="export"&&p!=="complete"||re),pe=_.useCallback(()=>{if(!D())return;const G=ee+1;G<I.length&&b(I[G].id)},[ee,D,I]),Ne=_.useCallback(()=>{if(!oe)return;const G=ee-1;G>=0&&b(I[G].id)},[ee,oe,I]),Te=_.useCallback(async()=>{var G;if(console.log("ðŸŽ¯ handleStartExport called with:",{selectedICNFTs:g.length,activeAddress:U,userPrincipal:J==null?void 0:J.principal,remoteContractInfo:E,targetNetwork:N}),!g.length||!U||!(J!=null&&J.principal)||!E||!N||!K){console.warn("âŒ Missing required data for export:",{selectedICNFTs:g.length,activeAddress:!!U,userPrincipal:!!(J!=null&&J.principal),remoteContractInfo:!!E,targetNetwork:!!N,sourceContractPointer:!!K});return}b("export"),L("ic-to-evm");try{if(console.log(`ðŸš€ Starting real ICRC-99 export process for ${g.length} ckNFT(s) to EVM`),console.log("âœ… EVM wallet already connected:",U),se("create-remote-contract","loading"),!E.deployed&&E.address){console.log("ðŸ“¦ Deploying remote contract to EVM...",E.deployed,E.address),se("create-remote-contract","loading","Deploying remote contract to EVM...");try{if(!K)throw new Error("Source contract pointer not available. Please ensure NFTs are selected.");console.log("ðŸ“ Using sourceContractPointer for createRemoteContract (original native network from ICRC-99 or IC fallback):",K),console.log("ðŸ“ Using target network for createRemoteContract:",N);const he=BigInt(5e10),Ee=BigInt(2e6),He=BigInt(2e9),ie=await M.createRemoteContract.mutateAsync({pointer:K,network:N,gasPrice:he,gasLimit:Ee,maxPriorityFeePerGas:He});console.log("âœ… Remote contract deployment initiated:",ie),Y(we=>we?{...we,deployed:!0}:null)}catch(he){console.error("âŒ Remote contract deployment failed:",he),se("create-remote-contract","failed",he instanceof Error?he.message:"Remote contract deployment failed");return}}se("create-remote-contract","completed"),se("cast-nfts","loading");const $=[],X=[],le=[];let be=[];for(let he=0;he<g.length;he++){const Ee=g[he];console.log(`ðŸ”„ Casting NFT ${he+1}/${g.length}: Token ${Ee.tokenId} from ${Ee.canisterId}`),se("cast-nfts","loading",`Casting NFT ${he+1}/${g.length}: ${Ee.name||Ee.tokenId}...`);try{const He=K;console.log("ðŸ” Using native contract pointer from ICRC-99:",{nativeNetwork:He.network,nativeContract:He.contract,ckNFTCanister:Ee.canisterId,tokenId:Ee.tokenId});const ie={tokenId:BigInt(Ee.tokenId),gasPrice:[BigInt(5e10)],memo:[],fromSubaccount:[],remoteContract:{contract:E.address||"",network:{Ethereum:[BigInt(1)]}},maxPriorityFeePerGas:[BigInt(2e9)],created_at_time:[],gasLimit:[BigInt(2e5)],targetOwner:U};console.log("ðŸ“¤ Submitting ckNFT cast request:",{tokenId:Ee.tokenId,canisterId:Ee.canisterId,targetEVM:U,remoteContract:E.address});const Ce=(await M.castToEVM.mutateAsync({castRequests:[ie],ckNFTCanisterId:it.fromText(Ee.canisterId)}))[0];if(Ce&&"Ok"in Ce)console.log(`âœ… NFT ${he+1}/${g.length} cast submitted successfully. Cast ID: ${Ce.Ok}`),$.push(Ce),le.push(Ce.Ok),X.push(`${Ee.name||`Token ${Ee.tokenId}`} â†’ EVM (Cast ID: ${Ce.Ok})`);else{const ye=Ce?Ce.Err:"No result returned";console.error(`âŒ NFT ${he+1}/${g.length} cast failed:`,ye);let ke="Cast operation failed";if(ye&&typeof ye=="object")if("InsufficientAllowance"in ye&&Array.isArray(ye.InsufficientAllowance)){const[ze,Je]=ye.InsufficientAllowance;ke=`Insufficient allowance for NFT casting. Required: ${ze.toString()}, Available: ${Je.toString()}. Please approve the NFT for transfer before casting.`}else if("InsufficientCycles"in ye&&Array.isArray(ye.InsufficientCycles)){const[ze,Je]=ye.InsufficientCycles;ke=`Insufficient cycles for casting. Required: ${ze.toString()}, Available: ${Je.toString()}. Please ensure sufficient cycles are available.`}else if("InsufficientBalance"in ye&&Array.isArray(ye.InsufficientBalance)){const[ze,Je]=ye.InsufficientBalance;ke=`Insufficient balance for casting. Required: ${ze.toString()}, Available: ${Je.toString()}.`}else if("NotFound"in ye)ke="NFT not found. Please ensure the NFT exists and you own it.";else if("Unauthorized"in ye)ke="Unauthorized to cast this NFT. Please ensure you own the NFT.";else if("ExistingCast"in ye)ke=`NFT is already being cast. Existing cast ID: ${ye.ExistingCast.toString()}`;else try{ke=`Cast operation failed: ${JSON.stringify(ye,(ze,Je)=>typeof Je=="bigint"?Je.toString():Je)}`}catch{ke=`Cast operation failed: ${String(ye)}`}else ke=`Cast operation failed: ${String(ye)}`;throw new Error(ke)}}catch(He){console.error(`âŒ Error casting NFT ${he+1}/${g.length}:`,He),se("cast-nfts","failed",He instanceof Error?He.message:`Failed to cast NFT ${he+1}`);return}}se("cast-nfts","completed",`Successfully submitted ${$.length} NFT(s) for casting`),se("wait-evm-confirmation","loading","Monitoring cast operations...");try{console.log("ðŸ” Monitoring cast operations:",le.map(ie=>ie.toString()));let he=30,Ee=!1,He=[];for(;he>0&&!Ee;){se("wait-evm-confirmation","loading",`Monitoring cast operations... (${31-he}/30 checks)`);try{const ie=await M.getCastStatus.mutateAsync(le);console.log("ðŸ” Cast status check results:",ie);let we=0,Ce=!1;for(let ye=0;ye<ie.length;ye++){const ke=ie[ye];ke&&("Completed"in ke||"Finalized"in ke?(we++,"WaitingOnContract"in ke&&((G=ke.WaitingOnContract)!=null&&G.transaction)&&He.push(ke.WaitingOnContract.transaction)):("Error"in ke||"Failed"in ke)&&(Ce=!0,console.error(`âŒ Cast operation ${le[ye]} failed:`,ke)))}if(Ce)throw new Error("One or more cast operations failed");we===le.length?(Ee=!0,console.log("ðŸŽ‰ All cast operations completed successfully!")):(console.log(`â³ Progress: ${we}/${le.length} casts completed`),await new Promise(ye=>setTimeout(ye,1e4)))}catch(ie){console.error("âŒ Error checking cast status:",ie)}he--}Ee?se("wait-evm-confirmation","completed",`All ${$.length} NFT(s) successfully exported to EVM`):(console.warn("âš ï¸ Cast operations still in progress after monitoring timeout"),se("wait-evm-confirmation","completed","Cast operations submitted successfully. Final confirmation may take additional time."))}catch(he){console.error("âŒ Error monitoring cast operations:",he),se("wait-evm-confirmation","completed","Cast operations submitted. Monitoring encountered issues but exports should complete.")}k({success:!0,evmTransactionHash:be.length>0?be[0]:void 0,icTransactionHash:le.map(he=>he.toString()).join(", "),remoteContractAddress:E.address||"deployed-contract-address",tokenId:g.map(he=>he.tokenId).join(", ")}),console.log("ðŸŽ‰ ICRC-99 export process completed successfully!"),b("complete"),r==null||r({success:!0,evmTransactionHash:be.length>0?be[0]:void 0,icTransactionHash:le.map(he=>he.toString()).join(", "),remoteContractAddress:E.address||"deployed-contract-address",tokenId:g.map(he=>he.tokenId).join(", ")})}catch($){console.error("Export process failed:",$);const X=$ instanceof Error?$.message:"Export failed";if(S!=null&&S.steps){const le=S.steps.find(be=>be.status==="loading");le&&se(le.id,"failed",X)}k({success:!1,error:X}),r==null||r({success:!1,error:X})}},[g,U,J,E,N,K,se,r,S,L,M]);console.log("EVMExportWizard initialized with steps:",E);const ae=()=>{var G,$;switch(p){case"select-ic-nft":return i.jsxs("div",{className:"space-y-4",children:[i.jsx(uy,{sourceCanisterId:e,selectedNFTs:g,onSelectionChange:v,userPrincipal:J==null?void 0:J.principal,onCanisterChange:R}),g.length>0&&q&&i.jsxs("div",{className:"mt-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[i.jsx("div",{className:"flex items-center space-x-2",children:y.isLoading?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full"}),i.jsx("span",{className:"text-sm text-gray-600",children:"Checking ICRC-99 support..."})]}):y.isSupported?i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm text-green-700 font-medium",children:"ICRC-99 Supported"}),i.jsx("span",{className:"text-xs text-gray-500",children:"- Cross-chain casting available"})]}):i.jsxs(i.Fragment,{children:[i.jsx("svg",{className:"w-4 h-4 text-yellow-600",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i.jsx("span",{className:"text-sm text-yellow-700 font-medium",children:"ICRC-7 Only"}),i.jsx("span",{className:"text-xs text-gray-500",children:"- IC-to-EVM casting available"})]})}),y.nativeChain&&K&&i.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[i.jsx("span",{className:"font-medium",children:"Source Network:"})," ","IC"in K.network?"Internet Computer":"Ethereum"in K.network?"Ethereum Network":"Other Network",i.jsx("br",{}),i.jsx("span",{className:"font-medium",children:"Contract:"})," ",i.jsx("span",{className:"font-mono",children:K.contract})]})]})]});case"connect":return i.jsx(wf,{isConnected:P,account:Q,supportedNetworks:t,currentNetwork:H&&m[H]||null,onConnect:j,onSwitchNetwork:X=>{const le=h[X];if(le)return w(le);throw new Error(`Unsupported network: ${X}`)},selectedTargetNetwork:N&&"Ethereum"in N&&m[Number(N.Ethereum[0])]||void 0,onTargetNetworkChange:X=>{const le=h[X];le&&V({Ethereum:[BigInt(le)]})}});case"remote-contract":return i.jsx(gy,{selectedNFTs:g,targetChainId:N&&"Ethereum"in N&&((G=N.Ethereum[0])==null?void 0:G.toString())||"",remoteContractInfo:E,onRemoteContractInfoChange:Y,sourceCanisterId:(($=g[0])==null?void 0:$.canisterId)||"",sourceContractPointer:K});case"costs":return i.jsx(by,{selectedNFTs:g,targetNetwork:N,remoteContractInfo:E,sourceContractPointer:K,onCostsCalculated:Z});case"export":return i.jsx(yy,{progress:S,onRetryStep:F,onToggleStage:()=>{}});case"complete":return i.jsx(wy,{result:z,onStartNew:()=>{b("select-ic-nft"),v([]),V(null),Y(null),Z(null),k(null),L("ic-to-evm")},onClose:()=>n==null?void 0:n()});default:return null}},Ae=i.jsxs("div",{className:_e("bg-white rounded-lg shadow-lg",a&&"max-w-4xl mx-auto",s),children:[i.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Export NFTs to EVM"}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Step ",ee+1," of ",I.length,": ",(Re=I[ee])==null?void 0:Re.description]})]}),n&&i.jsx("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:i.jsx(nu,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"px-6 py-4 border-b border-gray-100",children:[i.jsx("div",{className:"flex items-center justify-between",children:I.map((G,$)=>i.jsxs("div",{className:_e("flex items-center",$<I.length-1&&"flex-1"),children:[i.jsx("div",{className:_e("flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium",$<ee?"bg-green-100 text-green-600":$===ee?re?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"),children:$<ee?i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):$===ee&&re?i.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}):$+1}),i.jsx("span",{className:_e("ml-2 text-sm font-medium hidden sm:inline",$<=ee?"text-gray-900":"text-gray-400",$===ee&&re&&"text-red-600"),children:G.title}),$<I.length-1&&i.jsx("div",{className:_e("flex-1 h-0.5 mx-4",$<ee?"bg-green-200":"bg-gray-200")})]},G.id))}),re&&i.jsx("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded-md",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("svg",{className:"w-4 h-4 text-red-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i.jsxs("span",{className:"text-sm text-red-700 font-medium",children:["Error in ",(de=I[ee])==null?void 0:de.title]}),i.jsx("span",{className:"ml-2 text-xs text-red-600",children:"Use the Previous button to go back and retry"})]})})]}),i.jsx("div",{className:"p-6 min-h-[400px]",children:ae()}),i.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[i.jsxs("button",{onClick:Ne,disabled:!oe,className:_e("flex items-center px-4 py-2 text-sm font-medium rounded-md transition-colors",oe?re?"text-white bg-red-600 hover:bg-red-700":"text-gray-700 bg-gray-100 hover:bg-gray-200":"text-gray-400 bg-gray-50 cursor-not-allowed"),children:[i.jsx(Dd,{className:"w-4 h-4 mr-1"}),re?"Go Back & Retry":"Previous"]}),i.jsxs("div",{className:"flex space-x-3",children:[p==="costs"&&D()&&i.jsxs("button",{onClick:Te,className:"flex items-center px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 transition-colors",children:["Start Export",i.jsx(ia,{className:"w-4 h-4 ml-1"})]}),p!=="costs"&&p!=="export"&&p!=="complete"&&i.jsxs("button",{onClick:pe,disabled:!D(),className:_e("flex items-center px-6 py-2 text-sm font-medium rounded-md transition-colors",D()?"text-white bg-blue-600 hover:bg-blue-700":"text-gray-400 bg-gray-100 cursor-not-allowed"),children:["Next",i.jsx(ia,{className:"w-4 h-4 ml-1"})]})]})]})]});return a?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:Ae}):Ae}function yy({progress:e,onRetryStep:t,onToggleStage:r}){var l,d,u,h;if(!e)return i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Initializing export process..."})]});const s=(((l=e.steps)==null?void 0:l.filter(m=>m.status==="loading"||m.status==="failed"))||[])[0],a=((d=e.steps)==null?void 0:d.some(m=>m.status==="failed"))||!1,o=((u=e.steps)==null?void 0:u.filter(m=>m.status==="completed"))||[],c=((h=e.steps)==null?void 0:h.length)||0;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:a?"Export Failed":"Export in Progress"}),i.jsx("p",{className:"text-gray-600",children:a?"An error occurred during the export process.":"Exporting your ckNFTs back to the EVM blockchain..."})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),i.jsxs("span",{className:"text-sm text-gray-500",children:[o.length," of ",c," steps completed"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${a?"bg-red-500":"bg-blue-600"}`,style:{width:`${o.length/c*100}%`}})})]}),s&&i.jsxs("div",{className:`p-4 rounded-lg border ${s.status==="failed"?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:[i.jsxs("div",{className:"flex items-center",children:[s.status==="loading"?i.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full mr-3"}):i.jsx("svg",{className:"w-5 h-5 text-red-500 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),i.jsxs("div",{children:[i.jsxs("h4",{className:`font-medium ${s.status==="failed"?"text-red-800":"text-blue-800"}`,children:[s.status==="loading"?"In Progress: ":"Failed: ",s.title||s.id]}),s.error&&i.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.error}),s.status==="loading"&&i.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Please wait..."})]})]}),s.status==="failed"&&i.jsx("div",{className:"mt-3",children:i.jsx("button",{onClick:()=>t(s.id),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors",children:"Retry Step"})})]}),!s&&!a&&c>0&&i.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("svg",{className:"w-5 h-5 text-green-500 mr-3",fill:"currentColor",viewBox:"0 0 20 20",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-green-800",children:"Export Complete!"}),i.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Your ckNFTs have been successfully exported to EVM."})]})]})}),i.jsxs("details",{className:"mt-6",children:[i.jsx("summary",{className:"cursor-pointer text-sm font-medium text-gray-700 hover:text-gray-900",children:"Show Detailed Progress"}),i.jsx("div",{className:"mt-3 p-4 bg-gray-50 rounded-lg",children:i.jsx(bu,{progress:e,onRetryStep:t,onToggleStage:r})})]})]})}function wy({result:e,onStartNew:t,onClose:r}){const n=e.tokenId?e.tokenId.split(", "):[],s=n.length>1;return i.jsxs("div",{className:"space-y-6 text-center",children:[i.jsx("div",{children:e.success?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s?`${n.length} NFTs Exported Successfully!`:"Export Successful!"}),i.jsx("p",{className:"text-gray-600",children:s?`Your ${n.length} ckNFTs have been successfully exported back to the EVM blockchain.`:"Your ckNFT has been successfully exported back to the EVM blockchain."})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"6 18L18 6M6 6l12 12"})})}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Export Failed"}),i.jsx("p",{className:"text-gray-600",children:e.error})]})}),e.success&&i.jsxs("div",{className:"space-y-3 text-sm",children:[e.remoteContractAddress&&i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-blue-800 mb-1",children:"EVM Contract"}),i.jsx("p",{className:"text-blue-700 font-mono text-xs break-all",children:e.remoteContractAddress})]}),n.length>0&&i.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-green-800 mb-1",children:s?"Exported Token IDs":"Exported Token ID"}),i.jsx("p",{className:"text-green-700",children:e.tokenId})]}),e.evmTransactionHash&&i.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-gray-800 mb-1",children:"EVM Transaction"}),i.jsx("p",{className:"text-gray-700 font-mono text-xs break-all",children:e.evmTransactionHash})]})]}),i.jsxs("div",{className:"flex justify-center space-x-4",children:[i.jsx("button",{onClick:t,className:"px-6 py-2 text-blue-600 border border-blue-600 rounded-md hover:bg-blue-50 transition-colors",children:"Export More NFTs"}),i.jsx("button",{onClick:r,className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors",children:"Close"})]})]})}const Ny=function(){const[t,r]=_.useState(!1),[n,s]=_.useState(!1),[a,o]=_.useState(null),[c,l]=_.useState(null),[d,u]=_.useState(null),[h,m]=_.useState(!1),[p,b]=_.useState(!1),{user:g,connect:v,isConnecting:N}=Er(),V=$f(),E=O=>{console.log("Import completed:",O),l(O),O.success?(m(!0),console.log("ðŸŽ‰ NFT successfully imported!",{evmTx:O.evmTransactionHash,icTx:O.icTransactionHash,canister:O.canisterAddress,tokenId:O.tokenId})):console.error("âŒ Import failed:",O.error)},Y=O=>{console.log("Export completed:",O),u(O),O.success?(b(!0),console.log("ðŸŽ‰ NFT successfully exported!",{evmTx:O.evmTransactionHash,icTx:O.icTransactionHash,contract:O.remoteContractAddress,tokenId:O.tokenId})):console.error("âŒ Export failed:",O.error)};if(!g||!V){const Z=!!g&&!V;return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8 flex items-center justify-center",children:i.jsx("div",{className:"max-w-md mx-auto bg-white/10 backdrop-blur-sm rounded-xl p-8 border border-white/20 text-center",children:i.jsxs("div",{className:"mb-6",children:[i.jsx("svg",{className:"w-16 h-16 text-white mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),Z?i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Loading Authentication"}),i.jsx("p",{className:"text-gray-300 mb-6",children:"Setting up secure connection to the Internet Computer..."}),i.jsx("div",{className:"flex items-center justify-center",children:i.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-white border-t-transparent rounded-full"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Authentication Required"}),i.jsx("p",{className:"text-gray-300 mb-6",children:"You need to connect your Internet Computer identity to use the NFT bridge."}),i.jsx("button",{onClick:()=>v(),disabled:N,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-purple-800 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:N?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2"}),"Connecting..."]}):"Connect Identity"}),i.jsx("p",{className:"text-sm text-gray-400 mt-4",children:"Use NFID, Internet Identity, or other supported wallets to connect."})]})]})})})}return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"NFT Bridge"}),i.jsx("p",{className:"text-xl text-gray-300 mb-8",children:"Bridge your NFTs between EVM chains and the Internet Computer"})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[i.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[i.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"Import from EVM"}),i.jsx("p",{className:"text-gray-300 mb-6",children:"Bring your NFTs from Ethereum, Polygon, BSC, Optimism, Base, Arbitrum, or local Hardhat to the Internet Computer."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("button",{onClick:()=>o("import"),className:"w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Start Import (Inline)"}),i.jsx("button",{onClick:()=>r(!0),className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Start Import (Modal)"})]})]}),i.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[i.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"Export to EVM"}),i.jsx("p",{className:"text-gray-300 mb-6",children:"Send your IC NFTs back to Ethereum or other EVM chains."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("button",{onClick:()=>o("export"),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Start Export (Inline)"}),i.jsx("button",{onClick:()=>s(!0),className:"w-full bg-teal-600 hover:bg-teal-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Start Export (Modal)"})]})]})]}),h&&c&&!c.success&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsx("div",{className:"bg-white rounded-xl max-w-md w-full p-8 text-center",children:i.jsxs("div",{className:"mb-6",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Import Failed"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"There was an issue importing your NFT. Please try again."}),c.error&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-left mb-6",children:[i.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Error Details:"}),i.jsx("p",{className:"text-sm text-red-700",children:c.error})]}),i.jsx("button",{onClick:()=>{m(!1),l(null)},className:"w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Try Again"})]})})}),h&&(c==null?void 0:c.success)&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsx("div",{className:"bg-white rounded-xl max-w-md w-full p-8 text-center",children:i.jsxs("div",{className:"mb-6",children:[i.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Import Successful!"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Your NFT has been successfully imported to the Internet Computer."}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left mb-6",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Transaction Details:"}),i.jsxs("div",{className:"space-y-1 text-sm",children:[c.evmTransactionHash&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"EVM Transaction:"}),i.jsx("div",{className:"font-mono text-xs break-all",children:c.evmTransactionHash})]}),c.icTransactionHash&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"IC Reference:"}),i.jsx("div",{className:"font-mono text-xs break-all",children:c.icTransactionHash})]}),c.canisterAddress&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Canister:"}),i.jsx("div",{className:"font-mono text-xs break-all",children:c.canisterAddress})]}),c.tokenId&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Token ID:"}),i.jsx("div",{className:"font-mono text-xs",children:c.tokenId})]})]})]}),i.jsx("button",{onClick:()=>{m(!1),l(null)},className:"w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Continue"})]})})}),p&&d&&!d.success&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsx("div",{className:"bg-white rounded-xl max-w-md w-full p-8 text-center",children:i.jsxs("div",{className:"mb-6",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Export Failed"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"There was an issue exporting your NFT. Please try again."}),d.error&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-left mb-6",children:[i.jsx("h3",{className:"font-semibold text-red-900 mb-2",children:"Error Details:"}),i.jsx("p",{className:"text-sm text-red-700",children:d.error})]}),i.jsx("button",{onClick:()=>{b(!1),u(null)},className:"w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Try Again"})]})})}),p&&(d==null?void 0:d.success)&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsx("div",{className:"bg-white rounded-xl max-w-md w-full p-8 text-center",children:i.jsxs("div",{className:"mb-6",children:[i.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Export Successful!"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"Your NFT has been successfully exported to the EVM blockchain."}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left mb-6",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Transaction Details:"}),i.jsxs("div",{className:"space-y-1 text-sm",children:[d.evmTransactionHash&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"EVM Transaction:"}),i.jsx("div",{className:"font-mono text-xs break-all",children:d.evmTransactionHash})]}),d.icTransactionHash&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"IC Transaction:"}),i.jsx("div",{className:"font-mono text-xs break-all",children:d.icTransactionHash})]}),d.remoteContractAddress&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Contract Address:"}),i.jsx("div",{className:"font-mono text-xs break-all",children:d.remoteContractAddress})]}),d.tokenId&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Token ID:"}),i.jsx("div",{className:"font-mono text-xs",children:d.tokenId})]})]})]}),i.jsx("button",{onClick:()=>{b(!1),u(null)},className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Continue"})]})})}),a==="import"&&i.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-white",children:"Import from EVM"}),i.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx(Wd,{canisterId:"umunu-kh777-77774-qaaca-cai",supportedNetworks:["ethereum","polygon","bsc","optimism","base","arbitrum","hardhat","hardhat-2"],onComplete:E,onCancel:()=>o(null)})]}),a==="export"&&i.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-white",children:"Export to EVM"}),i.jsx("button",{onClick:()=>o(null),className:"text-gray-400 hover:text-white transition-colors",children:i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx(Yd,{sourceCanisterId:"umunu-kh777-77774-qaaca-cai",supportedNetworks:["ethereum","polygon","bsc","optimism","base","arbitrum","hardhat","hardhat-2"],onComplete:Y,onCancel:()=>o(null)})]}),t&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsx("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:i.jsx(Wd,{canisterId:"rrkah-fqaaa-aaaaa-aaaaq-cai",supportedNetworks:["ethereum","polygon","bsc","optimism","base","arbitrum","hardhat","hardhat-2"],modal:!0,onComplete:O=>{E(O),r(!1)},onCancel:()=>r(!1)})})}),n&&i.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:i.jsx("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:i.jsx(Yd,{sourceCanisterId:"rrkah-fqaaa-aaaaa-aaaaq-cai",supportedNetworks:["ethereum","polygon","bsc","optimism","base","arbitrum","hardhat","hardhat-2"],modal:!0,onComplete:O=>{Y(O),s(!1)},onCancel:()=>s(!1)})})}),(c||d)&&i.jsxs("div",{className:"mt-8 space-y-4",children:[c&&i.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[i.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Last Import Result:"}),i.jsx("pre",{className:"bg-black/30 rounded-lg p-4 text-sm text-green-300 overflow-auto",children:JSON.stringify(c,null,2)})]}),d&&i.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-6 border border-white/20",children:[i.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Last Export Result:"}),i.jsx("pre",{className:"bg-black/30 rounded-lg p-4 text-sm text-green-300 overflow-auto",children:JSON.stringify(d,null,2)})]})]})]})})},Qy=Object.freeze(Object.defineProperty({__proto__:null,component:Ny},Symbol.toStringTag,{value:"Module"}));export{qe as $,co as A,ve as B,zc as C,lf as D,fb as E,W as F,yg as G,Ir as H,Uc as I,$y as J,yt as K,$b as L,sr as M,Nr as N,bs as O,dt as P,pa as Q,hs as R,Gu as S,uo as T,qi as U,Db as V,pf as W,Ke as X,me as Y,Se as Z,gf as _,Py as a,Pa as a$,Bg as a0,xo as a1,At as a2,fa as a3,fs as a4,Ra as a5,ym as a6,wt as a7,gm as a8,Ie as a9,Pb as aA,lo as aB,ps as aC,wr as aD,Ho as aE,Rd as aF,cc as aG,Oa as aH,sb as aI,Nb as aJ,Go as aK,ut as aL,Si as aM,Rt as aN,us as aO,ib as aP,Dh as aQ,ga as aR,pt as aS,rf as aT,Sm as aU,oa as aV,td as aW,yu as aX,bh as aY,Ry as aZ,km as a_,ca as aa,vn as ab,So as ac,rl as ad,jy as ae,Kd as af,Em as ag,ob as ah,Nn as ai,qr as aj,ub as ak,db as al,yl as am,nf as an,$o as ao,yo as ap,ab as aq,Ft as ar,yr as as,bl as at,vu as au,Fr as av,Od as aw,Gd as ax,Mm as ay,An as az,Xm as b,_x as b0,Cm as b1,Mx as b2,vs as b3,$m as b4,ao as b5,Vy as b6,Uy as b7,jo as b8,Gy as b9,mh as ba,tl as bb,zy as bc,Vn as bd,Mc as be,Fy as bf,Qm as bg,Ty as bh,Nm as bi,Sy as bj,Hy as bk,Qy as bl,By as c,tp as d,$i as e,cl as f,je as g,ue as h,A as i,Ye as j,Le as k,En as l,Ue as m,ls as n,yh as o,Oy as p,Ar as q,My as r,Ro as s,tt as t,Jm as u,Au as v,il as w,Ms as x,wm as y,Kr as z};
